<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage Express 2.0">
<title></title>
</head>

<body>

<p><img src="..\..\..\docs\shared\apsimdocumentationbanner.jpg" width="640"
height="73"></p>
</body>
</html>
<TITLE>The APSIM SoilN2 Model</TITLE>
<FONT SIZE = 7><B><CENTER>The APSIM SoilN2 Model</CENTER></B></FONT>
<H1>TABLE OF CONTENTS</H1>
<H2><A HREF = "#Contact Information"> Contact Information </A></H2>
<H2><A HREF = "#Module Description"> Module Description </A></H2>
<H2>User Input Files</H2>
<ul><li>The Constants File

<ul><li><A HREF = "#standard.soiln2.constants"> standard constants </A>

</ul></ul>
<H2>Module Logic</H2>
<ul><li><A HREF = "#soiln2_process"> soiln2_process </A>

<li><A HREF = "#soiln2_incorp_fom"> soiln2_incorp_fom </A>

<li><A HREF = "#Structure Charts"> Structure Charts </A>

</ul>
<hr>
<A NAME = "Module Description">  </A>
<H2>Module Documentation</H2>
<br>
<A HREF = "soiln2_science.pdf"> Module Documentation </A>
<hr>
<html>

<body>

<p><!--webbot bot="ImageMap" startspan rectangle=" (513,2) (635, 18)  APSeudo Documentation"
rectangle=" (103,4) (204, 18)  Structure Charts"
rectangle=" (14,3) (76, 18)  #Top" src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640"
height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" --><MAP NAME="FrontPageMap0"><AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top"><AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts"><AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top"></MAP><img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" usemap="#FrontPageMap0"><!--webbot bot="ImageMap"
i-checksum="58234" endspan --></p>
</body>
</html>
<A NAME = "Structure Charts"> <H2>Module Structure Charts</H2> </A>
<H2>Soil N Balance</H2>
<ul><li><A HREF = "#soiln2_process"> soiln2_process </A>

<ul><li><A HREF = "#soiln2_soil_temp"> soiln2_soil_temp </A>

<ul><li><A HREF = "#soiln2_soiltemp_dt"> soiln2_soiltemp_dt </A>

<ul><li><A HREF = "#soiln2_layer_temp"> soiln2_layer_temp </A>

</ul><li><A HREF = "#soiln2_layer_temp"> soiln2_layer_temp </A>

<li><A HREF = "#soiln2_soiltemp_dampdepth"> soiln2_soiltemp_dampdepth </A>

</ul><li><A HREF = "#soiln2_min_residues"> soiln2_min_residues </A>

<li><A HREF = "#soiln2_urea_hydrolysis"> soiln2_urea_hydrolysis </A>

<ul><li><A HREF = "#soiln2_wf"> soiln2_wf </A>

</ul><li><A HREF = "#soiln2_denitrification"> soiln2_denitrification </A>

<ul><li><A HREF = "#soiln2_fac"> soiln2_fac </A>

<li><A HREF = "#soiln2_wf_denit"> soiln2_wf_denit </A>

</ul><li><A HREF = "#soiln2_min_humic"> soiln2_min_humic </A>

<ul><li><A HREF = "#soiln2_wf"> soiln2_wf </A>

<li><A HREF = "#soiln2_tf"> soiln2_tf </A>

</ul><li><A HREF = "#soiln2_min_biomass"> soiln2_min_biomass </A>

<ul><li><A HREF = "#soiln2_wf"> soiln2_wf </A>

<li><A HREF = "#soiln2_tf"> soiln2_tf </A>

</ul><li><A HREF = "#soiln2_min_fom"> soiln2_min_fom </A>

<ul><li><A HREF = "#soiln2_wf"> soiln2_wf </A>

<li><A HREF = "#soiln2_tf"> soiln2_tf </A>

</ul><li><A HREF = "#soiln2_nitrification"> soiln2_nitrification </A>

<ul><li><A HREF = "#soiln2_phf_nitrf"> soiln2_phf_nitrf </A>

<li><A HREF = "#soiln2_tf"> soiln2_tf </A>

<li><A HREF = "#soiln2_wf_nitrf"> soiln2_wf_nitrf </A>

<li><A HREF = "#soiln2_fac"> soiln2_fac </A>

</ul></ul></ul>
<H2>Incorporate Fresh Organic Matter</H2>
<ul><li><A HREF = "#soiln2_incorp_fom"> soiln2_incorp_fom </A>

<ul><li><A HREF = "#soiln2_incorp_min_n"> soiln2_incorp_min_n </A>

</ul></ul>
<html>

<body>

<p><!--webbot bot="ImageMap" startspan rectangle=" (513,2) (635, 18)  APSeudo Documentation"
rectangle=" (103,4) (204, 18)  Structure Charts"
rectangle=" (14,3) (76, 18)  #Top" src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640"
height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" --><MAP NAME="FrontPageMap0"><AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top"><AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts"><AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top"></MAP><img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" usemap="#FrontPageMap0"><!--webbot bot="ImageMap"
i-checksum="58234" endspan --></p>
</body>
</html>
<CENTER><A NAME = "Module Pseudo Code"> <H2><BIG>Module Pseudo Code</BIG></H2> </A></CENTER>
<hr>
<H2><BIG><A NAME = "Soil N Balance"> Soil N Balance </A></BIG></H2>
<A NAME = "soiln2_process">  </A>
<H2>Soiln2 Process</H2>
<br>
<H3><CENTER>This routine performs the soil N balance.  It calculates hydrolysis of g_urea, mineralisation of organic matter and immobilization of mineral nitrogen due to crop residue and soil organic matter decomposition, denitrification and nitrification.   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

<A HREF = "#soiln2_soil_temp"> Calculate soil temperature </A><br>

number of layers = number of elements in dlayer<br>

<A HREF = "#soiln2_min_residues"> Calculate rate of nitrogen mineralization/immobilization </A><br>

hum_c = hum_c + sum (<FONT FACE = "SYMBOL">D</FONT>res_c_hum<I><SUB> :, :</SUB></I>, dim = residue_dim)<br>

biom_c = biom_c + sum (<FONT FACE = "SYMBOL">D</FONT>res_c_biom<I><SUB> :, :</SUB></I>, dim = residue_dim)<br>

For each layer from 1 to number of layers<br>

<dl>hum_n<I><SUB> layer</SUB></I> = hum_c<I><SUB> layer</SUB></I> / soil_cn<br>

biom_n<I><SUB> layer</SUB></I> = biom_c<I><SUB> layer</SUB></I> / <A HREF = "#mcn"> mcn </A><br>

nh4<I><SUB> layer</SUB></I> = nh4<I><SUB> layer</SUB></I> + <FONT FACE = "SYMBOL">D</FONT>res_nh4_min<I><SUB> layer</SUB></I><br>

no3<I><SUB> layer</SUB></I> = no3<I><SUB> layer</SUB></I> + <FONT FACE = "SYMBOL">D</FONT>res_no3_min<I><SUB> layer</SUB></I><br>

</dl>next<br>

For each layer from 1 to number of layers<br>

<dl><A HREF = "#soiln2_urea_hydrolysis"> Hydrolyse urea in layer </A><br>

nh4<I><SUB> layer</SUB></I> = nh4<I><SUB> layer</SUB></I> + <FONT FACE = "SYMBOL">D</FONT>urea_hydrol<br>

urea<I><SUB> layer</SUB></I> = urea<I><SUB> layer</SUB></I> - <FONT FACE = "SYMBOL">D</FONT>urea_hydrol<br>

<A HREF = "#soiln2_denitrification"> Calculate denitrification in layer </A><br>

no3<I><SUB> layer</SUB></I> = no3<I><SUB> layer</SUB></I> - <FONT FACE = "SYMBOL">D</FONT>no3_dnit<I><SUB> layer</SUB></I><br>

<A HREF = "#soiln2_min_humic"> Calculate the humic rate of decomposition and nitrogen mineralisation </A><br>

<A HREF = "#soiln2_min_biomass"> Calculate the biomass rate of decomposition and nitrogen mineralisation </A><br>

<A HREF = "#soiln2_min_fom"> Calculate the fresh organic matter rate of decomposition and nitrogen mineralisation </A><br>

hum_c<I><SUB> layer</SUB></I> = hum_c<I><SUB> layer</SUB></I> - <FONT FACE = "SYMBOL">D</FONT>hum_c_biom<I><SUB> layer</SUB></I> - <FONT FACE = "SYMBOL">D</FONT>hum_c_atm<I><SUB> layer</SUB></I> + <FONT FACE = "SYMBOL">D</FONT>biom_c_hum<I><SUB> layer</SUB></I> + <FONT FACE = "SYMBOL">S</FONT><SUP>1</SUP><SUB>nfract</SUB> <FONT FACE = "SYMBOL">D</FONT>fom_c_hum<I><SUB> 1, layer</SUB></I><br>

hum_n<I><SUB> layer</SUB></I> = hum_c<I><SUB> layer</SUB></I> / soil_cn<br>

biom_c<I><SUB> layer</SUB></I> = biom_c<I><SUB> layer</SUB></I> - <FONT FACE = "SYMBOL">D</FONT>biom_c_hum<I><SUB> layer</SUB></I> - <FONT FACE = "SYMBOL">D</FONT>biom_c_atm<I><SUB> layer</SUB></I> + <FONT FACE = "SYMBOL">D</FONT>hum_c_biom<I><SUB> layer</SUB></I> + <FONT FACE = "SYMBOL">S</FONT><SUP>1</SUP><SUB>nfract</SUB> <FONT FACE = "SYMBOL">D</FONT>fom_c_biom<I><SUB> 1, layer</SUB></I><br>

biom_n<I><SUB> layer</SUB></I> = biom_c<I><SUB> layer</SUB></I> / <A HREF = "#mcn"> mcn </A><br>

fom_c = fom_pool<I><SUB> 1, layer</SUB></I> + fom_pool<I><SUB> 2, layer</SUB></I> + fom_pool<I><SUB> 3, layer</SUB></I><br>

fom_cn = fom_c / fom_n<I><SUB> layer</SUB></I><br>

For each fract from 1 to nfract<br>

<dl>fom_pool<I><SUB> fract, layer</SUB></I> = fom_pool<I><SUB> fract, layer</SUB></I> - <FONT FACE = "SYMBOL">D</FONT>fom_c_hum<I><SUB> fract, layer</SUB></I> - <FONT FACE = "SYMBOL">D</FONT>fom_c_biom<I><SUB> fract, layer</SUB></I> - <FONT FACE = "SYMBOL">D</FONT>fom_c_atm<I><SUB> fract, layer</SUB></I><br>

</dl>next<br>

fom_c = fom_pool<I><SUB> 1, layer</SUB></I> + fom_pool<I><SUB> 2, layer</SUB></I> + fom_pool<I><SUB> 3, layer</SUB></I><br>

fom_n<I><SUB> layer</SUB></I> = fom_c / fom_cn<br>

nh4<I><SUB> layer</SUB></I> = nh4<I><SUB> layer</SUB></I> + <FONT FACE = "SYMBOL">D</FONT>hum_n_min<I><SUB> layer</SUB></I> + <FONT FACE = "SYMBOL">D</FONT>biom_n_min<I><SUB> layer</SUB></I> + <FONT FACE = "SYMBOL">D</FONT>fom_n_min<I><SUB> layer</SUB></I><br>

if (nh4<I><SUB> layer</SUB></I>.<.nh4_min<I><SUB> layer</SUB></I>) then<br>

<dl>excess_nh4 = nh4_min<I><SUB> layer</SUB></I> - nh4<I><SUB> layer</SUB></I><br>

nh4<I><SUB> layer</SUB></I> = nh4_min<I><SUB> layer</SUB></I><br>

</dl>else<br>

<dl>excess_nh4 = 0 . 0<br>

</dl>endif<br>

no3<I><SUB> layer</SUB></I> = no3<I><SUB> layer</SUB></I> - excess_nh4<br>

no3<I><SUB> layer</SUB></I> = no3<I><SUB> layer</SUB></I> constrained above no3_min<I><SUB> layer</SUB></I><br>

<A HREF = "#soiln2_nitrification"> Calculate nitrification of NH4 in layer </A><br>

no3<I><SUB> layer</SUB></I> = no3<I><SUB> layer</SUB></I> + <FONT FACE = "SYMBOL">D</FONT>rntrf<br>

nh4<I><SUB> layer</SUB></I> = nh4<I><SUB> layer</SUB></I> - <FONT FACE = "SYMBOL">D</FONT>rntrf<br>

Check that no3<I><SUB> layer</SUB></I> lies between no3_min<I><SUB> layer</SUB></I> and 9000 . 0<br>

Check that nh4<I><SUB> layer</SUB></I> lies between nh4_min<I><SUB> layer</SUB></I> and 9000 . 0<br>

Check that urea<I><SUB> layer</SUB></I> lies between 0 . 0 and 9000 . 0<br>

<br>

</dl></dl></dl>
<html>

<body>

<p><!--webbot bot="ImageMap" startspan rectangle=" (513,2) (635, 18)  APSeudo Documentation"
rectangle=" (103,4) (204, 18)  Structure Charts"
rectangle=" (14,3) (76, 18)  #Top" src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640"
height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" --><MAP NAME="FrontPageMap0"><AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top"><AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts"><AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top"></MAP><img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" usemap="#FrontPageMap0"><!--webbot bot="ImageMap"
i-checksum="58234" endspan --></p>
</body>
</html>
<A NAME = "soiln2_soil_temp">  </A>
<H2>Soiln2 Soil Temp</H2>
<br>
<H3><CENTER>Calculates average soil temperature at the centre of each layer based on the soil temperature model of EPIC (Williams et al 1984)   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

if (latitude.>=.0) then<br>

<dl>alx = ang * (year offset by int (- nth_hot) days)<br>

</dl>else<br>

<dl>alx = ang * (year offset by int (- sth_hot) days)<br>

</dl>endif<br>

Check that alx lies between 0 . 0 and 6 . 31<br>

<FONT FACE = "SYMBOL">D</FONT>temp = <A HREF = "#soiln2_soiltemp_dt"> Rate of change in soil surface temperature with time </A><br>

damp = <A HREF = "#soiln2_soiltemp_dampdepth"> Temperature damping depth </A><br>

cumulativedepth = 0 . 0<br>

Fill soil_temp with 0 . 0<br>

number of layers = number of elements in dlayer<br>

For each layer from 1 to number of layers<br>

<dl>cumulativedepth = cumulativedepth + dlayer<I><SUB> layer</SUB></I><br>

depth_lag = cumulativedepth / damp<br>

soil_temp<I><SUB> layer</SUB></I> = <A HREF = "#soiln2_layer_temp"> Soil temperature using depth_lag, alx, <FONT FACE = "SYMBOL">D</FONT>temp </A><br>

Check that soil_temp<I><SUB> layer</SUB></I> lies between - 20 . 0 and 80 . 0<br>

</dl>next<br>

<br>

</dl></dl>
<html>

<body>

<p><!--webbot bot="ImageMap" startspan rectangle=" (513,2) (635, 18)  APSeudo Documentation"
rectangle=" (103,4) (204, 18)  Structure Charts"
rectangle=" (14,3) (76, 18)  #Top" src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640"
height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" --><MAP NAME="FrontPageMap0"><AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top"><AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts"><AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top"></MAP><img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" usemap="#FrontPageMap0"><!--webbot bot="ImageMap"
i-checksum="58234" endspan --></p>
</body>
</html>
<A NAME = "soiln2_soiltemp_dt">  </A>
<H2>Soiln2 Soiltemp Dt</H2>
<br>
<H3><CENTER>Calculates  the rate of change in soil surface temperature with time. jngh 24-12-91.  I think this is actually a correction to adjust today's normal sinusoidal soil surface temperature to the current temperature conditions.   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

yesterday = year offset by - 1 days<br>

ave_temp = (maxt+mint) * 0 . 5<br>

surf_temp<I><SUB> day_of_year</SUB></I> = (1.0-salb) * (ave_temp+(maxt-ave_temp)*sqrt (radn * 23 . 8846 / 800 . 0)) + salb * surf_temp<I><SUB> yesterday</SUB></I><br>

For each day from 1 to ndays<br>

<dl>day_of_year = year offset by 1 - day days<br>

temp_0<I><SUB> day</SUB></I> = surf_temp<I><SUB> day_of_year</SUB></I><br>

ave_temp_0 = <FONT FACE = "SYMBOL">S</FONT><SUP>1</SUP><SUB>ndays</SUB> temp_0 / real (ndays)<br>

temp_a = <A HREF = "#soiln2_layer_temp"> Soil temperature using 0 . 0, alx, 0 . 0 </A><br>

soiln2_soiltemp_dt = ave_temp_0 - temp_a<br>

Check that soiln2_soiltemp_dt lies between - 100 . 0 and 100 . 0<br>

<br>

</dl></dl></dl>
<html>

<body>

<p><!--webbot bot="ImageMap" startspan rectangle=" (513,2) (635, 18)  APSeudo Documentation"
rectangle=" (103,4) (204, 18)  Structure Charts"
rectangle=" (14,3) (76, 18)  #Top" src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640"
height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" --><MAP NAME="FrontPageMap0"><AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top"><AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts"><AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top"></MAP><img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" usemap="#FrontPageMap0"><!--webbot bot="ImageMap"
i-checksum="58234" endspan --></p>
</body>
</html>
<A NAME = "soiln2_layer_temp">  </A>
<H2>Soiln2 Layer Temp</H2>
<br>
<H3><CENTER>Get subsoil temperature.   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

soiln2_layer_temp = ave_temp + (amp/2.0*cos (alx - depth_lag)+<FONT FACE = "SYMBOL">D</FONT>temp) * <I><BIG>e</BIG></I><SUP>- depth_lag</SUP><br>

<br>

</dl></dl>
<html>

<body>

<p><!--webbot bot="ImageMap" startspan rectangle=" (513,2) (635, 18)  APSeudo Documentation"
rectangle=" (103,4) (204, 18)  Structure Charts"
rectangle=" (14,3) (76, 18)  #Top" src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640"
height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" --><MAP NAME="FrontPageMap0"><AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top"><AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts"><AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top"></MAP><img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" usemap="#FrontPageMap0"><!--webbot bot="ImageMap"
i-checksum="58234" endspan --></p>
</body>
</html>
<A NAME = "soiln2_soiltemp_dampdepth">  </A>
<H2>Soiln2 Soiltemp Dampdepth</H2>
<br>
<H3><CENTER>Now get the temperature damping depth. This is a function of the average bulk density of the soil and the amount of water above the lower limit. I think the damping depth units are mm depth/radian of a g_year   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

number of layers = number of elements in dlayer<br>

bd<SUB>(total)</SUB> = (<FONT FACE = "SYMBOL">S</FONT><SUP>1</SUP><SUB>number of layers</SUB> bd x dlayer)<br>

cumulativedepth = <FONT FACE = "SYMBOL">S</FONT><SUP>1</SUP><SUB>number of layers</SUB> dlayer<br>

ave_bd = bd<SUB>(total)</SUB> / cumulativedepth<br>

favbd = ave_bd / (ave_bd+686.0*<I><BIG>e</BIG></I><SUP>- 5 . 63 * ave_bd</SUP>)<br>

damp_depth_max = 1000 . 0 + 2500 . 0 * favbd<br>

damp_depth_max = damp_depth_max constrained above 0 . 0<br>

ww = 0 . 356 - 0 . 144 * ave_bd<br>

ww = ww constrained above 0 . 0<br>

ll<SUB>(total)</SUB> = <FONT FACE = "SYMBOL">S</FONT><SUP>1</SUP><SUB>number of layers</SUB> ll15<SUB>(in mm)</SUB><br>

sw_dep<SUB>(total)</SUB> = <FONT FACE = "SYMBOL">S</FONT><SUP>1</SUP><SUB>number of layers</SUB> sw<SUB>(in mm)</SUB><br>

sw_avail<SUB>(total)</SUB> = sw_dep<SUB>(total)</SUB> - ll<SUB>(total)</SUB><br>

sw_avail<SUB>(total)</SUB> = sw_avail<SUB>(total)</SUB> constrained above sw_avail_tot_min<br>

wc = sw_avail<SUB>(total)</SUB> / (ww*cumulativedepth)<br>

wc = wc constrained between 0 . 0 and 1 . 0<br>

wcf = (1.0-wc) / (1.0+wc)<br>

b = <I>log</I><SUB>e</SUB>(500 . 0 / damp_depth_max)<br>

f = <I><BIG>e</BIG></I><SUP>b * wcf * * 2</SUP><br>

soiln2_soiltemp_dampdepth = f * damp_depth_max<br>

<br>

</dl></dl>
<html>

<body>

<p><!--webbot bot="ImageMap" startspan rectangle=" (513,2) (635, 18)  APSeudo Documentation"
rectangle=" (103,4) (204, 18)  Structure Charts"
rectangle=" (14,3) (76, 18)  #Top" src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640"
height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" --><MAP NAME="FrontPageMap0"><AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top"><AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts"><AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top"></MAP><img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" usemap="#FrontPageMap0"><!--webbot bot="ImageMap"
i-checksum="58234" endspan --></p>
</body>
</html>
<A NAME = "soiln2_min_residues">  </A>
<H2>Soiln2 Min Residues</H2>
<br>
<H3><CENTER>Test to see whether adequate mineral nitrogen is available to sustain potential rate of decomposition of surface residues and calculate net rate of nitrogen mineralization/immobilization   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

nlayrs = number of elements in dlayer<br>

min_layer = layer number corresponding to <A HREF = "#min_depth"> min_depth </A><br>

if (min_layer.=.1) then<br>

<dl>min_layer_top = 0 . 0<br>

</dl>else<br>

<dl>min_layer_top = <FONT FACE = "SYMBOL">S</FONT><SUP>1</SUP><SUB>min_layer - 1</SUB> dlayer<br>

</dl>endif<br>

nit<SUB>(total)</SUB> = 0 . 0<br>

For each layer from 1 to min_layer<br>

<dl>avail_no3<I><SUB> layer</SUB></I> = (no3<I><SUB> layer</SUB></I>-no3_min<I><SUB> layer</SUB></I>)<br>

avail_no3<I><SUB> layer</SUB></I> = avail_no3<I><SUB> layer</SUB></I> constrained above 0 . 0<br>

avail_nh4<I><SUB> layer</SUB></I> = (nh4<I><SUB> layer</SUB></I>-nh4_min<I><SUB> layer</SUB></I>)<br>

avail_nh4<I><SUB> layer</SUB></I> = avail_nh4<I><SUB> layer</SUB></I> constrained above 0 . 0<br>

if (layer.=.min_layer) then<br>

<dl>fraction<I><SUB> layer</SUB></I> = <A HREF = "#min_depth"> min_depth </A> - min_layer_top / dlayer<I><SUB> layer</SUB></I><br>

fraction<I><SUB> layer</SUB></I> = fraction<I><SUB> layer</SUB></I> constrained between 0 . 0 and 1 . 0<br>

</dl>else<br>

<dl>fraction<I><SUB> layer</SUB></I> = 1 . 0<br>

</dl>endif<br>

avail_no3<I><SUB> layer</SUB></I> = avail_no3<I><SUB> layer</SUB></I> * fraction<I><SUB> layer</SUB></I><br>

avail_nh4<I><SUB> layer</SUB></I> = avail_nh4<I><SUB> layer</SUB></I> * fraction<I><SUB> layer</SUB></I><br>

nit<SUB>(total)</SUB> = nit<SUB>(total)</SUB> + avail_no3<I><SUB> layer</SUB></I> + avail_nh4<I><SUB> layer</SUB></I><br>

</dl>next<br>

<FONT FACE = "SYMBOL">D</FONT>c_biom<SUB>(total)</SUB><I><SUB> :</SUB></I> = pot_c_decomp<I><SUB> :</SUB></I> * <A HREF = "#ef_res"> ef_res </A> * <A HREF = "#fr_res_biom"> fr_res_biom </A><br>

<FONT FACE = "SYMBOL">D</FONT>c_hum<SUB>(total)</SUB><I><SUB> :</SUB></I> = pot_c_decomp<I><SUB> :</SUB></I> * <A HREF = "#ef_res"> ef_res </A> * (1.0-<A HREF = "#fr_res_biom"> fr_res_biom </A>)<br>

n_demand = sum (<FONT FACE = "SYMBOL">D</FONT>c_biom<SUB>(total)</SUB><I><SUB> :</SUB></I>) / <A HREF = "#mcn"> mcn </A> + sum (<FONT FACE = "SYMBOL">D</FONT>c_hum<SUB>(total)</SUB><I><SUB> :</SUB></I>) / soil_cn<br>

n_avail = nit<SUB>(total)</SUB> + sum (pot_n_decomp<I><SUB> :</SUB></I>)<br>

if (n_demand.>.n_avail) then<br>

<dl>scale_of = nit<SUB>(total)</SUB> / (n_demand-sum (pot_n_decomp<I><SUB> :</SUB></I>))<br>

scale_of = scale_of constrained between 0 . 0 and 1 . 0<br>

</dl>else<br>

<dl>scale_of = 1 . 0<br>

</dl>endif<br>

For each = from , to<br>

<dl>part_fraction = dlayer<I><SUB> layer</SUB></I> * fraction<I><SUB> layer</SUB></I> / <A HREF = "#min_depth"> min_depth </A><br>

For each = from , to<br>

<dl><FONT FACE = "SYMBOL">D</FONT>c_decomp<I><SUB> layer, residue</SUB></I> = pot_c_decomp<I><SUB> residue</SUB></I> * scale_of * part_fraction<br>

<FONT FACE = "SYMBOL">D</FONT>n_decomp<I><SUB> layer, residue</SUB></I> = pot_n_decomp<I><SUB> residue</SUB></I> * scale_of * part_fraction<br>

<FONT FACE = "SYMBOL">D</FONT>c_hum<I><SUB> layer, residue</SUB></I> = <FONT FACE = "SYMBOL">D</FONT>c_hum<SUB>(total)</SUB><I><SUB> residue</SUB></I> * scale_of * part_fraction<br>

<FONT FACE = "SYMBOL">D</FONT>c_biom<I><SUB> layer, residue</SUB></I> = <FONT FACE = "SYMBOL">D</FONT>c_biom<SUB>(total)</SUB><I><SUB> residue</SUB></I> * scale_of * part_fraction<br>

<FONT FACE = "SYMBOL">D</FONT>c_atm<I><SUB> layer, residue</SUB></I> = <FONT FACE = "SYMBOL">D</FONT>c_decomp<I><SUB> layer, residue</SUB></I> - <FONT FACE = "SYMBOL">D</FONT>c_hum<I><SUB> layer, residue</SUB></I> - <FONT FACE = "SYMBOL">D</FONT>c_biom<I><SUB> layer, residue</SUB></I><br>

end do<br>

end do<br>

<FONT FACE = "SYMBOL">D</FONT>nh4_min = 0 . 0<br>

<FONT FACE = "SYMBOL">D</FONT>n_min = sum (<FONT FACE = "SYMBOL">D</FONT>n_decomp<I><SUB> :, :</SUB></I>) - n_demand * scale_of<br>

if (<FONT FACE = "SYMBOL">D</FONT>n_min.>.0.0) then<br>

<dl>For each = from , to<br>

<dl>part_fraction = dlayer<I><SUB> layer</SUB></I> * fraction<I><SUB> layer</SUB></I> / <A HREF = "#min_depth"> min_depth </A><br>

<FONT FACE = "SYMBOL">D</FONT>nh4_min<I><SUB> layer</SUB></I> = <FONT FACE = "SYMBOL">D</FONT>n_min * part_fraction<br>

end do<br>

</dl>else if (<FONT FACE = "SYMBOL">D</FONT>n_min.<.0.0) then<br>

<dl>For each layer from 1 to min_layer<br>

<dl><FONT FACE = "SYMBOL">D</FONT>nh4_min<I><SUB> layer</SUB></I> = - minimum of (avail_nh4<I><SUB> layer</SUB></I>, abs (<FONT FACE = "SYMBOL">D</FONT>n_min))<br>

<FONT FACE = "SYMBOL">D</FONT>n_min = <FONT FACE = "SYMBOL">D</FONT>n_min - <FONT FACE = "SYMBOL">D</FONT>nh4_min<I><SUB> layer</SUB></I><br>

</dl>next<br>

For each layer from 1 to min_layer<br>

<dl><FONT FACE = "SYMBOL">D</FONT>no3_min<I><SUB> layer</SUB></I> = - minimum of (avail_no3<I><SUB> layer</SUB></I>, abs (<FONT FACE = "SYMBOL">D</FONT>n_min))<br>

<FONT FACE = "SYMBOL">D</FONT>n_min = <FONT FACE = "SYMBOL">D</FONT>n_min - <FONT FACE = "SYMBOL">D</FONT>no3_min<I><SUB> layer</SUB></I><br>

</dl>next<br>

Check that <FONT FACE = "SYMBOL">D</FONT>n_min lies between - 0 . 001 and 0 . 001<br>

</dl>else<br>

endif<br>

<br>

</dl></dl></dl></dl></dl>
<html>

<body>

<p><!--webbot bot="ImageMap" startspan rectangle=" (513,2) (635, 18)  APSeudo Documentation"
rectangle=" (103,4) (204, 18)  Structure Charts"
rectangle=" (14,3) (76, 18)  #Top" src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640"
height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" --><MAP NAME="FrontPageMap0"><AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top"><AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts"><AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top"></MAP><img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" usemap="#FrontPageMap0"><!--webbot bot="ImageMap"
i-checksum="58234" endspan --></p>
</body>
</html>
<A NAME = "soiln2_urea_hydrolysis">  </A>
<H2>Soiln2 Urea Hydrolysis</H2>
<br>
<H3><CENTER>Hydrolyse g_urea. NOTE - not tested as not in old code - from CM V2.   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

if (urea<I><SUB> layer</SUB></I>.>.0.0) then<br>

<dl>if (urea<I><SUB> layer</SUB></I>.<.0.1) then<br>

<dl><FONT FACE = "SYMBOL">D</FONT>urea_hydrol = urea<I><SUB> layer</SUB></I><br>

</dl>else<br>

<dl>swf = <A HREF = "#soiln2_wf"> Water factor for mineralisation in layer </A> + 0 . 20<br>

swf = swf constrained between 0 . 0 and 1 . 0<br>

tf = (soil_temp<I><SUB> layer</SUB></I>/40.0) + 0 . 20<br>

tf = tf constrained between 0 . 0 and 1 . 0<br>

ak = - 1 . 12 + 1 . 31 * oc<I><SUB> layer</SUB></I> + 0 . 203 * ph<I><SUB> layer</SUB></I> - 0 . 155 * oc<I><SUB> layer</SUB></I> * ph<I><SUB> layer</SUB></I><br>

ak = ak constrained between 0 . 25 and 1 . 0<br>

<FONT FACE = "SYMBOL">D</FONT>urea_hydrol = ak * urea<I><SUB> layer</SUB></I> * minimum of (swf, tf)<br>

<FONT FACE = "SYMBOL">D</FONT>urea_hydrol = <FONT FACE = "SYMBOL">D</FONT>urea_hydrol constrained between 0 . 0 and urea<I><SUB> layer</SUB></I><br>

</dl>endif<br>

</dl>else<br>

<dl><FONT FACE = "SYMBOL">D</FONT>urea_hydrol = 0 . 0<br>

</dl>endif<br>

<br>

</dl></dl>
<html>

<body>

<p><!--webbot bot="ImageMap" startspan rectangle=" (513,2) (635, 18)  APSeudo Documentation"
rectangle=" (103,4) (204, 18)  Structure Charts"
rectangle=" (14,3) (76, 18)  #Top" src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640"
height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" --><MAP NAME="FrontPageMap0"><AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top"><AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts"><AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top"></MAP><img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" usemap="#FrontPageMap0"><!--webbot bot="ImageMap"
i-checksum="58234" endspan --></p>
</body>
</html>
<A NAME = "soiln2_wf">  </A>
<H2>Soiln2 Wf</H2>
<br>
<H3><CENTER>Calculates a 0-1 water factor for mineralisation.   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

if (sw<SUB>(in mm)</SUB><I><SUB> layer</SUB></I>.>.dul<SUB>(in mm)</SUB><I><SUB> layer</SUB></I>) then<br>

<dl>wfd = 1 . 0 + sw<SUB>(in mm)</SUB><I><SUB> layer</SUB></I> - dul<SUB>(in mm)</SUB><I><SUB> layer</SUB></I> / sat<SUB>(in mm)</SUB><I><SUB> layer</SUB></I> - dul<SUB>(in mm)</SUB><I><SUB> layer</SUB></I><br>

wfd = wfd constrained between 1 . 0 and 2 . 0<br>

</dl>else<br>

<dl>wfd = sw<SUB>(in mm)</SUB><I><SUB> layer</SUB></I> - ll15<SUB>(in mm)</SUB><I><SUB> layer</SUB></I> / (dul<SUB>(in mm)</SUB><I><SUB> layer</SUB></I>-ll15<SUB>(in mm)</SUB><I><SUB> layer</SUB></I>)<br>

wfd = wfd constrained between 0 . 0 and 1 . 0<br>

</dl>endif<br>

soiln2_wf = A linearly interpolated value based upon wfd (where X = <A HREF = "#wf_min_index"> wf_min_index </A>, Y = <A HREF = "#wf_min_values"> wf_min_values </A>)..<br>

<br>

</dl></dl>
<html>

<body>

<p><!--webbot bot="ImageMap" startspan rectangle=" (513,2) (635, 18)  APSeudo Documentation"
rectangle=" (103,4) (204, 18)  Structure Charts"
rectangle=" (14,3) (76, 18)  #Top" src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640"
height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" --><MAP NAME="FrontPageMap0"><AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top"><AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts"><AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top"></MAP><img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" usemap="#FrontPageMap0"><!--webbot bot="ImageMap"
i-checksum="58234" endspan --></p>
</body>
</html>
<A NAME = "soiln2_denitrification">  </A>
<H2>Soiln2 Denitrification</H2>
<br>
<H3><CENTER>Calculates denitrification whenever the soil water in the layer > the drained upper limit (Godwin et al., 1984), the NO3 nitrogen concentration > 1 mg N/kg soil, and the soil temperature >= a minimum temperature. NOTE denitrification routine not validated   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

if (no3<I><SUB> layer</SUB></I>.>=.no3_min<I><SUB> layer</SUB></I>.and.sw<SUB>(in mm)</SUB><I><SUB> layer</SUB></I>.>.dul<SUB>(in mm)</SUB><I><SUB> layer</SUB></I>) then<br>

<dl>hum_c_conc = hum_c<I><SUB> layer</SUB></I> * <A HREF = "#soiln2_fac"> Conversion factor (kg/ha to ppm) </A><br>

fom_c_conc = <FONT FACE = "SYMBOL">S</FONT><SUP>1</SUP><SUB>nfract</SUB> fom_pool<I><SUB> 1, layer</SUB></I> * <A HREF = "#soiln2_fac"> Conversion factor (kg/ha to ppm) </A><br>

active_c = 0 . 0031 * (fom_c_conc+hum_c_conc) + 24 . 5<br>

wf = <A HREF = "#soiln2_wf_denit"> Water factor for denitrification in layer </A><br>

tf = 0 . 1 * <I><BIG>e</BIG></I><SUP>0 . 046 * soil_temp<I><SUB> layer</SUB></I></SUP><br>

tf = tf constrained between 0 . 0 and 1 . 0<br>

<FONT FACE = "SYMBOL">D</FONT>n_atm = dnit_rate_coeff * active_c * wf * tf * no3<I><SUB> layer</SUB></I><br>

no3_avail = no3<I><SUB> layer</SUB></I> - no3_min<I><SUB> layer</SUB></I><br>

<FONT FACE = "SYMBOL">D</FONT>n_atm = <FONT FACE = "SYMBOL">D</FONT>n_atm constrained between 0 . 0 and no3_avail<br>

</dl>else<br>

<dl><FONT FACE = "SYMBOL">D</FONT>n_atm = 0 . 0<br>

</dl>endif<br>

<br>

</dl></dl>
<html>

<body>

<p><!--webbot bot="ImageMap" startspan rectangle=" (513,2) (635, 18)  APSeudo Documentation"
rectangle=" (103,4) (204, 18)  Structure Charts"
rectangle=" (14,3) (76, 18)  #Top" src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640"
height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" --><MAP NAME="FrontPageMap0"><AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top"><AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts"><AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top"></MAP><img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" usemap="#FrontPageMap0"><!--webbot bot="ImageMap"
i-checksum="58234" endspan --></p>
</body>
</html>
<A NAME = "soiln2_fac">  </A>
<H2>Soiln2 Fac</H2>
<br>
<H3><CENTER>Convert kg/ha to ppm of soil in a given layer   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

soiln2_fac = 100 . 0 / bd<I><SUB> layer</SUB></I> * dlayer<I><SUB> layer</SUB></I><br>

<br>

</dl></dl>
<html>

<body>

<p><!--webbot bot="ImageMap" startspan rectangle=" (513,2) (635, 18)  APSeudo Documentation"
rectangle=" (103,4) (204, 18)  Structure Charts"
rectangle=" (14,3) (76, 18)  #Top" src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640"
height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" --><MAP NAME="FrontPageMap0"><AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top"><AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts"><AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top"></MAP><img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" usemap="#FrontPageMap0"><!--webbot bot="ImageMap"
i-checksum="58234" endspan --></p>
</body>
</html>
<A NAME = "soiln2_wf_denit">  </A>
<H2>Soiln2 Wf Denit</H2>
<br>
<H3><CENTER>Calculates a 0-1 water factor for denitrification   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

if (sw<SUB>(in mm)</SUB><I><SUB> layer</SUB></I>.>.dul<SUB>(in mm)</SUB><I><SUB> layer</SUB></I>) then<br>

<dl>wfd = sat<SUB>(in mm)</SUB><I><SUB> layer</SUB></I> - sw<SUB>(in mm)</SUB><I><SUB> layer</SUB></I> / sat<SUB>(in mm)</SUB><I><SUB> layer</SUB></I> - dul<SUB>(in mm)</SUB><I><SUB> layer</SUB></I><br>

</dl>else<br>

<dl>wfd = sw<SUB>(in mm)</SUB><I><SUB> layer</SUB></I> - ll15<SUB>(in mm)</SUB><I><SUB> layer</SUB></I> / 0 . 5 * (dul<SUB>(in mm)</SUB><I><SUB> layer</SUB></I>-ll15<SUB>(in mm)</SUB><I><SUB> layer</SUB></I>)<br>

</dl>endif<br>

wfd = wfd constrained between 0 . 0 and 1 . 0<br>

soiln2_wf_denit = 1 . 0 - wfd<br>

<br>

</dl></dl>
<html>

<body>

<p><!--webbot bot="ImageMap" startspan rectangle=" (513,2) (635, 18)  APSeudo Documentation"
rectangle=" (103,4) (204, 18)  Structure Charts"
rectangle=" (14,3) (76, 18)  #Top" src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640"
height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" --><MAP NAME="FrontPageMap0"><AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top"><AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts"><AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top"></MAP><img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" usemap="#FrontPageMap0"><!--webbot bot="ImageMap"
i-checksum="58234" endspan --></p>
</body>
</html>
<A NAME = "soiln2_min_humic">  </A>
<H2>Soiln2 Min Humic</H2>
<br>
<H3><CENTER>Mineralise some humic material.  Calculates the daily rate of decomposition and net nitrogen mineralisation from the humic pool.   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

tf = <A HREF = "#soiln2_tf"> Nitrification and mineralisation soil temperature factor in layer </A><br>

mf = <A HREF = "#soiln2_wf"> Water factor for mineralisation in layer </A><br>

<FONT FACE = "SYMBOL">D</FONT>c_min<SUB>(total)</SUB> = (hum_c<I><SUB> layer</SUB></I>-inert_c<I><SUB> layer</SUB></I>) * <A HREF = "#rd_hum"> rd_hum </A> * tf * mf<br>

<FONT FACE = "SYMBOL">D</FONT>n_min<SUB>(total)</SUB> = <FONT FACE = "SYMBOL">D</FONT>c_min<SUB>(total)</SUB> / soil_cn<br>

<FONT FACE = "SYMBOL">D</FONT>c_biom = <FONT FACE = "SYMBOL">D</FONT>c_min<SUB>(total)</SUB> * <A HREF = "#ef_hum"> ef_hum </A><br>

<FONT FACE = "SYMBOL">D</FONT>c_atm = <FONT FACE = "SYMBOL">D</FONT>c_min<SUB>(total)</SUB> * (1.0-<A HREF = "#ef_hum"> ef_hum </A>)<br>

<FONT FACE = "SYMBOL">D</FONT>n_min = <FONT FACE = "SYMBOL">D</FONT>n_min<SUB>(total)</SUB> - <FONT FACE = "SYMBOL">D</FONT>c_biom / <A HREF = "#mcn"> mcn </A><br>

<br>

</dl></dl>
<html>

<body>

<p><!--webbot bot="ImageMap" startspan rectangle=" (513,2) (635, 18)  APSeudo Documentation"
rectangle=" (103,4) (204, 18)  Structure Charts"
rectangle=" (14,3) (76, 18)  #Top" src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640"
height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" --><MAP NAME="FrontPageMap0"><AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top"><AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts"><AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top"></MAP><img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" usemap="#FrontPageMap0"><!--webbot bot="ImageMap"
i-checksum="58234" endspan --></p>
</body>
</html>
<A NAME = "soiln2_tf">  </A>
<H2>Soiln2 Tf</H2>
<br>
<H3><CENTER>Calculate a temperature factor, based on the soil temperature of the layer, for nitrification and mineralisation   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

tf = soil_temp<I><SUB> layer</SUB></I> * soil_temp<I><SUB> layer</SUB></I> / <A HREF = "#opt_temp"> opt_temp </A> * * 2 . 0<br>

tf = tf constrained between 0 . 0 and 1 . 0<br>

soiln2_tf = tf<br>

<br>

</dl></dl>
<html>

<body>

<p><!--webbot bot="ImageMap" startspan rectangle=" (513,2) (635, 18)  APSeudo Documentation"
rectangle=" (103,4) (204, 18)  Structure Charts"
rectangle=" (14,3) (76, 18)  #Top" src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640"
height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" --><MAP NAME="FrontPageMap0"><AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top"><AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts"><AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top"></MAP><img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" usemap="#FrontPageMap0"><!--webbot bot="ImageMap"
i-checksum="58234" endspan --></p>
</body>
</html>
<A NAME = "soiln2_min_biomass">  </A>
<H2>Soiln2 Min Biomass</H2>
<br>
<H3><CENTER>Mineralise some soil biomass material.  Calculates the daily rate of decomposition and net nitrogen mineralisation from the biomass pool   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

tf = <A HREF = "#soiln2_tf"> Nitrification and mineralisation soil temperature factor in layer </A><br>

mf = <A HREF = "#soiln2_wf"> Water factor for mineralisation in layer </A><br>

<FONT FACE = "SYMBOL">D</FONT>n_min<SUB>(total)</SUB> = biom_n<I><SUB> layer</SUB></I> * <A HREF = "#rd_biom"> rd_biom </A> * tf * mf<br>

<FONT FACE = "SYMBOL">D</FONT>c_min<SUB>(total)</SUB> = <FONT FACE = "SYMBOL">D</FONT>n_min<SUB>(total)</SUB> * <A HREF = "#mcn"> mcn </A><br>

<FONT FACE = "SYMBOL">D</FONT>c_hum = <FONT FACE = "SYMBOL">D</FONT>c_min<SUB>(total)</SUB> * <A HREF = "#ef_biom"> ef_biom </A> * (1.0-<A HREF = "#fr_biom_biom"> fr_biom_biom </A>)<br>

<FONT FACE = "SYMBOL">D</FONT>c_atm = <FONT FACE = "SYMBOL">D</FONT>c_min<SUB>(total)</SUB> * (1.0-<A HREF = "#ef_biom"> ef_biom </A>)<br>

<FONT FACE = "SYMBOL">D</FONT>n_min = <FONT FACE = "SYMBOL">D</FONT>n_min<SUB>(total)</SUB> - <FONT FACE = "SYMBOL">D</FONT>c_hum / soil_cn - (<FONT FACE = "SYMBOL">D</FONT>c_min<SUB>(total)</SUB>-<FONT FACE = "SYMBOL">D</FONT>c_atm-<FONT FACE = "SYMBOL">D</FONT>c_hum) / <A HREF = "#mcn"> mcn </A><br>

<br>

</dl></dl>
<html>

<body>

<p><!--webbot bot="ImageMap" startspan rectangle=" (513,2) (635, 18)  APSeudo Documentation"
rectangle=" (103,4) (204, 18)  Structure Charts"
rectangle=" (14,3) (76, 18)  #Top" src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640"
height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" --><MAP NAME="FrontPageMap0"><AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top"><AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts"><AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top"></MAP><img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" usemap="#FrontPageMap0"><!--webbot bot="ImageMap"
i-checksum="58234" endspan --></p>
</body>
</html>
<A NAME = "soiln2_min_fom">  </A>
<H2>Soiln2 Min Fom</H2>
<br>
<H3><CENTER>Mineralise some fresh organic matter. Calculates the daily rate of decomposition, partitions the carbon in to soil pools and loss to atmosphere, and the net nitrogen mineralisation (negative if N immobilized) from the fresh organic matter pool.   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

nit<SUB>(total)</SUB> = (no3<I><SUB> layer</SUB></I>-no3_min<I><SUB> layer</SUB></I>) + (nh4<I><SUB> layer</SUB></I>-nh4_min<I><SUB> layer</SUB></I>)<br>

nit<SUB>(total)</SUB> = nit<SUB>(total)</SUB> constrained above 0 . 0<br>

fom_c = <FONT FACE = "SYMBOL">S</FONT><SUP>1</SUP><SUB>nfract</SUB> fom_pool<I><SUB> 1, layer</SUB></I><br>

cnr = fom_c / fom_n<I><SUB> layer</SUB></I> + nit<SUB>(total)</SUB><br>

cnrf = <I><BIG>e</BIG></I><SUP>- <A HREF = "#cnrf_coeff"> cnrf_coeff </A> * (cnr-<A HREF = "#cnrf_optcn"> cnrf_optcn </A>) / <A HREF = "#cnrf_optcn"> cnrf_optcn </A></SUP><br>

cnrf = cnrf constrained between 0 . 0 and 1 . 0<br>

tf = <A HREF = "#soiln2_tf"> Nitrification and mineralisation soil temperature factor in layer </A><br>

mf = <A HREF = "#soiln2_wf"> Water factor for mineralisation in layer </A><br>

if (fom_c.>=.<A HREF = "#fom_min"> fom_min </A>) then<br>

<dl><FONT FACE = "SYMBOL">D</FONT>n_min<SUB>(total)</SUB> = 0 . 0<br>

<FONT FACE = "SYMBOL">D</FONT>fom_c_min<SUB>(total)</SUB> = 0 . 0<br>

fom_cn = fom_c / fom_n<I><SUB> layer</SUB></I><br>

For each fractn from 1 to nfract<br>

<dl>drate = <A HREF = "#rd_fom"> rd_fom </A><I><SUB> fractn</SUB></I> * cnrf * tf * mf<br>

grcm = drate * fom_pool<I><SUB> fractn, layer</SUB></I><br>

grnm = grcm / fom_cn<br>

<FONT FACE = "SYMBOL">D</FONT>n_min<SUB>(total)</SUB> = <FONT FACE = "SYMBOL">D</FONT>n_min<SUB>(total)</SUB> + grnm<br>

<FONT FACE = "SYMBOL">D</FONT>c_min<SUB>(total)</SUB><I><SUB> fractn</SUB></I> = grcm<br>

<FONT FACE = "SYMBOL">D</FONT>fom_c_min<SUB>(total)</SUB> = <FONT FACE = "SYMBOL">D</FONT>fom_c_min<SUB>(total)</SUB> + grcm<br>

<FONT FACE = "SYMBOL">D</FONT>c_biom<SUB>(total)</SUB> = <FONT FACE = "SYMBOL">D</FONT>fom_c_min<SUB>(total)</SUB> * <A HREF = "#ef_fom"> ef_fom </A> * <A HREF = "#fr_fom_biom"> fr_fom_biom </A><br>

<FONT FACE = "SYMBOL">D</FONT>c_hum<SUB>(total)</SUB> = <FONT FACE = "SYMBOL">D</FONT>fom_c_min<SUB>(total)</SUB> * <A HREF = "#ef_fom"> ef_fom </A> * (1.0-<A HREF = "#fr_fom_biom"> fr_fom_biom </A>)<br>

n_demand = <FONT FACE = "SYMBOL">D</FONT>c_biom<SUB>(total)</SUB> / <A HREF = "#mcn"> mcn </A> + <FONT FACE = "SYMBOL">D</FONT>c_hum<SUB>(total)</SUB> / soil_cn<br>

n_avail = nit<SUB>(total)</SUB> + <FONT FACE = "SYMBOL">D</FONT>n_min<SUB>(total)</SUB><br>

if (n_demand.>.n_avail) then<br>

<dl>scale_of = nit<SUB>(total)</SUB> / n_demand - <FONT FACE = "SYMBOL">D</FONT>n_min<SUB>(total)</SUB><br>

scale_of = scale_of constrained between 0 . 0 and 1 . 0<br>

</dl>else<br>

<dl>scale_of = 1 . 0<br>

</dl>endif<br>

For each fractn from 1 to nfract<br>

<dl><FONT FACE = "SYMBOL">D</FONT>c_hum<I><SUB> fractn</SUB></I> = <FONT FACE = "SYMBOL">D</FONT>c_min<SUB>(total)</SUB><I><SUB> fractn</SUB></I> * <A HREF = "#ef_fom"> ef_fom </A> * (1.0-<A HREF = "#fr_fom_biom"> fr_fom_biom </A>) * scale_of<br>

<FONT FACE = "SYMBOL">D</FONT>c_biom<I><SUB> fractn</SUB></I> = <FONT FACE = "SYMBOL">D</FONT>c_min<SUB>(total)</SUB><I><SUB> fractn</SUB></I> * <A HREF = "#ef_fom"> ef_fom </A> * <A HREF = "#fr_fom_biom"> fr_fom_biom </A> * scale_of<br>

<FONT FACE = "SYMBOL">D</FONT>c_atm<I><SUB> fractn</SUB></I> = <FONT FACE = "SYMBOL">D</FONT>c_min<SUB>(total)</SUB><I><SUB> fractn</SUB></I> * (1.0-<A HREF = "#ef_fom"> ef_fom </A>) * scale_of<br>

</dl>next<br>

<FONT FACE = "SYMBOL">D</FONT>n_min = (<FONT FACE = "SYMBOL">D</FONT>n_min<SUB>(total)</SUB>-n_demand) * scale_of<br>

</dl>else<br>

<dl>Fill <FONT FACE = "SYMBOL">D</FONT>c_hum with 0 . 0<br>

Fill <FONT FACE = "SYMBOL">D</FONT>c_biom with 0 . 0<br>

Fill <FONT FACE = "SYMBOL">D</FONT>c_atm with 0 . 0<br>

<FONT FACE = "SYMBOL">D</FONT>n_min = 0 . 0<br>

</dl>endif<br>

<br>

</dl></dl></dl>
<html>

<body>

<p><!--webbot bot="ImageMap" startspan rectangle=" (513,2) (635, 18)  APSeudo Documentation"
rectangle=" (103,4) (204, 18)  Structure Charts"
rectangle=" (14,3) (76, 18)  #Top" src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640"
height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" --><MAP NAME="FrontPageMap0"><AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top"><AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts"><AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top"></MAP><img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" usemap="#FrontPageMap0"><!--webbot bot="ImageMap"
i-checksum="58234" endspan --></p>
</body>
</html>
<A NAME = "soiln2_nitrification">  </A>
<H2>Soiln2 Nitrification</H2>
<br>
<H3><CENTER>Calculates nitrification of NH4 in a given soil layer.   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

phf = <A HREF = "#soiln2_phf_nitrf"> Calculate pH factor for nitrification </A><br>

wfd = <A HREF = "#soiln2_wf_nitrf"> Water factor for nitrification in layer </A><br>

tf = <A HREF = "#soiln2_tf"> Nitrification and mineralisation soil temperature factor in layer </A><br>

pni = minimum of (wfd, tf, phf)<br>

nh4ppm = nh4<I><SUB> layer</SUB></I> * <A HREF = "#soiln2_fac"> Conversion factor (kg/ha to ppm) </A><br>

opt_rate_ppm = <A HREF = "#nitrification_pot"> nitrification_pot </A> * nh4ppm / (nh4ppm+<A HREF = "#nh4_at_half_pot"> nh4_at_half_pot </A>)<br>

opt_rate = opt_rate_ppm / <A HREF = "#soiln2_fac"> Conversion factor (kg/ha to ppm) </A><br>

<FONT FACE = "SYMBOL">D</FONT>rntrf = pni * opt_rate<br>

nh4_avail = nh4<I><SUB> layer</SUB></I> - nh4_min<I><SUB> layer</SUB></I> constrained above 0 . 0<br>

<FONT FACE = "SYMBOL">D</FONT>rntrf = <FONT FACE = "SYMBOL">D</FONT>rntrf constrained between 0 . 0 and nh4_avail<br>

<br>

</dl></dl>
<html>

<body>

<p><!--webbot bot="ImageMap" startspan rectangle=" (513,2) (635, 18)  APSeudo Documentation"
rectangle=" (103,4) (204, 18)  Structure Charts"
rectangle=" (14,3) (76, 18)  #Top" src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640"
height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" --><MAP NAME="FrontPageMap0"><AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top"><AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts"><AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top"></MAP><img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" usemap="#FrontPageMap0"><!--webbot bot="ImageMap"
i-checksum="58234" endspan --></p>
</body>
</html>
<A NAME = "soiln2_phf_nitrf">  </A>
<H2>Soiln2 Phf Nitrf</H2>
<br>
<H3><CENTER>Calculates a 0-1 pH factor for nitrification.   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

soiln2_phf_nitrf = A linearly interpolated value based upon ph<I><SUB> layer</SUB></I> (where X = <A HREF = "#phf_nit_ph"> phf_nit_ph </A>, Y = <A HREF = "#phf_nit_values"> phf_nit_values </A>)..<br>

<br>

</dl></dl>
<html>

<body>

<p><!--webbot bot="ImageMap" startspan rectangle=" (513,2) (635, 18)  APSeudo Documentation"
rectangle=" (103,4) (204, 18)  Structure Charts"
rectangle=" (14,3) (76, 18)  #Top" src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640"
height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" --><MAP NAME="FrontPageMap0"><AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top"><AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts"><AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top"></MAP><img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" usemap="#FrontPageMap0"><!--webbot bot="ImageMap"
i-checksum="58234" endspan --></p>
</body>
</html>
<A NAME = "soiln2_wf_nitrf">  </A>
<H2>Soiln2 Wf Nitrf</H2>
<br>
<H3><CENTER>Calculates a 0-1 water factor for nitrification.   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

if (sw<SUB>(in mm)</SUB><I><SUB> layer</SUB></I>.>.dul<SUB>(in mm)</SUB><I><SUB> layer</SUB></I>) then<br>

<dl>wfd = 1 . 0 + sw<SUB>(in mm)</SUB><I><SUB> layer</SUB></I> - dul<SUB>(in mm)</SUB><I><SUB> layer</SUB></I> / sat<SUB>(in mm)</SUB><I><SUB> layer</SUB></I> - dul<SUB>(in mm)</SUB><I><SUB> layer</SUB></I><br>

wfd = wfd constrained between 1 . 0 and 2 . 0<br>

</dl>else<br>

<dl>wfd = sw<SUB>(in mm)</SUB><I><SUB> layer</SUB></I> - ll15<SUB>(in mm)</SUB><I><SUB> layer</SUB></I> / (dul<SUB>(in mm)</SUB><I><SUB> layer</SUB></I>-ll15<SUB>(in mm)</SUB><I><SUB> layer</SUB></I>)<br>

wfd = wfd constrained between 0 . 0 and 1 . 0<br>

</dl>endif<br>

soiln2_wf_nitrf = A linearly interpolated value based upon wfd (where X = <A HREF = "#wf_nit_index"> wf_nit_index </A>, Y = <A HREF = "#wf_nit_values"> wf_nit_values </A>)..<br>

<br>

</dl></dl>
<html>

<body>

<p><!--webbot bot="ImageMap" startspan rectangle=" (513,2) (635, 18)  APSeudo Documentation"
rectangle=" (103,4) (204, 18)  Structure Charts"
rectangle=" (14,3) (76, 18)  #Top" src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640"
height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" --><MAP NAME="FrontPageMap0"><AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top"><AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts"><AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top"></MAP><img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" usemap="#FrontPageMap0"><!--webbot bot="ImageMap"
i-checksum="58234" endspan --></p>
</body>
</html>
<H2><BIG><A NAME = "Incorporate Fresh Organic Matter"> Incorporate Fresh Organic Matter </A></BIG></H2>
<A NAME = "soiln2_incorp_fom">  </A>
<H2>Soiln2 Incorp Fom</H2>
<br>
<H3><CENTER>Add roots into fom pools   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

Get <FONT FACE = "SYMBOL">D</FONT>fom_type from the message <I>(OPTIONAL)</I><br>

fom_type = find_string_in_array<I><SUB> <FONT FACE = "SYMBOL">D</FONT>fom_type, fom_types, number offom_types</SUB></I><br>

if (fom_type.<=.0) then<br>

<dl>fom_type = 1<br>

</dl>else<br>

endif<br>

Get <FONT FACE = "SYMBOL">D</FONT>fom_incorp from the message (Lower Bound = - 100000 . 0, Upper Bound = 100000 . 0)<br>

Get <FONT FACE = "SYMBOL">D</FONT>fom_n_incorp from the message (Lower Bound = - 10000 . 0, Upper Bound = 10000 . 0)<I>(OPTIONAL)</I><br>

if (numval_n.=.0) then<br>

<dl>Get <FONT FACE = "SYMBOL">D</FONT>fom_cnr_incorp from the message (Lower Bound = 0 . 0, Upper Bound = 10000 . 0)<I>(OPTIONAL)</I><br>

For each layer from 1 to numval_cnr<br>

<dl><FONT FACE = "SYMBOL">D</FONT>fom_n_incorp<I><SUB> layer</SUB></I> = <FONT FACE = "SYMBOL">D</FONT>fom_incorp<I><SUB> layer</SUB></I> * <A HREF = "#in_fom"> in_fom </A> / <FONT FACE = "SYMBOL">D</FONT>fom_cnr_incorp<I><SUB> layer</SUB></I><br>

</dl>else<br>

endif<br>

if (numval_n.=.0.and.numval_cnr.=.0) then<br>

<dl>Fill <FONT FACE = "SYMBOL">D</FONT>fom_incorp with 0 . 0<br>

Fill <FONT FACE = "SYMBOL">D</FONT>fom_n_incorp with 0 . 0<br>

err_string = 'fom weight or fom cn ratio not specified.'<br>

Print a warning error<br>

</dl>else<br>

endif<br>

For each layer from 1 to number of values returned<br>

<dl>fom_n<I><SUB> layer</SUB></I> = fom_n<I><SUB> layer</SUB></I> + <FONT FACE = "SYMBOL">D</FONT>fom_n_incorp<I><SUB> layer</SUB></I><br>

For each fract from 1 to nfract<br>

<dl>fom_pool<I><SUB> fract, layer</SUB></I> = fom_pool<I><SUB> fract, layer</SUB></I> + <FONT FACE = "SYMBOL">D</FONT>fom_incorp<I><SUB> layer</SUB></I> * <A HREF = "#fr_fom"> fr_fom </A><I><SUB> fract, fom_type</SUB></I> * <A HREF = "#in_fom"> in_fom </A><br>

<A HREF = "#soiln2_incorp_min_n"> Add mineral N to nitrogen and ammonium pools </A><br>

<br>

</dl></dl></dl></dl></dl>
<html>

<body>

<p><!--webbot bot="ImageMap" startspan rectangle=" (513,2) (635, 18)  APSeudo Documentation"
rectangle=" (103,4) (204, 18)  Structure Charts"
rectangle=" (14,3) (76, 18)  #Top" src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640"
height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" --><MAP NAME="FrontPageMap0"><AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top"><AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts"><AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top"></MAP><img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" usemap="#FrontPageMap0"><!--webbot bot="ImageMap"
i-checksum="58234" endspan --></p>
</body>
</html>
<A NAME = "soiln2_incorp_min_n">  </A>
<H2>Soiln2 Incorp Min N</H2>
<br>
<H3><CENTER>Add mineral N to soil nh4&no3 pools. The mineral N is due to incorporation via tillage  </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

Get <FONT FACE = "SYMBOL">D</FONT>no3_incorp from the message (Lower Bound = - 10000 . 0, Upper Bound = 10000 . 0)<I>(OPTIONAL)</I><br>

Get <FONT FACE = "SYMBOL">D</FONT>nh4_incorp from the message (Lower Bound = - 10000 . 0, Upper Bound = 10000 . 0)<I>(OPTIONAL)</I><br>

if (numval_no3.=.numval_nh4) then<br>

<dl>number of values returned = numval_no3<br>

</dl>else if (numval_no3.=.0.or.numval_nh4.=.0) then<br>

<dl>number of values returned = maximum of (numval_no3, numval_nh4)<br>

</dl>else<br>

<dl>err_string = 'depth of incorp is different for no3 & nh4.'<br>

Print a warning error<br>

number of values returned = numval_no3<br>

</dl>endif<br>

For each layer from 1 to number of values returned<br>

<dl>no3<I><SUB> layer</SUB></I> = no3<I><SUB> layer</SUB></I> + <FONT FACE = "SYMBOL">D</FONT>no3_incorp<I><SUB> layer</SUB></I><br>

nh4<I><SUB> layer</SUB></I> = nh4<I><SUB> layer</SUB></I> + <FONT FACE = "SYMBOL">D</FONT>nh4_incorp<I><SUB> layer</SUB></I><br>

<br>

</dl></dl></dl>
<html>

<body>

<p><!--webbot bot="ImageMap" startspan rectangle=" (513,2) (635, 18)  APSeudo Documentation"
rectangle=" (103,4) (204, 18)  Structure Charts"
rectangle=" (14,3) (76, 18)  #Top" src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640"
height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" --><MAP NAME="FrontPageMap0"><AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top"><AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts"><AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top"></MAP><img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" usemap="#FrontPageMap0"><!--webbot bot="ImageMap"
i-checksum="58234" endspan --></p>
</body>
</html>
<TABLE WIDTH = 100% ALIGN=center BORDER=1><CAPTION><H1><A NAME = "standard.soiln2.constants"> Standard Constants </A></H1></CAPTION><TD><B>Parameter</B></TD><TD><B>Description</B></TD><TD><B>Specification</B></TD><TD><B>Usage</B></TD><TR><TD VALIGN=TOP><A NAME = "cnrf_coeff"> cnrf_coeff </A></TD><TD> coeff. to determine the magnitude of C:N effects on decomposition of FOM ()</TD><TD> 0.693   ()</TD><TD><A HREF = "#soiln2_zero_variables"> soiln2_zero_variables </A> , <A HREF = "#soiln2_read_constants"> soiln2_read_constants </A> , <A HREF = "#soiln2_min_fom"> soiln2_min_fom </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "cnrf_optcn"> cnrf_optcn </A></TD><TD> C:N above which decomposition rate of FOM declines ()</TD><TD> 25.0    ()</TD><TD><A HREF = "#soiln2_zero_variables"> soiln2_zero_variables </A> , <A HREF = "#soiln2_read_constants"> soiln2_read_constants </A> , <A HREF = "#soiln2_min_fom"> soiln2_min_fom </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "ef_biom"> ef_biom </A></TD><TD> fraction of biomass C mineralized retained in system (0-1)</TD><TD> 0.4        ()</TD><TD><A HREF = "#soiln2_zero_variables"> soiln2_zero_variables </A> , <A HREF = "#soiln2_read_constants"> soiln2_read_constants </A> , <A HREF = "#soiln2_min_biomass"> soiln2_min_biomass </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "ef_fom"> ef_fom </A></TD><TD> fraction of FOM C mineralized retained in system (0-1)</TD><TD> 0.4         ()</TD><TD><A HREF = "#soiln2_zero_variables"> soiln2_zero_variables </A> , <A HREF = "#soiln2_read_constants"> soiln2_read_constants </A> , <A HREF = "#soiln2_min_fom"> soiln2_min_fom </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "ef_hum"> ef_hum </A></TD><TD> fraction of humic C mineralized retained in system (0-1)</TD><TD> 0.4         ()</TD><TD><A HREF = "#soiln2_zero_variables"> soiln2_zero_variables </A> , <A HREF = "#soiln2_read_constants"> soiln2_read_constants </A> , <A HREF = "#soiln2_min_humic"> soiln2_min_humic </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "ef_res"> ef_res </A></TD><TD> fraction of residue C mineralized retained in system (0-1)</TD><TD> 0.4         ()</TD><TD><A HREF = "#soiln2_zero_variables"> soiln2_zero_variables </A> , <A HREF = "#soiln2_read_constants"> soiln2_read_constants </A> , <A HREF = "#soiln2_min_residues"> soiln2_min_residues </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "fom_min"> fom_min </A></TD><TD> minimum allowable FOM (kg/ha)</TD><TD> 0.5        ()</TD><TD><A HREF = "#soiln2_zero_variables"> soiln2_zero_variables </A> , <A HREF = "#soiln2_read_constants"> soiln2_read_constants </A> , <A HREF = "#soiln2_min_fom"> soiln2_min_fom </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "fr_biom_biom"> fr_biom_biom </A></TD><TD> fraction of retained biomass C returned to biomass (0-1)</TD><TD> 0.6   ()</TD><TD><A HREF = "#soiln2_zero_variables"> soiln2_zero_variables </A> , <A HREF = "#soiln2_read_constants"> soiln2_read_constants </A> , <A HREF = "#soiln2_min_biomass"> soiln2_min_biomass </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "fr_fom_biom"> fr_fom_biom </A></TD><TD> fraction of retained FOM C transferred to biomass (0-1)</TD><TD> 0.9    ()</TD><TD><A HREF = "#soiln2_zero_variables"> soiln2_zero_variables </A> , <A HREF = "#soiln2_read_constants"> soiln2_read_constants </A> , <A HREF = "#soiln2_min_fom"> soiln2_min_fom </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "fr_res_biom"> fr_res_biom </A></TD><TD> fraction of retained residue C transferred to biomass (0-1)</TD><TD> 0.9    ()</TD><TD><A HREF = "#soiln2_zero_variables"> soiln2_zero_variables </A> , <A HREF = "#soiln2_read_constants"> soiln2_read_constants </A> , <A HREF = "#soiln2_min_residues"> soiln2_min_residues </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "fom_type"> fom_type </A></TD><TD></TD><TD> default manure ()</TD><TD></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "fr_carb"> fr_carb </A></TD><TD> carbohydrate fraction of FOM (0-1)</TD><TD> 0.2      0.0      ()</TD><TD></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "fr_cell"> fr_cell </A></TD><TD> cellulose fraction of FOM (0-1)</TD><TD> 0.7      0.01     ()</TD><TD></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "fr_lign"> fr_lign </A></TD><TD> lignin fraction of FOM (0-1)</TD><TD> 0.1      0.99     ()</TD><TD></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "mcn"> mcn </A></TD><TD> C:N ratio of microbes ()</TD><TD> 8.0            ()</TD><TD><A HREF = "#soiln2_zero_variables"> soiln2_zero_variables </A> , <A HREF = "#soiln2_read_constants"> soiln2_read_constants </A> , <A HREF = "#soiln2_init_calc"> soiln2_init_calc </A> , <A HREF = "#soiln2_min_residues"> soiln2_min_residues </A> , <A HREF = "#soiln2_process"> soiln2_process </A> , <A HREF = "#soiln2_min_humic"> soiln2_min_humic </A> , <A HREF = "#soiln2_min_biomass"> soiln2_min_biomass </A> , <A HREF = "#soiln2_min_fom"> soiln2_min_fom </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "opt_temp"> opt_temp </A></TD><TD> Soil temperature above which there is no further effect on mineralisation and nitrification (oC)</TD><TD> 32.0      ()</TD><TD><A HREF = "#soiln2_zero_variables"> soiln2_zero_variables </A> , <A HREF = "#soiln2_read_constants"> soiln2_read_constants </A> , <A HREF = "#soiln2_tf"> soiln2_tf </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "rd_biom"> rd_biom </A></TD><TD> potential rate of soil biomass mineralization (per day)</TD><TD> 0.0081     ()</TD><TD><A HREF = "#soiln2_zero_variables"> soiln2_zero_variables </A> , <A HREF = "#soiln2_read_constants"> soiln2_read_constants </A> , <A HREF = "#soiln2_min_biomass"> soiln2_min_biomass </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "rd_carb"> rd_carb </A></TD><TD> maximum rate constant for decomposition of FPool1 (0-1)</TD><TD> 0.2        ()</TD><TD></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "rd_cell"> rd_cell </A></TD><TD> maximum rate constant for decomposition of FPool2 (0-1)</TD><TD> 0.05       ()</TD><TD></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "rd_lign"> rd_lign </A></TD><TD> maximum rate constant for decomposition of FPool3 (0-1)</TD><TD> 0.0095     ()</TD><TD></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "rd_hum"> rd_hum </A></TD><TD> potential rate of humus mineralization (per day)</TD><TD> 0.00015     ()</TD><TD><A HREF = "#soiln2_zero_variables"> soiln2_zero_variables </A> , <A HREF = "#soiln2_read_constants"> soiln2_read_constants </A> , <A HREF = "#soiln2_min_humic"> soiln2_min_humic </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "nh4ppm_min"> nh4ppm_min </A></TD><TD> minimum allowable NH4 (ppm)</TD><TD> 0.0     ()</TD><TD><A HREF = "#soiln2_zero_variables"> soiln2_zero_variables </A> , <A HREF = "#soiln2_set_my_variable"> soiln2_set_my_variable </A> , <A HREF = "#soiln2_read_constants"> soiln2_read_constants </A> , <A HREF = "#soiln2_init_calc"> soiln2_init_calc </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "no3ppm_min"> no3ppm_min </A></TD><TD> minimum allowable NO3 (ppm)</TD><TD> 0.0     ()</TD><TD><A HREF = "#soiln2_zero_variables"> soiln2_zero_variables </A> , <A HREF = "#soiln2_set_my_variable"> soiln2_set_my_variable </A> , <A HREF = "#soiln2_read_constants"> soiln2_read_constants </A> , <A HREF = "#soiln2_init_calc"> soiln2_init_calc </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "min_depth"> min_depth </A></TD><TD> depth of soil from which N can be immobilised by decomposing surface residues (mm) ----------------------------------------------------------------------- Specifying the water factor for Nitrogen Transformations is by referring to water content via an indexing system and linear interpolation between specified coordinates. (see example)  1 |    ------ |   /.     \                In this example .5 |  / .      -               wf_index = 0.0 0.5 1.0 2.0 | /  .        \             wf_values= 0.0 1.0 1.0 0.25 |/   . 0 ----------------------- LL       DUL   SAT =0       =1    =2</TD><TD> 100.     ()</TD><TD><A HREF = "#soiln2_zero_variables"> soiln2_zero_variables </A> , <A HREF = "#soiln2_read_constants"> soiln2_read_constants </A> , <A HREF = "#soiln2_min_residues"> soiln2_min_residues </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "wfmin_index"> wfmin_index </A></TD><TD> index specifying water content for water factor for mineralization</TD><TD> 0.0 0.5 1.0 2.0   ()</TD><TD></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "wfmin_values"> wfmin_values </A></TD><TD> value of water factor function at given index values(mineralization)</TD><TD> 0.0 1.0 1.0 0.5   ()</TD><TD></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "wfnit_index"> wfnit_index </A></TD><TD> index specifying water content for water factor for nitrification</TD><TD> 0.0 .25 1.0 2.0   ()</TD><TD></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "wfnit_values"> wfnit_values </A></TD><TD> value of water factor function at given index values(nitrification) -----------------------------------------------------------------------</TD><TD> 0.0 1.0 1.0 0.0   ()</TD><TD></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "nitrification_pot"> nitrification_pot </A></TD><TD> Soil Nitrification potential (ug NH4/g soil)</TD><TD> 40.0  (ppm)</TD><TD><A HREF = "#soiln2_zero_variables"> soiln2_zero_variables </A> , <A HREF = "#soiln2_read_constants"> soiln2_read_constants </A> , <A HREF = "#soiln2_nitrification"> soiln2_nitrification </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "nh4_at_half_pot"> nh4_at_half_pot </A></TD><TD> NH4 concentration at half potential nitrification (Michaelis-Menton kinetics)</TD><TD> 90  (ppm)</TD><TD><A HREF = "#soiln2_zero_variables"> soiln2_zero_variables </A> , <A HREF = "#soiln2_read_constants"> soiln2_read_constants </A> , <A HREF = "#soiln2_nitrification"> soiln2_nitrification </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "phf_nit_ph"> phf_nit_ph </A></TD><TD> pH for specifying factor for nitrification</TD><TD> 4.5 6.0 8.0 9.0  ()</TD><TD><A HREF = "#soiln2_zero_variables"> soiln2_zero_variables </A> , <A HREF = "#soiln2_read_constants"> soiln2_read_constants </A> , <A HREF = "#soiln2_phf_nitrf"> soiln2_phf_nitrf </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "phf_nit_values"> phf_nit_values </A></TD><TD> value of pH factor for nitrification</TD><TD> 0.0 1.0 1.0 0.0  ()</TD><TD><A HREF = "#soiln2_zero_variables"> soiln2_zero_variables </A> , <A HREF = "#soiln2_read_constants"> soiln2_read_constants </A> , <A HREF = "#soiln2_phf_nitrf"> soiln2_phf_nitrf </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "">  </A></TD><TD></TD><TD> ()</TD><TD></TD></TR>

</TABLE>
<br>
<html>

<body>

<p><!--webbot bot="ImageMap" startspan rectangle=" (513,2) (635, 18)  APSeudo Documentation"
rectangle=" (103,4) (204, 18)  Structure Charts"
rectangle=" (14,3) (76, 18)  #Top" src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640"
height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" --><MAP NAME="FrontPageMap0"><AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top"><AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts"><AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top"></MAP><img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" usemap="#FrontPageMap0"><!--webbot bot="ImageMap"
i-checksum="58234" endspan --></p>
</body>
</html>
<br>
<A NAME = "Contact Information"> <H2>Contact Information</H2> </A>
For Further Information Please Contact:
<p>
<A HREF = "mailto:Merv.Probert@tag.csiro.au"> Merv Probert - Module Developer </A><br>
<A HREF = "mailto:APSIM-help@tag.csiro.au"> APSIM Help Desk </A><br>
<A HREF = "http:\\apsim-help.tag.csiro.au"> APSIM Help WEB Page </A><br>
<html>

<body>

<p><!--webbot bot="ImageMap" startspan rectangle=" (513,2) (635, 18)  APSeudo Documentation"
rectangle=" (103,4) (204, 18)  Structure Charts"
rectangle=" (14,3) (76, 18)  #Top" src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640"
height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" --><MAP NAME="FrontPageMap0"><AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top"><AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts"><AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top"></MAP><img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" usemap="#FrontPageMap0"><!--webbot bot="ImageMap"
i-checksum="58234" endspan --></p>
</body>
</html>
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage Express 2.0">
<title></title>
</head>

<body>

<p><img src="..\..\..\docs\shared\apsimdocumentationbanner.jpg" width="640"
height="73"></p>
</body>
</html>
Date: 26/11/98  APseudo Version:  1. 0 Rev.  0<br>
<html>

<body>

<p><!--webbot bot="ImageMap" startspan rectangle=" (513,2) (635, 18)  APSeudo Documentation"
rectangle=" (103,4) (204, 18)  Structure Charts"
rectangle=" (14,3) (76, 18)  #Top" src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640"
height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" --><MAP NAME="FrontPageMap0"><AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top"><AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts"><AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top"></MAP><img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" alt="..\..\..\docs\shared\apseudopagebreak.jpg (5835 bytes)" border="0" usemap="#FrontPageMap0"><!--webbot bot="ImageMap"
i-checksum="58234" endspan --></p>
</body>
</html>
