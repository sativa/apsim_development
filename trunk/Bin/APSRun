#! /usr/bin/tclsh

#APSRun - run apsim
# Converts .con files to .sim files and runs them

set APSROOT [file dirname [file dirname [info script]]]
set env(LD_LIBRARY_PATH) $APSROOT/lib

foreach arg $argv {
   cd [file dirname $arg]
   puts [exec $APSROOT/bin/ConToSim.x $arg]
   set t0 [clock seconds]
   foreach simfile [glob *.sim] {
     if {[file mtime $simfile] >= $t0} {
       puts [exec $APSROOT/bin/apsim.x $simfile]
     }
   }    
}


