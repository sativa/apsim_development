<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage Express 2.0">
<title></title>
</head>

<body>

<p><img src="..\..\..\docs\shared\apsimdocumentationbanner.jpg" width="640"
height="73"></p>
</body>
</html>
<TITLE>The Crop Routine Library</TITLE>
<FONT SIZE = 7><B><CENTER>The Crop Routine Library</CENTER></B></FONT>
<H1>TABLE OF CONTENTS</H1>
<H2><A HREF = "#Contact Information"> Contact Information </A></H2>
<H2><A HREF = "#Module Description"> Module Description </A></H2>
<H2>Module Logic</H2>
<ul><li><A HREF = "#The Crop Model Algorithm Library"> The Crop Model Algorithm Library </A>

<li><A HREF = "#Structure Charts"> Structure Charts </A>

</ul>
<hr>
<A NAME = "Module Description">  </A>
<H2>Module Documentation</H2>
<br>
<A HREF = "croptemp_int.pdf"> croptemp_int.pdf </A>
<br>
<A HREF = ".">  </A>
<br>
<br>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "Structure Charts"> <H2>Module Structure Charts</H2> </A>
<H2>The Crop Model Algorithm Library</H2>
<ul><li><A HREF = "#crop_dm_pot_rue"> crop_dm_pot_rue </A>

<li><A HREF = "#crop_dm_senescence0"> crop_dm_senescence0 </A>

<li><A HREF = "#crop_dm_dead_detachment"> crop_dm_dead_detachment </A>

<li><A HREF = "#cproc_dm_senescence1"> cproc_dm_senescence1 </A>

<li><A HREF = "#cproc_dm_retranslocate1"> cproc_dm_retranslocate1 </A>

<li><A HREF = "#cproc_dm_detachment1"> cproc_dm_detachment1 </A>

<ul><li><A HREF = "#crop_pool_fraction_delta"> crop_pool_fraction_delta </A>

</ul><li><A HREF = "#cproc_bio_yieldpart_demand1"> cproc_bio_yieldpart_demand1 </A>

<li><A HREF = "#cproc_yieldpart_demand_stress1"> cproc_yieldpart_demand_stress1 </A>

<li><A HREF = "#cproc_bio_init1"> cproc_bio_init1 </A>

<li><A HREF = "#crop_lai_equilib_water"> crop_lai_equilib_water </A>

<ul><li><A HREF = "#crop_store_value"> crop_store_value </A>

</ul><li><A HREF = "#crop_lai_equilib_light"> crop_lai_equilib_light </A>

<ul><li><A HREF = "#crop_store_value"> crop_store_value </A>

</ul><li><A HREF = "#crop_leaf_area_sen_water2"> crop_leaf_area_sen_water2 </A>

<li><A HREF = "#crop_leaf_area_sen_light2"> crop_leaf_area_sen_light2 </A>

<li><A HREF = "#cproc_leaf_area_sen1"> cproc_leaf_area_sen1 </A>

<ul><li><A HREF = "#crop_leaf_area_sen_age1"> crop_leaf_area_sen_age1 </A>

<li><A HREF = "#crop_leaf_area_sen_light1"> crop_leaf_area_sen_light1 </A>

<li><A HREF = "#crop_leaf_area_sen_water1"> crop_leaf_area_sen_water1 </A>

<li><A HREF = "#crop_leaf_area_sen_frost1"> crop_leaf_area_sen_frost1 </A>

</ul><li><A HREF = "#cproc_leaf_area_init1"> cproc_leaf_area_init1 </A>

<li><A HREF = "#cproc_lai_detachment1"> cproc_lai_detachment1 </A>

<ul><li><A HREF = "#crop_part_fraction_delta"> crop_part_fraction_delta </A>

</ul><li><A HREF = "#cproc_canopy_height"> cproc_canopy_height </A>

<li><A HREF = "#cproc_leaf_no_init1"> cproc_leaf_no_init1 </A>

<li><A HREF = "#cproc_leaf_no_pot1"> cproc_leaf_no_pot1 </A>

<li><A HREF = "#cproc_leaf_area_pot1"> cproc_leaf_area_pot1 </A>

<li><A HREF = "#cproc_leaf_area_stressed1"> cproc_leaf_area_stressed1 </A>

<li><A HREF = "#cproc_leaf_area_actual1"> cproc_leaf_area_actual1 </A>

<li><A HREF = "#cproc_leaf_no_actual1"> cproc_leaf_no_actual1 </A>

<li><A HREF = "#cproc_leaf_no_pot2"> cproc_leaf_no_pot2 </A>

<li><A HREF = "#cproc_leaf_area_pot_tpla"> cproc_leaf_area_pot_tpla </A>

<li><A HREF = "#crop_root_incorp"> crop_root_incorp </A>

<ul><li><A HREF = "#crop_root_dist"> crop_root_dist </A>

</ul><li><A HREF = "#crop_top_residue"> crop_top_residue </A>

<li><A HREF = "#crop_my_type"> crop_my_type </A>

<li><A HREF = "#crop_get_ext_uptakes"> crop_get_ext_uptakes </A>

<li><A HREF = "#crop_failure_germination"> crop_failure_germination </A>

<li><A HREF = "#crop_failure_emergence"> crop_failure_emergence </A>

<li><A HREF = "#crop_nfact_photo"> crop_nfact_photo </A>

<ul><li><A HREF = "#crop_n_conc_ratio"> crop_n_conc_ratio </A>

</ul><li><A HREF = "#crop_nfact_pheno"> crop_nfact_pheno </A>

<ul><li><A HREF = "#crop_n_conc_ratio"> crop_n_conc_ratio </A>

</ul><li><A HREF = "#crop_nfact_grain_conc"> crop_nfact_grain_conc </A>

<ul><li><A HREF = "#crop_n_conc_ratio"> crop_n_conc_ratio </A>

</ul><li><A HREF = "#crop_nfact_expansion"> crop_nfact_expansion </A>

<li><A HREF = "#crop_n_detachment"> crop_n_detachment </A>

<li><A HREF = "#crop_n_dead_detachment"> crop_n_dead_detachment </A>

<li><A HREF = "#crop_n_dlt_grain_conc"> crop_n_dlt_grain_conc </A>

<li><A HREF = "#crop_n_retrans_avail"> crop_n_retrans_avail </A>

<li><A HREF = "#cproc_n_senescence1"> cproc_n_senescence1 </A>

<li><A HREF = "#cproc_n_uptake1"> cproc_n_uptake1 </A>

<li><A HREF = "#cproc_n_supply1"> cproc_n_supply1 </A>

<ul><li><A HREF = "#crop_n_mass_flow1"> crop_n_mass_flow1 </A>

<li><A HREF = "#crop_n_diffusion1"> crop_n_diffusion1 </A>

<li><A HREF = "#crop_n_fixation_pot1"> crop_n_fixation_pot1 </A>

</ul><li><A HREF = "#cproc_n_demand1"> cproc_n_demand1 </A>

<li><A HREF = "#cproc_n_init1"> cproc_n_init1 </A>

<li><A HREF = "#cproc_n_detachment1"> cproc_n_detachment1 </A>

<ul><li><A HREF = "#crop_pool_fraction_delta"> crop_pool_fraction_delta </A>

</ul><li><A HREF = "#cproc_n_supply2"> cproc_n_supply2 </A>

<ul><li><A HREF = "#crop_n_mass_flow1"> crop_n_mass_flow1 </A>

<li><A HREF = "#crop_n_diffusion1"> crop_n_diffusion1 </A>

<li><A HREF = "#crop_n_fixation_pot1"> crop_n_fixation_pot1 </A>

</ul><li><A HREF = "#cproc_n_demand2"> cproc_n_demand2 </A>

<li><A HREF = "#cproc_n_uptake2"> cproc_n_uptake2 </A>

<li><A HREF = "#crop_stage_code"> crop_stage_code </A>

<li><A HREF = "#cproc_phenology1"> cproc_phenology1 </A>

<ul><li><A HREF = "#crop_thermal_time"> crop_thermal_time </A>

<li><A HREF = "#crop_phase_devel"> crop_phase_devel </A>

<ul><li><A HREF = "#crop_germination"> crop_germination </A>

<li><A HREF = "#crop_phase_tt"> crop_phase_tt </A>

<li><A HREF = "#crop_germ_dlt_tt"> crop_germ_dlt_tt </A>

</ul><li><A HREF = "#crop_devel"> crop_devel </A>

</ul><li><A HREF = "#crop_root_length_init"> crop_root_length_init </A>

<li><A HREF = "#cproc_root_length_senescence1"> cproc_root_length_senescence1 </A>

<ul><li><A HREF = "#crop_root_dist"> crop_root_dist </A>

</ul><li><A HREF = "#cproc_root_depth1"> cproc_root_depth1 </A>

<ul><li><A HREF = "#crop_sw_avail_fac"> crop_sw_avail_fac </A>

<li><A HREF = "#crop_root_depth_increase"> crop_root_depth_increase </A>

</ul><li><A HREF = "#cproc_root_depth_init1"> cproc_root_depth_init1 </A>

<li><A HREF = "#cproc_root_length_init1"> cproc_root_length_init1 </A>

<li><A HREF = "#cproc_root_length_growth1"> cproc_root_length_growth1 </A>

<ul><li><A HREF = "#crop_sw_avail_fac"> crop_sw_avail_fac </A>

</ul><li><A HREF = "#crop_root_redistribute"> crop_root_redistribute </A>

<li><A HREF = "#cproc_root_depth2"> cproc_root_depth2 </A>

<ul><li><A HREF = "#crop_root_sw_avail_factor"> crop_root_sw_avail_factor </A>

<li><A HREF = "#crop_root_depth_increase2"> crop_root_depth_increase2 </A>

</ul><li><A HREF = "#crop_temperature_stress_photo"> crop_temperature_stress_photo </A>

<li><A HREF = "#crop_radn_int0"> crop_radn_int0 </A>

<li><A HREF = "#crop_radn_int1"> crop_radn_int1 </A>

<li><A HREF = "#crop_running_ave"> crop_running_ave </A>

<li><A HREF = "#crop_sw_uptake0"> crop_sw_uptake0 </A>

<li><A HREF = "#crop_swdef_expansion"> crop_swdef_expansion </A>

<li><A HREF = "#crop_swdef_photo"> crop_swdef_photo </A>

<li><A HREF = "#crop_swdef_pheno"> crop_swdef_pheno </A>

<li><A HREF = "#crop_swdef_fixation"> crop_swdef_fixation </A>

<li><A HREF = "#crop_oxdef_photo1"> crop_oxdef_photo1 </A>

<ul><li><A HREF = "#crop_root_dist"> crop_root_dist </A>

</ul><li><A HREF = "#cproc_sw_supply1"> cproc_sw_supply1 </A>

<ul><li><A HREF = "#crop_check_sw"> crop_check_sw </A>

<li><A HREF = "#crop_sw_avail_pot"> crop_sw_avail_pot </A>

<li><A HREF = "#crop_sw_avail"> crop_sw_avail </A>

<li><A HREF = "#crop_sw_supply"> crop_sw_supply </A>

</ul><li><A HREF = "#cproc_sw_uptake1"> cproc_sw_uptake1 </A>

<li><A HREF = "#cproc_sw_demand1"> cproc_sw_demand1 </A>

<li><A HREF = "#cproc_transp_eff1"> cproc_transp_eff1 </A>

<li><A HREF = "#cproc_bio_water1"> cproc_bio_water1 </A>

</ul>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<CENTER><A NAME = "Module Pseudo Code"> <H2><BIG>Module Pseudo Code</BIG></H2> </A></CENTER>
<hr>
<H2><BIG><A NAME = "The Crop Model Algorithm Library"> The Crop Model Algorithm Library </A></BIG></H2>
<A NAME = "crop_dm_pot_rue">  </A>
<H2>Crop Dm Pot Rue</H2>
<br>
<H3><CENTER>Potential biomass (carbohydrate) production from photosynthesis (g/m^2) limited by temperature and nitrogen stresses  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

current_phase = int (current_stage)<br>

usrue = rue<I><SUB> current_phase</SUB></I> * minimum of (temp_stress_photo, nfact_photo)<br>

dlt_dm_pot = usrue * radn_int<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_dm_senescence0">  </A>
<H2>Crop Dm Senescence0</H2>
<br>
<H3><CENTER>Derives seneseced plant dry matter (g/m^2) for the day  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

Fill dlt_dm_senesced with 0 . 0<br>

Fill dlt_dm_sen_retrans with 0 . 0<br>

lai_today = lai + dlt_lai<br>

if (dlt_slai.&lt;.lai_today) then<br>

<blockquote>dm_green_leaf_today = dm_green<I><SUB> leaf</SUB></I> + dlt_dm_green<I><SUB> leaf</SUB></I> + dlt_dm_green_retrans<I><SUB> leaf</SUB></I><br>

sla_today = divide (lai_today, dm_green_leaf_today, 0 . 0)<br>

dlt_dm_senescing = divide (dlt_slai, sla_today, 0 . 0)<br>

</blockquote>else<br>

<blockquote>dlt_dm_senescing = dm_green<I><SUB> leaf</SUB></I> + dlt_dm_green<I><SUB> leaf</SUB></I><br>

</blockquote>endif<br>

dlt_dm_senesced<I><SUB> leaf</SUB></I> = dlt_dm_senescing<br>

dlt_dm_senesced<I><SUB> stem</SUB></I> = 0 . 0<br>

dlt_dm_senesced<I><SUB> root</SUB></I> = dm_green<I><SUB> root</SUB></I> * dm_root_sen_frac<br>

dlt_dm_sen_retrans<I><SUB> leaf</SUB></I> = dlt_dm_senescing * (1.0-dm_leaf_sen_frac)<br>

dlt_dm_green_retrans<I><SUB> stem</SUB></I> = dlt_dm_green_retrans<I><SUB> stem</SUB></I> + dlt_dm_sen_retrans<I><SUB> leaf</SUB></I><br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_dm_dead_detachment">  </A>
<H2>Crop Dm Dead Detachment</H2>
<br>
<H3><CENTER>Plant dry matter loss from dead plants  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

For each part from 1 to num_part<br>

<blockquote>dlt_dm_dead_detached<I><SUB> part</SUB></I> = dm_dead<I><SUB> part</SUB></I> * dead_detach_frac<I><SUB> part</SUB></I><br>

</blockquote>next<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "cproc_dm_senescence1">  </A>
<H2>Cproc Dm Senescence1</H2>
<br>
<H3><CENTER>Derives seneseced plant dry matter (g/m^2) for the day  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

For each part from 1 to num_part<br>

<blockquote>fraction_senescing = linear_interp_real (independant_variable, <A HREF = "#x_dm_sen_frac"> c_x_dm_sen_frac </A><I><SUB> 1, part</SUB></I>, <A HREF = "#y_dm_sen_frac"> c_y_dm_sen_frac </A><I><SUB> 1, part</SUB></I>, <A HREF = "#num_dm_sen_frac"> c_num_dm_sen_frac </A><I><SUB> part</SUB></I>)<br>

fraction_senescing = bound (fraction_senescing, 0 . 0, 1 . 0)<br>

dlt_dm_senesced<I><SUB> part</SUB></I> = (g_dm_green<I><SUB> part</SUB></I>+g_dlt_dm_green<I><SUB> part</SUB></I>+g_dlt_dm_green_retrans<I><SUB> part</SUB></I>) * fraction_senescing<br>

</blockquote>next<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "cproc_dm_retranslocate1">  </A>
<H2>Cproc Dm Retranslocate1</H2>
<br>
<H3><CENTER>Calculate plant dry matter delta's due to retranslocation to grain (g/m^2)  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

Fill dm_retranslocate with 0 . 0<br>

if (stage_is_between (start_grnfil, end_grnfil, g_current_stage)) then<br>

<blockquote>if (g_dlt_dm_grain_demand.&gt;.g_dlt_dm_green<I><SUB> grain_part_no</SUB></I>) then<br>

<blockquote>dm_grain_differential = g_dlt_dm_grain_demand - g_dlt_dm_green<I><SUB> grain_part_no</SUB></I><br>

For each counter from 1 to num_supply_pools<br>

<blockquote>dm_part_pot = g_dm_green<I><SUB> supply_pools<I><SUB> counter</SUB></I></SUB></I> + g_dlt_dm_green<I><SUB> supply_pools<I><SUB> counter</SUB></I></SUB></I><br>

dm_part_avail = dm_part_pot - g_dm_plant_min<I><SUB> supply_pools<I><SUB> counter</SUB></I></SUB></I> * g_plants<br>

dm_part_avail = l_bound (dm_part_avail, 0 . 0)<br>

dlt_dm_retrans_part = minimum of (dm_grain_differential, dm_part_avail)<br>

dm_grain_differential = dm_grain_differential - dlt_dm_retrans_part<br>

dm_retranslocate<I><SUB> supply_pools<I><SUB> counter</SUB></I></SUB></I> = - dlt_dm_retrans_part<br>

</blockquote>next<br>

dm_retranslocate<I><SUB> grain_part_no</SUB></I> = - sum_real_array (dm_retranslocate, max_part)<br>

</blockquote>else<br>

<blockquote>Fill dm_retranslocate with 0 . 0<br>

</blockquote>endif<br>

</blockquote>else<br>

<blockquote>Fill dm_retranslocate with 0 . 0<br>

</blockquote>endif<br>

mass_balance = sum_real_array (dm_retranslocate, max_part)<br>

Check that mass_balance lies between 0 . 0 and 0 . 0<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "cproc_dm_detachment1">  </A>
<H2>Cproc Dm Detachment1</H2>
<br>
<H3><CENTER>Simulate plant detachment.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

<A HREF = "#crop_pool_fraction_delta"> Calculate change in g_dm_senesced based on fractional decay rates. </A><br>

<A HREF = "#crop_pool_fraction_delta"> Calculate change in g_dm_dead based on fractional decay rates. </A><br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_pool_fraction_delta">  </A>
<H2>Crop Pool Fraction Delta</H2>
<br>
<H3><CENTER>Multiply plant pool array by a part fraction array.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

For each part from 1 to num_part<br>

<blockquote>dlt_pool<I><SUB> part</SUB></I> = pool<I><SUB> part</SUB></I> * fraction<I><SUB> part</SUB></I><br>

</blockquote>next<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "cproc_bio_yieldpart_demand1">  </A>
<H2>Cproc Bio Yieldpart Demand1</H2>
<br>
<H3><CENTER>Find grain demand for carbohydrate using daily increase in harvest index (g/m^2)  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

if (stage_is_between (start_grainfill_stage, end_grainfill_stage, g_current_stage)) then<br>

<blockquote>stress_sum = sum_between (start_stress_stage, start_grainfill_stage, g_dm_stress_max)<br>

days_sum = sum_between (start_stress_stage, start_grainfill_stage, g_days_tot)<br>

ave_stress = divide (stress_sum, days_sum, 1 . 0)<br>

hi_max_pot = linear_interp_real (ave_stress, <A HREF = "#x_hi_max_pot_stress"> p_x_hi_max_pot_stress </A>, <A HREF = "#y_hi_max_pot"> p_y_hi_max_pot </A>, <A HREF = "#num_hi_max_pot"> p_num_hi_max_pot </A>)<br>

dm_tops = sum_real_array (g_dm_green, max_part) - g_dm_green<I><SUB> root_part</SUB></I> + sum_real_array (g_dm_senesced, max_part) - g_dm_senesced<I><SUB> root_part</SUB></I><br>

harvest_index = divide (g_dm_green<I><SUB> yield_part</SUB></I>, dm_tops, 0 . 0)<br>

dm_tops_new = dm_tops + g_dlt_dm<br>

harvest_index_new = u_bound (harvest_index + <A HREF = "#hi_incr"> p_hi_incr </A>, hi_max_pot)<br>

dm_grain_new = dm_tops_new * harvest_index_new<br>

dlt_dm_yield = dm_grain_new - g_dm_green<I><SUB> yield_part</SUB></I><br>

dlt_dm_yield = bound (dlt_dm_yield, 0 . 0, dm_grain_new)<br>

</blockquote>else<br>

<blockquote>dlt_dm_yield = 0 . 0<br>

</blockquote>endif<br>

dlt_dm_yieldpart_demand = dlt_dm_yield<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "cproc_yieldpart_demand_stress1">  </A>
<H2>Cproc Yieldpart Demand Stress1</H2>
<br>
<H3><CENTER>Find maximum stress on daily dm production (0-1)  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

rue_reduction = minimum of (g_temp_stress_photo, g_nfact_photo)<br>

dlt_dm_stress_max = g_swdef_photo * rue_reduction<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "cproc_bio_init1">  </A>
<H2>Cproc Bio Init1</H2>
<br>
<H3><CENTER>Initialise plant weights at a specified growth stage at required instances.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

if (on_day_of (init_stage, g_current_stage, g_days_tot)) then<br>

<blockquote>For each part from 1 to max_part<br>

<blockquote>g_dm_green<I><SUB> part</SUB></I> = <A HREF = "#dm_init"> c_dm_init </A><I><SUB> part</SUB></I> * g_plants<br>

</blockquote>next<br>

</blockquote>else<br>

endif<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_lai_equilib_water">  </A>
<H2>Crop Lai Equilib Water</H2>
<br>
<H3><CENTER>Return the lai threshold for water induced senescence.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

stage_no = int (current_stage)<br>

deepest_layer = find_layer_no (root_depth, dlayer, num_layer)<br>

sw_supply_sum = sum_real_array (sw_supply, deepest_layer)<br>

dlt_dm_transp = sw_supply_sum * transp_eff<br>

rue_reduction = minimum of (temp_stress_photo, nfact_photo)<br>

lrue = rue<I><SUB> stage_no</SUB></I> * rue_reduction<br>

Check that lrue lies between 0 . 0 and rue<I><SUB> stage_no</SUB></I><br>

radn_canopy = divide (radn_int, cover_green, radn)<br>

sen_radn_crit = divide (dlt_dm_transp, lrue, radn_canopy)<br>

intc_crit = divide (sen_radn_crit, radn_canopy, 1 . 0)<br>

if (intc_crit.&lt;.1.0) then<br>

<blockquote>lai_equilib_water_today = - <I>log</I><SUB>e</SUB>(1 . 0 - intc_crit) / extinction_coef<br>

</blockquote>else<br>

<blockquote>lai_equilib_water_today = lai<br>

</blockquote>endif<br>

<A HREF = "#crop_store_value"> Store lai_equilib_water_today in a historical record </A><br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_store_value">  </A>
<H2>Crop Store Value</H2>
<br>
<H3><CENTER>Stores a value in an annual circular array  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

array<I><SUB> day_of_year</SUB></I> = value<br>

if (day_of_year.=.365.and.leap_year (year - 1)) then<br>

<blockquote>array<I><SUB> 366</SUB></I> = 0 . 0<br>

</blockquote>else<br>

endif<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_lai_equilib_light">  </A>
<H2>Crop Lai Equilib Light</H2>
<br>
<H3><CENTER>Return the lai threshold for light induced senescence.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

radn_canopy = divide (radn_int, cover_green, 0 . 0)<br>

trans_crit = divide (sen_radn_crit, radn_canopy, 0 . 0)<br>

if (trans_crit.&gt;.0.0) then<br>

<blockquote>lai_eqlb_light_today = - <I>log</I><SUB>e</SUB>(trans_crit) / extinction_coef<br>

</blockquote>else<br>

<blockquote>lai_eqlb_light_today = lai<br>

</blockquote>endif<br>

<A HREF = "#crop_store_value"> Store lai_eqlb_light_today in a historical record </A><br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_leaf_area_sen_water2">  </A>
<H2>Crop Leaf Area Sen Water2</H2>
<br>
<H3><CENTER>Return the lai that would senesce on the current day from water stress  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

deepest_layer = find_layer_no (root_depth, dlayer, num_layer)<br>

sw_supply_sum = sum_real_array (sw_supply, deepest_layer)<br>

sw_demand_ratio = divide (sw_supply_sum, sw_demand, 1 . 0)<br>

if (sw_demand_ratio.&lt;.sen_threshold) then<br>

<blockquote>ave_lai_equilib_water = crop_running_ave (day_of_year, year, lai_equilib_water, 10)<br>

dlt_slai_water = (lai-ave_lai_equilib_water) / sen_water_time_const<br>

dlt_slai_water = l_bound (dlt_slai_water, 0 . 0)<br>

</blockquote>else<br>

<blockquote>dlt_slai_water = 0 . 0<br>

</blockquote>endif<br>

dlt_slai_water = bound (dlt_slai_water, 0 . 0, lai)<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_leaf_area_sen_light2">  </A>
<H2>Crop Leaf Area Sen Light2</H2>
<br>
<H3><CENTER>Return the lai that would senesce on the current day from low light  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

radn_transmitted = radn - radn_int<br>

if (radn_transmitted.&lt;.sen_radn_crit) then<br>

<blockquote>ave_lai_equilib_light = crop_running_ave (day_of_year, year, lai_equilib_light, 10)<br>

dlt_slai_light = divide (lai - ave_lai_equilib_light, sen_light_time_const, 0 . 0)<br>

dlt_slai_light = l_bound (dlt_slai_light, 0 . 0)<br>

</blockquote>else<br>

<blockquote>dlt_slai_light = 0 . 0<br>

</blockquote>endif<br>

dlt_slai_light = bound (dlt_slai_light, 0 . 0, lai)<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "cproc_leaf_area_sen1">  </A>
<H2>Cproc Leaf Area Sen1</H2>
<br>
<H3><CENTER>Return the lai that would senesce on the current day, being the maximum of lai senescence due to ageing, shading, water stress or frost.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

<A HREF = "#crop_leaf_area_sen_age1"> Calculate today's leaf area senescence due to ageing. </A><br>

<A HREF = "#crop_leaf_area_sen_light1"> Calculate today's leaf area senescence due to shading. </A><br>

<A HREF = "#crop_leaf_area_sen_water1"> Calculate today's leaf area senescence due to water stress. </A><br>

<A HREF = "#crop_leaf_area_sen_frost1"> Calculate today's leaf area senescence due to frost </A><br>

g_dlt_slai = maximum of (g_dlt_slai_age, g_dlt_slai_light, g_dlt_slai_water, g_dlt_slai_frost)<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_leaf_area_sen_age1">  </A>
<H2>Crop Leaf Area Sen Age1</H2>
<br>
<H3><CENTER>Return the lai that would senesce on the current day due to ageing  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

leaf_no_dead = sum_between (emergence, this_stage, g_leaf_no_dead) + g_dlt_leaf_no_dead<br>

dying_leaf = int (1 . 0 + leaf_no_dead)<br>

area_sen_dying_leaf = mod (leaf_no_dead, 1 . 0) * g_leaf_area<I><SUB> dying_leaf</SUB></I><br>

slai_age = (sum_real_array (g_leaf_area, dying_leaf - 1)+area_sen_dying_leaf) * smm2sm * g_plants<br>

min_lai = <A HREF = "#min_tpla"> c_min_tpla </A> * g_plants * smm2sm<br>

max_sen = l_bound (g_lai - min_lai, 0 . 0)<br>

dlt_slai_age = bound (slai_age - g_slai, 0 . 0, max_sen)<br>

if (g_dlt_leaf_no . &gt; . 0 .) slai_age = g_dlt_lai_stressed / g_plants * 10000 . / g_dlt_leaf_no<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_leaf_area_sen_light1">  </A>
<H2>Crop Leaf Area Sen Light1</H2>
<br>
<H3><CENTER>Return the lai that would senesce on the current day due to shading  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

if (lai.&gt;.lai_sen_light) then<br>

<blockquote>slai_light_fac = sen_light_slope * (lai-lai_sen_light)<br>

</blockquote>else<br>

<blockquote>slai_light_fac = 0 . 0<br>

</blockquote>endif<br>

dlt_slai_light = lai * slai_light_fac<br>

min_lai = min_tpla * plants * smm2sm<br>

max_sen = l_bound (lai - min_lai, 0 . 0)<br>

dlt_slai_light = bound (dlt_slai_light, 0 . 0, max_sen)<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_leaf_area_sen_water1">  </A>
<H2>Crop Leaf Area Sen Water1</H2>
<br>
<H3><CENTER>Return the lai that would senesce on the current day due to water stress  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

slai_water_fac = sen_rate_water * (1.0-swdef_photo)<br>

dlt_slai_water = lai * slai_water_fac<br>

min_lai = min_tpla * plants * smm2sm<br>

max_sen = l_bound (lai - min_lai, 0 . 0)<br>

dlt_slai_water = bound (dlt_slai_water, 0 . 0, max_sen)<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_leaf_area_sen_frost1">  </A>
<H2>Crop Leaf Area Sen Frost1</H2>
<br>
<H3><CENTER>Return the lai that would senesce on the current day from low temperatures  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

sen_fac_temp = linear_interp_real (mint, frost_temp, frost_fraction, num_frost_temp)<br>

dlt_slai_low_temp = sen_fac_temp * lai<br>

min_lai = min_tpla * plants * smm2sm<br>

max_sen = l_bound (lai - min_lai, 0 . 0)<br>

dlt_slai_frost = bound (dlt_slai_low_temp, 0 . 0, max_sen)<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "cproc_leaf_area_init1">  </A>
<H2>Cproc Leaf Area Init1</H2>
<br>
<H3><CENTER>Initialise leaf area.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

if (on_day_of (init_stage, g_current_stage, g_days_tot)) then<br>

<blockquote>lai = <A HREF = "#initial_tpla"> c_initial_tpla </A> * smm2sm * g_plants<br>

</blockquote>else<br>

endif<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "cproc_lai_detachment1">  </A>
<H2>Cproc Lai Detachment1</H2>
<br>
<H3><CENTER>Simulate plant detachment.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

<A HREF = "#crop_part_fraction_delta"> Calculate change in g_slai for leaf based on fractional decay rates. </A><br>

<A HREF = "#crop_part_fraction_delta"> Calculate change in g_tlai_dead for leaf based on fractional decay rates. </A><br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_part_fraction_delta">  </A>
<H2>Crop Part Fraction Delta</H2>
<br>
<H3><CENTER>Calculate change in a particular plant pool  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

dlt_part = part * fraction<I><SUB> part_no</SUB></I><br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "cproc_canopy_height">  </A>
<H2>Cproc Canopy Height</H2>
<br>
<H3><CENTER>Get change in plant canopy height from stem dry matter per plant  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

dm_stem_plant = divide (g_dm_green<I><SUB> stem</SUB></I>, g_plants, 0 . 0)<br>

new_height = linear_interp_real (dm_stem_plant, <A HREF = "#x_stem_wt"> p_x_stem_wt </A>, <A HREF = "#y_height"> p_y_height </A>, <A HREF = "#num_stem_wt"> p_num_stem_wt </A>)<br>

dlt_canopy_height = new_height - g_canopy_height<br>

dlt_canopy_height = l_bound (dlt_canopy_height, 0 . 0)<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "cproc_leaf_no_init1">  </A>
<H2>Cproc Leaf No Init1</H2>
<br>
<H3><CENTER>Return the the initial number of leaves at emergence.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

if (on_day_of (emerg, g_current_stage, g_days_tot)) then<br>

<blockquote>leaf_no<I><SUB> emerg</SUB></I> = <A HREF = "#leaf_no_at_emerg"> c_leaf_no_at_emerg </A><br>

node_no<I><SUB> emerg</SUB></I> = <A HREF = "#leaf_no_at_emerg"> c_leaf_no_at_emerg </A><br>

</blockquote>else<br>

endif<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "cproc_leaf_no_pot1">  </A>
<H2>Cproc Leaf No Pot1</H2>
<br>
<H3><CENTER>Return the fractional increase in emergence of the oldest expanding leaf and nodes.  Nodes can initiate from a user-defined starting stage and leaves from emergence.  The initiation of both leaves and nodes finishes at a user-defined end stage. Note ! this does not take account of the other younger leaves that are currently expanding  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

node_no_now = sum_between (start_node_app, end_node_app, g_node_no)<br>

node_app_rate = linear_interp_real (node_no_now, <A HREF = "#x_node_no_app"> c_x_node_no_app </A>, <A HREF = "#y_node_app_rate"> c_y_node_app_rate </A>, <A HREF = "#num_node_no_app"> c_num_node_no_app </A>)<br>

leaves_per_node = linear_interp_real (node_no_now, <A HREF = "#x_node_no_leaf"> c_x_node_no_leaf </A>, <A HREF = "#y_leaves_per_node"> c_y_leaves_per_node </A>, <A HREF = "#num_node_no_leaf"> c_num_node_no_leaf </A>)<br>

if (stage_is_between (start_node_app, end_node_app, g_current_stage)) then<br>

<blockquote>dlt_node_no_pot = divide (g_dlt_tt, node_app_rate, 0 . 0)<br>

</blockquote>else<br>

<blockquote>dlt_node_no_pot = 0 . 0<br>

</blockquote>endif<br>

if (on_day_of (emerg, g_current_stage, g_days_tot)) then<br>

<blockquote>dlt_leaf_no_pot = 0 . 0<br>

</blockquote>elseif (stage_is_between (emerg, end_node_app, g_current_stage)) then<br>

<blockquote>dlt_leaf_no_pot = dlt_node_no_pot * leaves_per_node<br>

</blockquote>else<br>

<blockquote>dlt_leaf_no_pot = 0 . 0<br>

</blockquote>endif<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "cproc_leaf_area_pot1">  </A>
<H2>Cproc Leaf Area Pot1</H2>
<br>
<H3><CENTER>Return the potential increase in leaf area development (mm^2) calculated on an individual leaf basis, limited by temperature only, with account taken of the area of currently expanding leaves (node_no_correction).  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

node_no_now = sum_between (start_node_app, now, g_node_no) + <A HREF = "#node_no_correction"> c_node_no_correction </A><br>

leaf_size = linear_interp_real (node_no_now, <A HREF = "#x_node_no"> c_x_node_no </A>, <A HREF = "#y_leaf_size"> c_y_leaf_size </A>, <A HREF = "#num_node_no"> c_num_node_no </A>)<br>

dlt_lai_pot = g_dlt_leaf_no_pot * leaf_size * smm2sm * g_plants<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "cproc_leaf_area_stressed1">  </A>
<H2>Cproc Leaf Area Stressed1</H2>
<br>
<H3><CENTER>Calculate the biomass non-limiting leaf area development from the potential daily increase in lai and the stress factors for water and nitrogen.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

g_dlt_lai_stressed = g_dlt_lai_pot * minimum of (g_swdef_expansion, g_nfact_expansion)<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "cproc_leaf_area_actual1">  </A>
<H2>Cproc Leaf Area Actual1</H2>
<br>
<H3><CENTER>Simulate actual crop leaf area development - checks that leaf area development matches DM production via a maximum specific leaf area for the daily increase in *       LAI. SLA_max changes as a function of LAI.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

sla_max = linear_interp_real (g_lai, <A HREF = "#x_lai"> c_x_lai </A>, <A HREF = "#y_sla_max"> c_y_sla_max </A>, <A HREF = "#num_lai"> c_num_lai </A>)<br>

dlt_lai_carbon = dlt_dm_leaf * sla_max * smm2sm<br>

g_dlt_lai = minimum of (g_dlt_lai_stressed, dlt_lai_carbon)<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "cproc_leaf_no_actual1">  </A>
<H2>Cproc Leaf No Actual1</H2>
<br>
<H3><CENTER>Simulate actual leaf number increase as limited by dry matter production.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

lai_ratio = divide (g_dlt_lai, g_dlt_lai_stressed, 0 . 0)<br>

leaf_no_frac = linear_interp_real (lai_ratio, <A HREF = "#x_lai_ratio"> c_x_lai_ratio </A>, <A HREF = "#y_leaf_no_frac"> c_y_leaf_no_frac </A>, <A HREF = "#num_lai_ratio"> c_num_lai_ratio </A>)<br>

g_dlt_leaf_no = g_dlt_leaf_no_pot * leaf_no_frac<br>

if (g_dlt_leaf_no.&lt;.g_dlt_node_no_pot) then<br>

<blockquote>g_dlt_node_no = g_dlt_leaf_no<br>

</blockquote>else<br>

<blockquote>g_dlt_node_no = g_dlt_node_no_pot<br>

</blockquote>endif<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "cproc_leaf_no_pot2">  </A>
<H2>Cproc Leaf No Pot2</H2>
<br>
<H3><CENTER>Return the fractional increase in emergence of the oldest expanding leaf and nodes.  Nodes can initiate from a user-defined starting stage and leaves from emergence.  The initiation of both leaves and nodes finishes at a user-defined end stage. Note ! this does not take account of the other younger leaves that are currently expanding  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

node_no_now = sum_between (start_node_app, end_node_app, g_node_no)<br>

node_app_rate = linear_interp_real (node_no_now, <A HREF = "#x_node_no_app"> c_x_node_no_app </A>, <A HREF = "#y_node_app_rate"> c_y_node_app_rate </A>, <A HREF = "#num_node_no_app"> c_num_node_no_app </A>)<br>

leaves_per_node = linear_interp_real (node_no_now, <A HREF = "#x_node_no_app"> c_x_node_no_app </A>, <A HREF = "#y_leaves_per_node"> c_y_leaves_per_node </A>, <A HREF = "#num_node_no_app"> c_num_node_no_app </A>)<br>

if (stage_is_between (start_node_app, end_node_app, g_current_stage)) then<br>

<blockquote>dlt_node_no_pot = divide (g_dlt_tt, node_app_rate, 0 . 0)<br>

</blockquote>else<br>

<blockquote>dlt_node_no_pot = 0 . 0<br>

</blockquote>endif<br>

if (on_day_of (emerg, g_current_stage, g_days_tot)) then<br>

<blockquote>dlt_leaf_no_pot = 0 . 0<br>

</blockquote>elseif (stage_is_between (emerg, end_node_app, g_current_stage)) then<br>

<blockquote>dlt_leaf_no_pot = dlt_node_no_pot * leaves_per_node<br>

</blockquote>else<br>

<blockquote>dlt_leaf_no_pot = 0 . 0<br>

</blockquote>endif<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "cproc_leaf_area_pot_tpla">  </A>
<H2>Cproc Leaf Area Pot Tpla</H2>
<br>
<H3><CENTER>Return the potential increase in leaf area development (mm^2) calculated on a whole plant basis as determined by thermal time  Used for sorghum  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

if (on_day_of (begin_stage, g_current_stage, g_days_tot)) then<br>

<blockquote>g_lai = <A HREF = "#initial_tpla"> c_initial_tpla </A> * smm2sm * g_plants<br>

</blockquote>endif<br>

if (stage_is_between (begin_stage, end_stage_tpla_plateau, g_current_stage).and.g_phase_tt<I><SUB> end_stage_tpla_plateau</SUB></I>.&gt;.0.0) then<br>

<blockquote>tt_begin_to_end_tpla = sum_between (begin_stage, end_stage_tpla_plateau, g_phase_tt)<br>

tpla_max = (((g_tiller_no_fertile+1.0)**<A HREF = "#tiller_coef"> c_tiller_coef </A>)*g_leaf_no_final**<A HREF = "#main_stem_coef"> p_main_stem_coef </A>) * scm2smm<br>

tt_since_begin = sum_between (begin_stage, now, g_tt_tot)<br>

tpla_inflection = tt_begin_to_end_tpla * <A HREF = "#tpla_inflection_ratio"> c_tpla_inflection_ratio </A><br>

g_tpla_today = divide (tpla_max, (1.0+<I><BIG>e</BIG></I><SUP>- <A HREF = "#tpla_prod_coef"> p_tpla_prod_coef </A> * (tt_since_begin-tpla_inflection)</SUP>), 0 . 0)<br>

if (g_tpla_today.&lt;.g_tpla_yesterday) then<br>

<blockquote>g_tpla_today = g_tpla_yesterday<br>

</blockquote>endif<br>

g_dlt_lai_pot = (g_tpla_today-g_tpla_yesterday) * smm2sm * g_plants<br>

g_tpla_yesterday = g_tpla_today<br>

</blockquote>else<br>

<blockquote>g_dlt_lai_pot = 0 . 0<br>

</blockquote>endif<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_root_incorp">  </A>
<H2>Crop Root Incorp</H2>
<br>
<H3><CENTER>Calculate and provide root matter incorporation information to the APSIM messaging system.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

if (max_layer.&gt;.crop_maximum number of layers) then<br>

<blockquote>Report a fatal error<br>

</blockquote>else<br>

<blockquote>if (dlt_dm_root.&gt;.0.0) then<br>

<blockquote><A HREF = "#crop_root_dist"> Distribute dlt_dm_root * gm2kg / sm2ha over the profile according to root distribution </A><br>

Check that all dlt_dm_incorp lies between 0 . 0 and dlt_dm_root * gm2kg / sm2ha<br>

<A HREF = "#crop_root_dist"> Distribute dlt_n_root * gm2kg / sm2ha over the profile according to root distribution </A><br>

Check that all dlt_n_incorp lies between 0 . 0 and dlt_n_root * gm2kg / sm2ha<br>

deepest_layer = find_layer_no (g_root_depth, g_dlayer, max_layer)<br>

<br>

Supply <A HREF = "#crop_type"> c_crop_type </A> to the messaging system using the name 'dlt_fom_type='<br>

Supply dlt_dm_incorp to the messaging system using the name 'dlt_fom_wt'<br>

Supply dlt_n_incorp to the messaging system using the name 'dlt_fom_n'<br>

ei_broadcastaction<I><SUB> event_interface, action_incorp_fom, blank</SUB></I><br>

<br>

</blockquote>else<br>

endif<br>

</blockquote>endif<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_root_dist">  </A>
<H2>Crop Root Dist</H2>
<br>
<H3><CENTER>Distribute root material over profile based upon root length distribution.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

Fill root_array with 0 . 0<br>

deepest_layer = find_layer_no (g_root_depth, g_dlayer, max_layer)<br>

root_length_sum = sum_real_array (g_root_length, deepest_layer)<br>

For each layer from 1 to deepest_layer<br>

<blockquote>root_array<I><SUB> layer</SUB></I> = root_sum * divide (g_root_length<I><SUB> layer</SUB></I>, root_length_sum, 0 . 0)<br>

</blockquote>next<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_top_residue">  </A>
<H2>Crop Top Residue</H2>
<br>
<H3><CENTER>Add residue to residue pool  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

if (dlt_residue_weight.&gt;.0.0) then<br>

<blockquote><br>

Supply <A HREF = "#crop_type"> c_crop_type </A> to the messaging system using the name 'dlt_residue_type'<br>

Supply dlt_residue_weight * gm2kg / sm2ha to the messaging system using the name 'dlt_residue_wt'<br>

Supply dlt_residue_n * gm2kg / sm2ha to the messaging system using the name 'dlt_residue_n'<br>

ei_broadcastaction<I><SUB> event_interface, action_add_residue, blank</SUB></I><br>

<br>

</blockquote>else<br>

endif<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_my_type">  </A>
<H2>Crop My Type</H2>
<br>
<H3><CENTER>Returns true if 'type' is equal to the crop type or is absent.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

Get crop_type from the message <I>(OPTIONAL)</I><br>

if (crop_type.=.<A HREF = "#crop_type"> c_crop_type </A>.or.numvals.=.0) then<br>

<blockquote>crop_my_type = . true .<br>

</blockquote>else<br>

<blockquote>crop_my_type = . false .<br>

</blockquote>endif<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_get_ext_uptakes">  </A>
<H2>Crop Get Ext Uptakes</H2>
<br>
<H3><CENTER>Ask swim for uptakes of water or solute  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

if ((uptake_source.=.'apsim').and.(crop_type.=/=.' ')) then<br>

<blockquote>uptake_name = 'uptake_' + uptake_type<br>

uptake_name = uptake_name + '_'<br>

uptake_name = uptake_name + crop_type<br>

Get uptake_array from the system (Lower Bound = uptake_lbound, Upper Bound = uptake_ubound)<br>

For each layer from 1 to num_uptakes<br>

<blockquote>uptake_array<I><SUB> layer</SUB></I> = uptake_array<I><SUB> layer</SUB></I> * unit_conversion_factor<br>

</blockquote>next<br>

</blockquote>else<br>

endif<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_failure_germination">  </A>
<H2>Crop Failure Germination</H2>
<br>
<H3><CENTER>Crop failure from lack of germination within a specific maximum number of days.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

if (stage_is_between (sowing, germ, current_stage).and.sum_between (sowing, now, days_tot).&gt;=.days_germ_limit) then<br>

<blockquote>dlt_plants = - plants<br>

write (to string)  ' crop failure because of lack of' , new_line , '         germination within' , days_germ_limit , ' days of sowing'<br>

summary_writeline<I><SUB> string</SUB></I><br>

</blockquote>else<br>

<blockquote>dlt_plants = 0 . 0<br>

</blockquote>endif<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_failure_emergence">  </A>
<H2>Crop Failure Emergence</H2>
<br>
<H3><CENTER>Crop failure from lack of emergence within a specific maximum thermal time sum from germination.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

if (stage_is_between (germ, emerg, current_stage).and.sum_between (germ, now, tt_tot).&gt;.tt_emerg_limit) then<br>

<blockquote>dlt_plants = - plants<br>

write (to string)  ' failed emergence due to deep planting'<br>

summary_writeline<I><SUB> string</SUB></I><br>

</blockquote>else<br>

<blockquote>dlt_plants = 0 . 0<br>

</blockquote>endif<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_nfact_photo">  </A>
<H2>Crop Nfact Photo</H2>
<br>
<H3><CENTER>The concentration of Nitrogen in leaves and stem is used to derive a Nitrogen stress index for photosynthesis.  The stress index for photosynthesis is calculated from today's relative nutritional status between a critical and minimum leaf Nitrogen concentration.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

<A HREF = "#crop_n_conc_ratio"> Calculate N concentration ratio for leaf and stem </A><br>

n_def = n_fact_photo * n_conc_ratio<br>

nfact = bound (n_def, 0 . 0, 1 . 0)<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_n_conc_ratio">  </A>
<H2>Crop N Conc Ratio</H2>
<br>
<H3><CENTER>Calculate the fractional position of leaf and stem nitrogen concentration between the minimum and critical concentrations.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

dm_stover = dm_green<I><SUB> leaf</SUB></I> + dm_green<I><SUB> stem</SUB></I><br>

n_stover = n_green<I><SUB> leaf</SUB></I> + n_green<I><SUB> stem</SUB></I><br>

n_conc_stover = divide (n_stover, dm_stover, 0 . 0)<br>

n_leaf_crit = n_conc_crit<I><SUB> leaf</SUB></I> * dm_green<I><SUB> leaf</SUB></I><br>

n_stem_crit = n_conc_crit<I><SUB> stem</SUB></I> * dm_green<I><SUB> stem</SUB></I><br>

n_stover_crit = n_leaf_crit + n_stem_crit<br>

n_conc_stover_crit = divide (n_stover_crit, dm_stover, 0 . 0)<br>

n_leaf_min = n_conc_min<I><SUB> leaf</SUB></I> * dm_green<I><SUB> leaf</SUB></I><br>

n_stem_min = n_conc_min<I><SUB> stem</SUB></I> * dm_green<I><SUB> stem</SUB></I><br>

n_stover_min = n_leaf_min + n_stem_min<br>

n_conc_stover_min = divide (n_stover_min, dm_stover, 0 . 0)<br>

n_conc_ratio = divide ((n_conc_stover-n_conc_stover_min), (n_conc_stover_crit-n_conc_stover_min), 0 . 0)<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_nfact_pheno">  </A>
<H2>Crop Nfact Pheno</H2>
<br>
<H3><CENTER>The concentration of Nitrogen in leaves and stem is used to derive a Nitrogen stress index for phenological development. The stress index for phenology is calculated from today's relative nutritional status between a critical and minimum leaf Nitrogen concentration.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

<A HREF = "#crop_n_conc_ratio"> Calculate N concentration ratio for leaf and stem </A><br>

n_def = n_fact_pheno * n_conc_ratio<br>

nfact = bound (n_def, 0 . 0, 1 . 0)<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_nfact_grain_conc">  </A>
<H2>Crop Nfact Grain Conc</H2>
<br>
<H3><CENTER>The concentration of Nitrogen in leaves and stem is used to derive a Nitrogen stress index for grain N accumulation. The stress index for grain N accumulation is calculated from today's relative nutritional status between a critical and minimum leaf Nitrogen concentration.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

<A HREF = "#crop_n_conc_ratio"> Calculate N concentration ratio for leaf and stem </A><br>

nfact = bound (n_conc_ratio, 0 . 0, 1 . 0)<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_nfact_expansion">  </A>
<H2>Crop Nfact Expansion</H2>
<br>
<H3><CENTER>The concentration of Nitrogen in leaves is used to derive a Nitrogen stress index for leaf expansion. The stress index for leaf expansion is calculated from today's relative nutitional status between a critical and minimum leaf Nitrogen concentration.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

n_conc_leaf = divide (n_green<I><SUB> leaf</SUB></I>, dm_green<I><SUB> leaf</SUB></I>, 0 . 0)<br>

n_leaf_crit = n_conc_crit<I><SUB> leaf</SUB></I> * dm_green<I><SUB> leaf</SUB></I><br>

n_conc_leaf_crit = divide (n_leaf_crit, dm_green<I><SUB> leaf</SUB></I>, 0 . 0)<br>

n_leaf_min = n_conc_min<I><SUB> leaf</SUB></I> * dm_green<I><SUB> leaf</SUB></I><br>

n_conc_leaf_min = divide (n_leaf_min, dm_green<I><SUB> leaf</SUB></I>, 0 . 0)<br>

n_conc_ratio_leaf = divide ((n_conc_leaf-n_conc_leaf_min), (n_conc_leaf_crit-n_conc_leaf_min), 0 . 0)<br>

n_def = n_fact_expansion * n_conc_ratio_leaf<br>

nfact = bound (n_def, 0 . 0, 1 . 0)<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_n_detachment">  </A>
<H2>Crop N Detachment</H2>
<br>
<H3><CENTER>Calculate today's Nitrogen lost from senesced pools due to detachment  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

Fill dlt_n_detached with 0 . 0<br>

dlt_n_detached<I><SUB> leaf</SUB></I> = dlt_n_senesced<I><SUB> leaf</SUB></I> * dm_leaf_detach_frac<br>

dlt_n_detached<I><SUB> root</SUB></I> = dlt_n_senesced<I><SUB> root</SUB></I><br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_n_dead_detachment">  </A>
<H2>Crop N Dead Detachment</H2>
<br>
<H3><CENTER>Plant Nitrogen loss from dead plants  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

For each part from 1 to num_part<br>

<blockquote>dlt_n_dead_detached<I><SUB> part</SUB></I> = n_dead<I><SUB> part</SUB></I> * dead_detach_frac<I><SUB> part</SUB></I><br>

</blockquote>next<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_n_dlt_grain_conc">  </A>
<H2>Crop N Dlt Grain Conc</H2>
<br>
<H3><CENTER>Calculate the nitrogen concentration required to meet the increase from daily grain growth (0-1) as affected by temperature and water stress.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

ave_temp = (maxt+mint) / 2 . 0<br>

n_grain_temp_fac = temp_fac_min + tfac_slope * ave_temp<br>

n_grain_sw_fac = sw_fac_max - sfac_slope * swdef_expansion<br>

n_conc_pot = n_conc_min<I><SUB> grain</SUB></I> + (n_conc_crit<I><SUB> grain</SUB></I>-n_conc_min<I><SUB> grain</SUB></I>) * nfact_grain_conc<br>

crop_n<FONT FACE = "SYMBOL">D</FONT>grain_conc = n_conc_pot * maximum of (n_grain_temp_fac, n_grain_sw_fac)<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_n_retrans_avail">  </A>
<H2>Crop N Retrans Avail</H2>
<br>
<H3><CENTER>Calculate N available for transfer to grain (g/m^2) from each plant part.  By definition, available grain N is set to 0.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

For each part from 1 to num_part<br>

<blockquote>n_min = g_n_conc_min<I><SUB> part</SUB></I> * g_dm_green<I><SUB> part</SUB></I><br>

n_avail<I><SUB> part</SUB></I> = l_bound (g_n_green<I><SUB> part</SUB></I> - n_min, 0 . 0)<br>

</blockquote>next<br>

n_avail<I><SUB> grain</SUB></I> = 0 . 0<br>

n_avail<I><SUB> root</SUB></I> = 0 . 0<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "cproc_n_senescence1">  </A>
<H2>Cproc N Senescence1</H2>
<br>
<H3><CENTER>Derives seneseced plant nitrogen (g N/m^2)  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

For each part from 1 to num_part<br>

<blockquote>green_n_conc = divide (g_n_green<I><SUB> part</SUB></I>, g_dm_green<I><SUB> part</SUB></I>, 0 . 0)<br>

sen_n_conc = minimum of (<A HREF = "#n_sen_conc"> c_n_sen_conc </A><I><SUB> part</SUB></I>, green_n_conc)<br>

dlt_n_senesced<I><SUB> part</SUB></I> = g_dlt_dm_senesced<I><SUB> part</SUB></I> * sen_n_conc<br>

dlt_n_senesced<I><SUB> part</SUB></I> = u_bound (dlt_n_senesced<I><SUB> part</SUB></I>, g_n_green<I><SUB> part</SUB></I>)<br>

</blockquote>next<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "cproc_n_uptake1">  </A>
<H2>Cproc N Uptake1</H2>
<br>
<H3><CENTER>Return actual plant nitrogen uptake from each soil layer. N uptake is from nitrate only and comes via mass flow and active (diffusion) uptake.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

deepest_layer = find_layer_no (g_root_depth, g_dlayer, max_layer)<br>

For each layer from 1 to deepest_layer<br>

<blockquote>no3gsm_diffn_avail<I><SUB> layer</SUB></I> = g_no3gsm_diffn_pot<I><SUB> layer</SUB></I> - g_no3gsm_mflow_avail<I><SUB> layer</SUB></I><br>

no3gsm_diffn_avail<I><SUB> layer</SUB></I> = l_bound (no3gsm_diffn_avail<I><SUB> layer</SUB></I>, 0 . 0)<br>

</blockquote>next<br>

no3gsm_mflow_supply = sum_real_array (g_no3gsm_mflow_avail, deepest_layer)<br>

no3gsm_diffn_supply = sum_real_array (no3gsm_diffn_avail, deepest_layer)<br>

n_demand = sum_real_array (g_n_demand, max_part)<br>

n_max = sum_real_array (g_n_max, max_part)<br>

if (no3gsm_mflow_supply.&gt;=.n_demand) then<br>

<blockquote>no3gsm_mflow = no3gsm_mflow_supply<br>

no3gsm_mflow = u_bound (no3gsm_mflow, n_max)<br>

no3gsm_diffn = 0 . 0<br>

</blockquote>else<br>

<blockquote>no3gsm_mflow = no3gsm_mflow_supply<br>

if (<A HREF = "#n_supply_preference"> c_n_supply_preference </A>.=.'active') then<br>

<blockquote>no3gsm_diffn = bound (n_demand - no3gsm_mflow, 0 . 0, no3gsm_diffn_supply)<br>

</blockquote>elseif (<A HREF = "#n_supply_preference"> c_n_supply_preference </A>.=.'fixation') then<br>

<blockquote>no3gsm_diffn = bound (n_demand - no3gsm_mflow - g_n_fix_pot, 0 . 0, no3gsm_diffn_supply)<br>

</blockquote>else<br>

<blockquote>Report a fatal error<br>

</blockquote>endif<br>

no3gsm_diffn = divide (no3gsm_diffn, <A HREF = "#no3_diffn_const"> c_no3_diffn_const </A>, 0 . 0)<br>

</blockquote>endif<br>

Fill dlt_no3gsm with 0 . 0<br>

For each layer from 1 to deepest_layer<br>

<blockquote>mflow_fract = divide (g_no3gsm_mflow_avail<I><SUB> layer</SUB></I>, no3gsm_mflow_supply, 0 . 0)<br>

diffn_fract = divide (no3gsm_diffn_avail<I><SUB> layer</SUB></I>, no3gsm_diffn_supply, 0 . 0)<br>

no3gsm_uptake = no3gsm_mflow * mflow_fract + no3gsm_diffn * diffn_fract<br>

dlt_no3gsm<I><SUB> layer</SUB></I> = - no3gsm_uptake<br>

</blockquote>next<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "cproc_n_supply1">  </A>
<H2>Cproc N Supply1</H2>
<br>
<H3><CENTER>Calculate nitrogen supplies from soil and fixation  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

<A HREF = "#crop_n_mass_flow1"> Calculate crop nitrogen supply from mass flow, g_no3gsm_mflow_avail. </A><br>

<A HREF = "#crop_n_diffusion1"> Calculate crop nitrogen supply from active uptake, g_no3gsm_diffn_pot. </A><br>

<A HREF = "#crop_n_fixation_pot1"> Calculate crop nitrogen supply from fixation, g_n_fix_pot. </A><br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_n_mass_flow1">  </A>
<H2>Crop N Mass Flow1</H2>
<br>
<H3><CENTER>Return potential nitrogen uptake (supply) by mass flow (water uptake) (g/m^2)  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

Fill no3gsm_mflow_pot with 0 . 0<br>

deepest_layer = find_layer_no (root_depth, dlayer, num_layer)<br>

For each layer from 1 to deepest_layer<br>

<blockquote>no3_conc = divide (no3gsm<I><SUB> layer</SUB></I>, sw_dep<I><SUB> layer</SUB></I>, 0 . 0)<br>

no3gsm_mflow = no3_conc * (-dlt_sw_dep<I><SUB> layer</SUB></I>)<br>

no3gsm_mflow_pot<I><SUB> layer</SUB></I> = u_bound (no3gsm_mflow, no3gsm<I><SUB> layer</SUB></I> - no3gsm_min<I><SUB> layer</SUB></I>)<br>

</blockquote>next<br>

format (1x, 5f10 . 6)<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_n_diffusion1">  </A>
<H2>Crop N Diffusion1</H2>
<br>
<H3><CENTER>Return potential nitrogen uptake (supply) by diffusion for a plant (g/m^2)  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

Fill no3gsm_diffn_pot with 0 . 0<br>

deepest_layer = find_layer_no (root_depth, dlayer, num_layer)<br>

For each layer from 1 to deepest_layer<br>

<blockquote>sw_avail_fract = divide (sw_avail<I><SUB> layer</SUB></I>, sw_avail_pot<I><SUB> layer</SUB></I>, 0 . 0)<br>

sw_avail_fract = bound (sw_avail_fract, 0 . 0, 1 . 0)<br>

no3gsm_diffn = sw_avail_fract * no3gsm<I><SUB> layer</SUB></I><br>

no3gsm_diffn_pot<I><SUB> layer</SUB></I> = u_bound (no3gsm_diffn, no3gsm<I><SUB> layer</SUB></I> - no3gsm_min<I><SUB> layer</SUB></I>)<br>

</blockquote>next<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_n_fixation_pot1">  </A>
<H2>Crop N Fixation Pot1</H2>
<br>
<H3><CENTER>Calculate the quantity of atmospheric nitrogen fixed per unit standing crop biomass (fixation_determinant) and limited by the soil water deficit factor for fixation.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

current_phase = int (g_current_stage)<br>

n_fix_pot = <A HREF = "#n_fix_rate"> c_n_fix_rate </A><I><SUB> current_phase</SUB></I> * fixation_determinant * g_swdef_fixation<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "cproc_n_demand1">  </A>
<H2>Cproc N Demand1</H2>
<br>
<H3><CENTER>Return plant nitrogen demand for each plant component  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

Fill n_demand with 0 . 0<br>

Fill n_max with 0 . 0<br>

For each counter from 1 to num_demand_parts<br>

<blockquote>part = demand_parts<I><SUB> counter</SUB></I><br>

part_fract = divide (g_dlt_dm_green<I><SUB> part</SUB></I>, g_dlt_dm, 0 . 0)<br>

dlt_dm_pot = g_dlt_dm_pot_rue * part_fract<br>

dlt_dm_pot = bound (dlt_dm_pot, 0 . 0, g_dlt_dm_pot_rue)<br>

if (g_dm_green<I><SUB> part</SUB></I>.&gt;.0.0) then<br>

<blockquote>n_crit = g_dm_green<I><SUB> part</SUB></I> * g_n_conc_crit<I><SUB> part</SUB></I><br>

n_potential = g_dm_green<I><SUB> part</SUB></I> * g_n_conc_max<I><SUB> part</SUB></I><br>

n_demand_old = n_crit - (g_n_green<I><SUB> part</SUB></I>+g_dlt_n_retrans<I><SUB> part</SUB></I>)<br>

n_max_old = n_potential - (g_n_green<I><SUB> part</SUB></I>+g_dlt_n_retrans<I><SUB> part</SUB></I>)<br>

n_demand_new = dlt_dm_pot * g_n_conc_crit<I><SUB> part</SUB></I><br>

n_max_new = dlt_dm_pot * g_n_conc_max<I><SUB> part</SUB></I><br>

n_demand<I><SUB> part</SUB></I> = n_demand_old + n_demand_new<br>

n_max<I><SUB> part</SUB></I> = n_max_old + n_max_new<br>

n_demand<I><SUB> part</SUB></I> = l_bound (n_demand<I><SUB> part</SUB></I>, 0 . 0)<br>

n_max<I><SUB> part</SUB></I> = l_bound (n_max<I><SUB> part</SUB></I>, 0 . 0)<br>

</blockquote>else<br>

<blockquote>n_demand<I><SUB> part</SUB></I> = 0 . 0<br>

n_max<I><SUB> part</SUB></I> = 0 . 0<br>

</blockquote>endif<br>

</blockquote>next<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "cproc_n_init1">  </A>
<H2>Cproc N Init1</H2>
<br>
<H3><CENTER>Initialise plant Nitrogen pools  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

if (on_day_of (init_stage, g_current_stage, g_days_tot)) then<br>

<blockquote>For each part from 1 to max_part<br>

<blockquote>n_green<I><SUB> part</SUB></I> = <A HREF = "#n_init_conc"> c_n_init_conc </A><I><SUB> part</SUB></I> * g_dm_green<I><SUB> part</SUB></I><br>

</blockquote>next<br>

</blockquote>else<br>

endif<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "cproc_n_detachment1">  </A>
<H2>Cproc N Detachment1</H2>
<br>
<H3><CENTER>Simulate plant Nitrogen detachment.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

<A HREF = "#crop_pool_fraction_delta"> Calculate change in g_n_senesced based on fractional decay rates. </A><br>

<A HREF = "#crop_pool_fraction_delta"> Calculate change in g_n_dead based on fractional decay rates. </A><br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "cproc_n_supply2">  </A>
<H2>Cproc N Supply2</H2>
<br>
<H3><CENTER>Calculate nitrogen supplys from soil and fixation  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

<A HREF = "#crop_n_mass_flow1"> Calculate crop nitrogen supply from mass flow, g_no3gsm_mflow_avail. </A><br>

<A HREF = "#crop_n_diffusion1"> Calculate crop nitrogen supply from active uptake, g_no3gsm_diffn_pot. </A><br>

<A HREF = "#crop_n_fixation_pot1"> Calculate crop nitrogen supply from fixation, g_n_fix_pot. </A><br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "cproc_n_demand2">  </A>
<H2>Cproc N Demand2</H2>
<br>
<H3><CENTER>Return plant nitrogen demand for each plant component  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

Fill n_demand with 0 . 0<br>

Fill n_max with 0 . 0<br>

For each counter from 1 to num_demand_parts<br>

<blockquote>part = demand_parts<I><SUB> counter</SUB></I><br>

if (g_dm_green<I><SUB> part</SUB></I>.&gt;.0.0) then<br>

<blockquote>n_crit = g_dm_green<I><SUB> part</SUB></I> * g_n_conc_crit<I><SUB> part</SUB></I><br>

n_potential = g_dm_green<I><SUB> part</SUB></I> * g_n_conc_max<I><SUB> part</SUB></I><br>

n_demand_old = n_crit - (g_n_green<I><SUB> part</SUB></I>+g_dlt_n_retrans<I><SUB> part</SUB></I>)<br>

n_max_old = n_potential - (g_n_green<I><SUB> part</SUB></I>+g_dlt_n_retrans<I><SUB> part</SUB></I>)<br>

n_demand_new = g_dlt_dm_green<I><SUB> part</SUB></I> * g_n_conc_crit<I><SUB> part</SUB></I><br>

n_max_new = g_dlt_dm_green<I><SUB> part</SUB></I> * g_n_conc_max<I><SUB> part</SUB></I><br>

n_demand<I><SUB> part</SUB></I> = n_demand_old + n_demand_new<br>

n_max<I><SUB> part</SUB></I> = n_max_old + n_max_new<br>

n_demand<I><SUB> part</SUB></I> = l_bound (n_demand<I><SUB> part</SUB></I>, 0 . 0)<br>

n_max<I><SUB> part</SUB></I> = l_bound (n_max<I><SUB> part</SUB></I>, 0 . 0)<br>

</blockquote>else<br>

<blockquote>n_demand<I><SUB> part</SUB></I> = 0 . 0<br>

n_max<I><SUB> part</SUB></I> = 0 . 0<br>

</blockquote>endif<br>

</blockquote>next<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "cproc_n_uptake2">  </A>
<H2>Cproc N Uptake2</H2>
<br>
<H3><CENTER>Return actual plant nitrogen uptake from each soil layer.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

deepest_layer = find_layer_no (g_root_depth, g_dlayer, max_layer)<br>

For each layer from 1 to deepest_layer<br>

<blockquote>no3gsm_diffn_avail<I><SUB> layer</SUB></I> = g_no3gsm_diffn_pot<I><SUB> layer</SUB></I> - g_no3gsm_mflow_avail<I><SUB> layer</SUB></I><br>

no3gsm_diffn_avail<I><SUB> layer</SUB></I> = l_bound (no3gsm_diffn_avail<I><SUB> layer</SUB></I>, 0 . 0)<br>

</blockquote>next<br>

no3gsm_mflow_supply = sum_real_array (g_no3gsm_mflow_avail, deepest_layer)<br>

no3gsm_diffn_supply = sum_real_array (no3gsm_diffn_avail, deepest_layer)<br>

n_demand = sum_real_array (g_n_demand, max_part)<br>

n_max = sum_real_array (g_n_max, max_part)<br>

if (no3gsm_mflow_supply.&gt;=.n_demand) then<br>

<blockquote>no3gsm_mflow = no3gsm_mflow_supply<br>

no3gsm_mflow = u_bound (no3gsm_mflow, n_max)<br>

no3gsm_diffn = 0 . 0<br>

</blockquote>else<br>

<blockquote>no3gsm_mflow = no3gsm_mflow_supply<br>

if (<A HREF = "#n_supply_preference"> c_n_supply_preference </A>.=.'active') then<br>

<blockquote>no3gsm_diffn = bound (n_demand - no3gsm_mflow, 0 . 0, no3gsm_diffn_supply)<br>

</blockquote>elseif (<A HREF = "#n_supply_preference"> c_n_supply_preference </A>.=.'fixation') then<br>

<blockquote>no3gsm_diffn = bound (n_demand - no3gsm_mflow - g_n_fix_pot, 0 . 0, no3gsm_diffn_supply)<br>

</blockquote>else<br>

<blockquote>Report a fatal error<br>

</blockquote>endif<br>

no3gsm_diffn = divide (no3gsm_diffn, <A HREF = "#no3_diffn_const"> c_no3_diffn_const </A>, 0 . 0)<br>

</blockquote>endif<br>

Fill dlt_no3gsm with 0 . 0<br>

For each layer from 1 to deepest_layer<br>

<blockquote>mflow_fract = divide (g_no3gsm_mflow_avail<I><SUB> layer</SUB></I>, no3gsm_mflow_supply, 0 . 0)<br>

diffn_fract = divide (no3gsm_diffn_avail<I><SUB> layer</SUB></I>, no3gsm_diffn_supply, 0 . 0)<br>

no3gsm_uptake = no3gsm_mflow * mflow_fract + no3gsm_diffn * diffn_fract<br>

dlt_no3gsm<I><SUB> layer</SUB></I> = - no3gsm_uptake<br>

dlt_no3gsm_massflow<I><SUB> layer</SUB></I> = - no3gsm_mflow * mflow_fract<br>

dlt_no3gsm_diffusion<I><SUB> layer</SUB></I> = - no3gsm_diffn * diffn_fract<br>

</blockquote>next<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_stage_code">  </A>
<H2>Crop Stage Code</H2>
<br>
<H3><CENTER>Return an interpolated stage code from a table of stage_codes and a nominated stage number. Returns 0 if the stage number is not found. Interpolation is done on thermal time.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

if (numvals.&gt;=.2) then<br>

<blockquote>this_stage = stage_no_of (stage_table<I><SUB> 1</SUB></I>, <A HREF = "#stage_code_list"> c_stage_code_list </A>, max_stage)<br>

For each i from 2 to numvals<br>

<blockquote>next_stage = stage_no_of (stage_table<I><SUB> i</SUB></I>, <A HREF = "#stage_code_list"> c_stage_code_list </A>, max_stage)<br>

if (stage_is_between (this_stage, next_stage, stage_no)) then<br>

<blockquote>tt_tot = sum_between (this_stage, next_stage, g_tt_tot)<br>

phase_tt = sum_between (this_stage, next_stage, g_phase_tt)<br>

fraction_of = divide (tt_tot, phase_tt, 0 . 0)<br>

x_stage_code = stage_table<I><SUB> i - 1</SUB></I> + (stage_table<I><SUB> i</SUB></I>-stage_table<I><SUB> i - 1</SUB></I>) * fraction_of<br>

goto 2000<br>

</blockquote>else<br>

<blockquote>x_stage_code = 0 . 0<br>

this_stage = next_stage<br>

</blockquote>endif<br>

</blockquote>next<br>

</blockquote>next<br>

</blockquote>else<br>

<blockquote>x_stage_code = 0 . 0<br>

write (to error_message)  'invalid lookup table - number of values =' , numvals<br>

Print a warning error<br>

</blockquote>endif<br>

crop_stage_code = x_stage_code<br>

<br>

</blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "cproc_phenology1">  </A>
<H2>Cproc Phenology1</H2>
<br>
<H3><CENTER>Use temperature, photoperiod and genetic characteristics to determine when the crop begins a new growth phase. The initial daily thermal time and height are also set.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

g_previous_stage = g_current_stage<br>

<A HREF = "#crop_thermal_time"> Calculate today's thermal time, g_dlt_tt. </A><br>

<A HREF = "#crop_phase_devel"> Determine the progress through the current growth stage. </A><br>

<A HREF = "#crop_devel"> Determine the current stage of crop development. </A><br>

Accumulate g_dlt_tt (in array g_tt_tot)<br>

Accumulate 1 . 0 (in array g_days_tot)<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_thermal_time">  </A>
<H2>Crop Thermal Time</H2>
<br>
<H3><CENTER>Growing degree day (thermal time) is calculated. Daily thermal time is reduced if water or nitrogen stresses occur.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

dly_therm_time = linint_3hrly_temp (g_maxt, g_mint, <A HREF = "#x_temp"> c_x_temp </A>, <A HREF = "#y_tt"> c_y_tt </A>, <A HREF = "#num_temp"> c_num_temp </A>)<br>

if (stage_is_between (start_stress_stage, end_stress_stage, g_current_stage)) then<br>

<blockquote>g_dlt_tt = dly_therm_time * minimum of (g_swdef_pheno, g_nfact_pheno)<br>

</blockquote>else<br>

<blockquote>g_dlt_tt = dly_therm_time<br>

</blockquote>endif<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_phase_devel">  </A>
<H2>Crop Phase Devel</H2>
<br>
<H3><CENTER>Determine the fraction of current phase elapsed ().  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

if (stage_is_between (sowing_stage, germ_stage, g_current_stage)) then<br>

<blockquote>phase_devel = <A HREF = "#crop_germination"> Determine germination based upon soil moisture status. </A><br>

</blockquote>elseif (stage_is_between (germ_stage, end_development_stage, g_current_stage)) then<br>

<blockquote><A HREF = "#crop_germ_dlt_tt"> Calculate emergence adjusted thermal time (based on moisture status) </A><br>

phase_devel = <A HREF = "#crop_phase_tt"> the fractional progress through growth stage g_current_stage </A><br>

</blockquote>else<br>

<blockquote>phase_devel = mod (g_current_stage, 1 . 0)<br>

</blockquote>endif<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_germination">  </A>
<H2>Crop Germination</H2>
<br>
<H3><CENTER>Determine germination based on soil water availability  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

if (stage_is_between (sowing_stage, germ_stage, current_stage)) then<br>

<blockquote>layer_no_seed = find_layer_no (g_sowing_depth, g_dlayer, max_layer)<br>

pesw_seed = divide (g_sw_dep<I><SUB> layer_no_seed</SUB></I> - <A HREF = "#ll_dep"> p_ll_dep </A><I><SUB> layer_no_seed</SUB></I>, g_dlayer<I><SUB> layer_no_seed</SUB></I>, 0 . 0)<br>

if (pesw_seed.&gt;.<A HREF = "#pesw_germ"> c_pesw_germ </A>.and..not.on_day_of (sowing_stage, g_current_stage, g_days_tot)) then<br>

<blockquote>crop_germination = 1 . 0 + mod (g_current_stage, 1 . 0)<br>

</blockquote>else<br>

<blockquote>crop_germination = 0 . 999<br>

</blockquote>endif<br>

</blockquote>else<br>

<blockquote>crop_germination = 0 . 0<br>

</blockquote>endif<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_phase_tt">  </A>
<H2>Crop Phase Tt</H2>
<br>
<H3><CENTER>Return fraction of thermal time we are through the current phenological phase (0-1)  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

phase = int (stage_no)<br>

crop_phase_tt = divide (g_tt_tot<I><SUB> phase</SUB></I> + g_dlt_tt, g_phase_tt<I><SUB> phase</SUB></I>, 1 . 0)<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_germ_dlt_tt">  </A>
<H2>Crop Germ Dlt Tt</H2>
<br>
<H3><CENTER>Calculate daily thermal time for germination to emergence limited by soil water availability in the seed layer.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

current_phase = int (g_current_stage)<br>

if (current_phase.=.germ_phase) then<br>

<blockquote>layer_no_seed = find_layer_no (g_sowing_depth, g_dlayer, max_layer)<br>

fasw_seed = divide (g_sw_dep<I><SUB> layer_no_seed</SUB></I> - <A HREF = "#ll_dep"> p_ll_dep </A><I><SUB> layer_no_seed</SUB></I>, g_dul_dep<I><SUB> layer_no_seed</SUB></I> - <A HREF = "#ll_dep"> p_ll_dep </A><I><SUB> layer_no_seed</SUB></I>, 0 . 0)<br>

fasw_seed = bound (fasw_seed, 0 . 0, 1 . 0)<br>

rel_emerg_rate = linear_interp_real (fasw_seed, <A HREF = "#fasw_emerg"> c_fasw_emerg </A>, <A HREF = "#rel_emerg_rate"> c_rel_emerg_rate </A>, <A HREF = "#num_fasw_emerg"> c_num_fasw_emerg </A>)<br>

g_dlt_tt = g_dlt_tt * rel_emerg_rate<br>

</blockquote>else<br>

<blockquote>g_dlt_tt = g_dlt_tt<br>

</blockquote>endif<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_devel">  </A>
<H2>Crop Devel</H2>
<br>
<H3><CENTER>Determine the curent stage of development.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

new_stage = aint (g_current_stage) + g_phase_devel<br>

dlt_stage = new_stage - g_current_stage<br>

if (g_phase_devel.&gt;=.1.0) then<br>

<blockquote>current_stage = aint (current_stage + 1 . 0)<br>

if (int (current_stage).=.max_stage) then<br>

<blockquote>current_stage = 1 . 0<br>

</blockquote>else<br>

endif<br>

</blockquote>else<br>

<blockquote>current_stage = new_stage<br>

</blockquote>endif<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_root_length_init">  </A>
<H2>Crop Root Length Init</H2>
<br>
<H3><CENTER>Initialise crop root length at emergence based on root weight at emergence and specific root length.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

if (on_day_of (stage_to_init, g_current_stage, g_days_tot)) then<br>

<blockquote>initial_root_length = root_wt / sm2smm * <A HREF = "#specific_root_length"> c_specific_root_length </A><br>

rld = divide (initial_root_length, g_root_depth, 0 . 0)<br>

num_root_layers = find_layer_no (g_root_depth, g_dlayer, max_layer)<br>

Fill g_root_length with 0 . 0<br>

For each layer from 1 to num_root_layers<br>

<blockquote>g_root_length<I><SUB> layer</SUB></I> = rld * g_dlayer<I><SUB> layer</SUB></I> * root_proportion (layer, g_dlayer, g_root_depth)<br>

</blockquote>next<br>

</blockquote>else<br>

endif<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "cproc_root_length_senescence1">  </A>
<H2>Cproc Root Length Senescence1</H2>
<br>
<H3><CENTER>Calculate root length senescence based upon changes in senesced root biomass and the specific root length.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

Fill g_dlt_root_length_senesced with 0 . 0<br>

senesced_length = g_dlt_root_dm_senesced / sm2smm * <A HREF = "#specific_root_length"> c_specific_root_length </A><br>

<A HREF = "#crop_root_dist"> Distribute senesced_length over the profile according to root distribution </A><br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "cproc_root_depth1">  </A>
<H2>Cproc Root Depth1</H2>
<br>
<H3><CENTER>Calculate plant rooting depth through time limited by soil water content in layer through which roots are penetrating.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

deepest_layer = find_layer_no (g_root_depth, g_dlayer, crop_maximum number of layers)<br>

sw_avail_fac_deepest_layer = <A HREF = "#crop_sw_avail_fac"> Determine root hospitality factor for moisture (for layer deepest_layer) </A><br>

<A HREF = "#crop_root_depth_increase"> Calculate the increase in rooting depth. </A><br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_sw_avail_fac">  </A>
<H2>Crop Sw Avail Fac</H2>
<br>
<H3><CENTER>Get the soil water availability factor in a layer.  For a layer, it is 1.0 unless the plant-extractable soil water declines below a fraction of plant-extractable soil water capacity for that layer.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

pesw = sw_dep<I><SUB> layer</SUB></I> - ll_dep<I><SUB> layer</SUB></I><br>

pesw_capacity = dul_dep<I><SUB> layer</SUB></I> - ll_dep<I><SUB> layer</SUB></I><br>

sw_avail_ratio = divide (pesw, pesw_capacity, 10 . 0)<br>

crop_sw_avail_fac = linear_interp_real (sw_avail_ratio, x_sw_ratio, y_sw_fac_root, num_sw_ratio)<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_root_depth_increase">  </A>
<H2>Crop Root Depth Increase</H2>
<br>
<H3><CENTER>Return the increase in root depth (mm)  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

current_layer = find_layer_no (g_root_depth, g_dlayer, crop_maximum number of layers)<br>

current_phase = int (g_current_stage)<br>

dlt_root_depth = <A HREF = "#root_depth_rate"> c_root_depth_rate </A><I><SUB> current_phase</SUB></I> * g_sw_avail_fac_deepest_layer * <A HREF = "#xf"> p_xf </A><I><SUB> current_layer</SUB></I><br>

deepest_layer = count_of_real_vals (<A HREF = "#xf"> p_xf </A>, crop_maximum number of layers)<br>

root_depth_max = sum_real_array (g_dlayer, deepest_layer)<br>

dlt_root_depth = u_bound (dlt_root_depth, root_depth_max - g_root_depth)<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "cproc_root_depth_init1">  </A>
<H2>Cproc Root Depth Init1</H2>
<br>
<H3><CENTER>Return the initial root depth (mm)  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

if (on_day_of (initialisation_stage, current_stage, days_tot)) then<br>

<blockquote>root_depth = initial_root_depth<br>

</blockquote>else<br>

endif<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "cproc_root_length_init1">  </A>
<H2>Cproc Root Length Init1</H2>
<br>
<H3><CENTER>Initialise crop root length at emergence based on root weight at emergence and specific root length.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

if (on_day_of (stage_to_init, g_current_stage, g_days_tot)) then<br>

<blockquote>initial_root_length = root_wt / sm2smm * <A HREF = "#specific_root_length"> c_specific_root_length </A><br>

rld = divide (initial_root_length, g_root_depth, 0 . 0)<br>

num_root_layers = find_layer_no (g_root_depth, g_dlayer, max_layer)<br>

Fill g_root_length with 0 . 0<br>

For each layer from 1 to num_root_layers<br>

<blockquote>g_root_length<I><SUB> layer</SUB></I> = rld * g_dlayer<I><SUB> layer</SUB></I> * root_proportion (layer, g_dlayer, g_root_depth)<br>

</blockquote>next<br>

</blockquote>else<br>

endif<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "cproc_root_length_growth1">  </A>
<H2>Cproc Root Length Growth1</H2>
<br>
<H3><CENTER>Calculate the increase in root length density in each rooted layer based upon soil hospitality, moisture and fraction of layer explored by roots.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

if (max_layer.&gt;.crop_maximum number of layers) then<br>

<blockquote>Report a fatal error<br>

</blockquote>else<br>

<blockquote>Fill g_dlt_root_length with 0 . 0<br>

deepest_layer = find_layer_no (g_root_depth + g_dlt_root_depth, g_dlayer, max_layer)<br>

rlv_factor_tot = 0 . 0<br>

For each layer from 1 to deepest_layer<br>

<blockquote>rld = divide (g_root_length<I><SUB> layer</SUB></I>, g_dlayer<I><SUB> layer</SUB></I>, 0 . 0)<br>

plant_rld = divide (rld, g_plants, 0 . 0)<br>

branching_factor = linear_interp_real (plant_rld, <A HREF = "#x_plant_rld"> c_x_plant_rld </A>, <A HREF = "#y_rel_root_rate"> c_y_rel_root_rate </A>, <A HREF = "#num_plant_rld"> c_num_plant_rld </A>)<br>

rlv_factor<I><SUB> layer</SUB></I> = <A HREF = "#crop_sw_avail_fac"> Determine root hospitality factor for moisture (for layer layer) </A> * branching_factor * <A HREF = "#xf"> p_xf </A><I><SUB> layer</SUB></I> * divide (g_dlayer<I><SUB> layer</SUB></I>, g_root_depth, 0 . 0)<br>

rlv_factor<I><SUB> layer</SUB></I> = l_bound (rlv_factor<I><SUB> layer</SUB></I>, 1e - 6)<br>

rlv_factor_tot = rlv_factor_tot + rlv_factor<I><SUB> layer</SUB></I><br>

</blockquote>next<br>

dlt_length_tot = g_dlt_root_wt / sm2smm * <A HREF = "#specific_root_length"> c_specific_root_length </A><br>

For each layer from 1 to deepest_layer<br>

<blockquote>g_dlt_root_length<I><SUB> layer</SUB></I> = dlt_length_tot * divide (rlv_factor<I><SUB> layer</SUB></I>, rlv_factor_tot, 0 . 0)<br>

</blockquote>next<br>

</blockquote>endif<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_root_redistribute">  </A>
<H2>Crop Root Redistribute</H2>
<br>
<H3><CENTER>Map root length density distribution into a new layer structure after reduction is profile depth due to erosion.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

nlayr_rt_old = find_layer_no (root_depth_old, dlayer_old, nlayr_old)<br>

nlayr_rt_new = find_layer_no (root_depth_new, dlayer_new, nlayr_new)<br>

pro_red_fr = divide (root_depth_new, root_depth_old, 0 . 0)<br>

cum_root_depth<I><SUB> 1</SUB></I> = 0 . 0<br>

cum_root_length<I><SUB> 1</SUB></I> = 0 . 0<br>

For each layer from 1 to nlayr_rt_old<br>

<blockquote>if (layer.=.nlayr_rt_old) then<br>

<blockquote>cum_root_depth<I><SUB> layer + 1</SUB></I> = root_depth_old * pro_red_fr<br>

</blockquote>else<br>

<blockquote>cum_root_depth<I><SUB> layer + 1</SUB></I> = cum_root_depth<I><SUB> layer</SUB></I> + dlayer_old<I><SUB> layer</SUB></I> * pro_red_fr<br>

</blockquote>endif<br>

cum_root_length<I><SUB> layer + 1</SUB></I> = cum_root_length<I><SUB> layer</SUB></I> + root_length<I><SUB> layer</SUB></I><br>

</blockquote>next<br>

Fill root_length with 0 . 0<br>

For each layer from 1 to nlayr_rt_new<br>

<blockquote>layer_bottom = sum_real_array (dlayer_new, layer)<br>

layer_top = layer_bottom - dlayer_new<I><SUB> layer</SUB></I><br>

cum_root_top = linear_interp_real (layer_top, cum_root_depth, cum_root_length, nlayr_rt_old + 1)<br>

cum_root_bottom = linear_interp_real (layer_bottom, cum_root_depth, cum_root_length, nlayr_rt_old + 1)<br>

root_length<I><SUB> layer</SUB></I> = cum_root_bottom - cum_root_top<br>

</blockquote>next<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "cproc_root_depth2">  </A>
<H2>Cproc Root Depth2</H2>
<br>
<H3><CENTER>Calculate plant rooting depth through time  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

temp = 0 . 5 * (g_maxt+g_mint)<br>

temp_factor = linear_interp_real (temp, <A HREF = "#x_temp_root"> c_x_temp_root </A>, <A HREF = "#y_temp_root_fac"> c_y_temp_root_fac </A>, <A HREF = "#num_temp_root"> c_num_temp_root </A>)<br>

ws_factor = linear_interp_real (g_swdef_photo, <A HREF = "#x_ws_root"> c_x_ws_root </A>, <A HREF = "#y_ws_root_fac"> c_y_ws_root_fac </A>, <A HREF = "#num_ws_root"> c_num_ws_root </A>)<br>

<A HREF = "#crop_root_sw_avail_factor"> Determine root hospitality factor for moisture (for layer <A HREF = "#ll_dep"> p_ll_dep </A>) </A><br>

<A HREF = "#crop_root_depth_increase2"> Calculate the increase in rooting depth. </A><br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_root_sw_avail_factor">  </A>
<H2>Crop Root Sw Avail Factor</H2>
<br>
<H3><CENTER>Get the soil water availability factor for root depth growth. A weighted factor is used. it is 1.0 unless the plant-extractable soil water declines below a fraction of plant-extractable soil water capacity for the two adjacent layers  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

deepest_layer = count_of_real_vals (dlayer, crop_maximum number of layers)<br>

layer = find_layer_no (root_depth, dlayer, crop_maximum number of layers)<br>

cum_depth = sum_real_array (dlayer, layer)<br>

rootdepth_in_layer = dlayer<I><SUB> layer</SUB></I> - (cum_depth-root_depth)<br>

rootdepth_in_layer = bound (rootdepth_in_layer, 0 . 0, dlayer<I><SUB> layer</SUB></I>)<br>

weighting_factor = divide (rootdepth_in_layer, dlayer<I><SUB> layer</SUB></I>, 0 . 0)<br>

next_layer = minimum of (layer + 1, deepest_layer)<br>

fasw1 = divide (sw_dep<I><SUB> layer</SUB></I> - ll_dep<I><SUB> layer</SUB></I>, dul_dep<I><SUB> layer</SUB></I> - ll_dep<I><SUB> layer</SUB></I>, 0 . 0)<br>

fasw2 = divide (sw_dep<I><SUB> next_layer</SUB></I> - ll_dep<I><SUB> next_layer</SUB></I>, dul_dep<I><SUB> next_layer</SUB></I> - ll_dep<I><SUB> next_layer</SUB></I>, 0 . 0)<br>

fasw1 = minimum of (1 . 0, maximum of (0 . 0, fasw1))<br>

fasw2 = minimum of (1 . 0, maximum of (0 . 0, fasw2))<br>

fasw = weighting_factor * fasw2 + (1.-weighting_factor) * fasw1<br>

sw_avail_factor = linear_interp_real (fasw, x_sw_ratio, y_sw_fac_root, num_sw_ratio)<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_root_depth_increase2">  </A>
<H2>Crop Root Depth Increase2</H2>
<br>
<H3><CENTER>Return the increase in root depth (mm)  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

current_layer = find_layer_no (root_depth, dlayer, crop_maximum number of layers)<br>

current_phase = int (current_stage)<br>

dlt_root_depth = <A HREF = "#root_depth_rate"> c_root_depth_rate </A><I><SUB> current_phase</SUB></I> * temp_factor * minimum of (ws_factor, sw_avail_factor) * <A HREF = "#xf"> p_xf </A><I><SUB> current_layer</SUB></I><br>

deepest_layer = count_of_real_vals (<A HREF = "#xf"> p_xf </A>, crop_maximum number of layers)<br>

root_depth_max = sum_real_array (dlayer, deepest_layer)<br>

dlt_root_depth = u_bound (dlt_root_depth, root_depth_max - root_depth)<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_temperature_stress_photo">  </A>
<H2>Crop Temperature Stress Photo</H2>
<br>
<H3><CENTER>photosynthetic reduction factor for temperature stress (0-1)  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

ave_temp = (maxt+mint) / 2 . 0<br>

temp_stress_photo = linear_interp_real (ave_temp, x_ave_temp, y_stress_photo, num_ave_temp)<br>

temp_stress_photo = bound (temp_stress_photo, 0 . 0, 1 . 0)<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_radn_int0">  </A>
<H2>Crop Radn Int0</H2>
<br>
<H3><CENTER>Radiation intercepted by leaves (mj/m^2)  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

if (reals_are_equal (fr_intc_radn, 0 . 0)) then<br>

<blockquote>radn_int = cover_green * radn<br>

</blockquote>else<br>

<blockquote>radn_int = fr_intc_radn * radn<br>

</blockquote>endif<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_radn_int1">  </A>
<H2>Crop Radn Int1</H2>
<br>
<H3><CENTER>This routine returns the radiation intercepted by leaves (mj/m^2)  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

if (reals_are_equal (fr_intc_radn, 0 . 0)) then<br>

<blockquote>cover = 1 . 0 - <I><BIG>e</BIG></I><SUP>- extinction_coef * lai</SUP><br>

radn_int = cover * radn<br>

</blockquote>else<br>

<blockquote>radn_int = fr_intc_radn * radn<br>

</blockquote>endif<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_running_ave">  </A>
<H2>Crop Running Ave</H2>
<br>
<H3><CENTER>return the running average of an array over the last specified number of days.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

start_day = offset_day_of_year (year, day_of_year, - number_of_days)<br>

crop_running_ave = divide (sum_part_of_real (array, start_day, day_of_year, 366), real (abs (number_of_days)), 0 . 0)<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_sw_uptake0">  </A>
<H2>Crop Sw Uptake0</H2>
<br>
<H3><CENTER>Returns actual water uptake from each layer of the soil profile by the crop (mm).  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

deepest_layer = find_layer_no (root_depth, dlayer, num_layer)<br>

sw_supply_sum = sum_real_array (sw_supply, deepest_layer)<br>

if (sw_supply_sum.&lt;=.0.0.or.sw_demand.&lt;=.0.0) then<br>

<blockquote>Fill dlt_sw_dep with 0 . 0<br>

</blockquote>else<br>

<blockquote>Fill dlt_sw_dep with 0 . 0<br>

if (sw_demand.&lt;.sw_supply_sum) then<br>

<blockquote>For each layer from 1 to deepest_layer<br>

<blockquote>dlt_sw_dep<I><SUB> layer</SUB></I> = - divide (sw_supply<I><SUB> layer</SUB></I>, sw_supply_sum, 0 . 0) * sw_demand<br>

</blockquote>next<br>

</blockquote>else<br>

<blockquote>For each layer from 1 to deepest_layer<br>

<blockquote>dlt_sw_dep<I><SUB> layer</SUB></I> = - sw_supply<I><SUB> layer</SUB></I><br>

</blockquote>next<br>

</blockquote>endif<br>

</blockquote>endif<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_swdef_expansion">  </A>
<H2>Crop Swdef Expansion</H2>
<br>
<H3><CENTER>Get the soil water to demand ratio and calculate the 0-1 stress factor for leaf expansion. 1 is no stress, 0 is full stress.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

deepest_layer = find_layer_no (root_depth, dlayer, num_layer)<br>

sw_supply_sum = sum_real_array (sw_supply, deepest_layer)<br>

sw_demand_ratio = divide (sw_supply_sum, sw_demand, 10 . 0)<br>

swdef = linear_interp_real (sw_demand_ratio, x_sw_demand_ratio, y_swdef_leaf, num_sw_demand_ratio)<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_swdef_photo">  </A>
<H2>Crop Swdef Photo</H2>
<br>
<H3><CENTER>Calculate the soil water supply to demand ratio and therefore the 0-1 stress factor for photosysnthesis. 1 is no stress, 0 is full stress.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

deepest_layer = find_layer_no (root_depth, dlayer, num_layer)<br>

sw_supply_sum = sum_real_array (sw_supply, deepest_layer)<br>

sw_demand_ratio = divide (sw_supply_sum, sw_demand, 1 . 0)<br>

swdef = bound (sw_demand_ratio, 0 . 0, 1 . 0)<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_swdef_pheno">  </A>
<H2>Crop Swdef Pheno</H2>
<br>
<H3><CENTER>Get the soil water availability ratio in the root zone and calculate the 0 - 1 stress factor for phenology. 1 is no stress, 0 is full stress.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

deepest_layer = find_layer_no (root_depth, dlayer, num_layer)<br>

sw_avail_pot_sum = sum_real_array (sw_avail_pot, deepest_layer)<br>

sw_avail_sum = sum_real_array (sw_avail, deepest_layer)<br>

sw_avail_ratio = divide (sw_avail_sum, sw_avail_pot_sum, 1 . 0)<br>

sw_avail_ratio = bound (sw_avail_ratio, 0 . 0, 1 . 0)<br>

swdef = linear_interp_real (sw_avail_ratio, x_sw_avail_ratio, y_swdef_pheno, num_sw_avail_ratio)<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_swdef_fixation">  </A>
<H2>Crop Swdef Fixation</H2>
<br>
<H3><CENTER>Get the soil water availability ratio in the root zone and calculate the 0 - 1 stress factor for fixation. 1 is no stress, 0 is full stress.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

deepest_layer = find_layer_no (root_depth, dlayer, num_layer)<br>

sw_avail_pot_sum = sum_real_array (sw_avail_pot, deepest_layer)<br>

sw_avail_sum = sum_real_array (sw_avail, deepest_layer)<br>

sw_avail_ratio = divide (sw_avail_sum, sw_avail_pot_sum, 1 . 0)<br>

sw_avail_ratio = bound (sw_avail_ratio, 0 . 0, 1 . 0)<br>

swdef = linear_interp_real (sw_avail_ratio, x_sw_avail_fix, y_swdef_fix, num_sw_avail_fix)<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_oxdef_photo1">  </A>
<H2>Crop Oxdef Photo1</H2>
<br>
<H3><CENTER>Calculate 0-1 factor for water logging effect on growth  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

tot_root_fr = 1 . 0<br>

<A HREF = "#crop_root_dist"> Distribute tot_root_fr over the profile according to root distribution </A><br>

num_root_layers = count_of_real_vals (root_fr, max_layer)<br>

wet_root_fr = 0 . 0<br>

For each layer from 1 to num_root_layers<br>

<blockquote>wfps = divide (g_sw_dep<I><SUB> layer</SUB></I> - g_ll15_dep<I><SUB> layer</SUB></I>, g_sat_dep<I><SUB> layer</SUB></I> - g_ll15_dep<I><SUB> layer</SUB></I>, 0 . 0)<br>

wfps = bound (wfps, 0 . 0, 1 . 0)<br>

wet_root_fr = wet_root_fr + wfps * root_fr<I><SUB> layer</SUB></I><br>

</blockquote>next<br>

oxdef_photo = linear_interp_real (wet_root_fr, <A HREF = "#oxdef_photo_rtfr"> c_oxdef_photo_rtfr </A>, <A HREF = "#oxdef_photo"> c_oxdef_photo </A>, <A HREF = "#num_oxdef_photo"> c_num_oxdef_photo </A>)<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "cproc_sw_supply1">  </A>
<H2>Cproc Sw Supply1</H2>
<br>
<H3><CENTER>Calculate the crop water supply based on the KL approach.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

<A HREF = "#crop_check_sw"> Check validity of soil water parameters for all soil profile layers. </A><br>

<A HREF = "#crop_sw_avail_pot"> Calculate the potentially (or maximum) available soil water </A><br>

<A HREF = "#crop_sw_avail"> Calculate the available soil water </A><br>

<A HREF = "#crop_sw_supply"> Calculate today's soil water supply </A><br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_check_sw">  </A>
<H2>Crop Check Sw</H2>
<br>
<H3><CENTER>Check validity of soil water parameters for all soil profile layers.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

num_layers = count_of_real_vals (dlayer, max_layer)<br>

For each layer from 1 to num_layers<br>

<blockquote>sw = divide (sw_dep<I><SUB> layer</SUB></I>, dlayer<I><SUB> layer</SUB></I>, 0 . 0)<br>

dul = divide (dul_dep<I><SUB> layer</SUB></I>, dlayer<I><SUB> layer</SUB></I>, 0 . 0)<br>

ll = divide (ll_dep<I><SUB> layer</SUB></I>, dlayer<I><SUB> layer</SUB></I>, 0 . 0)<br>

if (ll.&lt;.minsw) then<br>

<blockquote>write (to err_messg)  ' lower limit of ' , ll , ' in layer ' , layer , new_line , '         is below acceptable value of ' , minsw<br>

Print a warning error<br>

</blockquote>else<br>

endif<br>

if (dul.&lt;=.ll) then<br>

<blockquote>write (to err_messg)  ' drained upper limit of ' , dul , ' in layer ' , layer , new_line , '         is at or below lower limit of ' , ll<br>

Print a warning error<br>

</blockquote>else<br>

endif<br>

if (sw.&lt;.minsw) then<br>

<blockquote>write (to err_messg)  ' soil water of ' , sw , ' in layer ' , layer , new_line , '         is below acceptable value of ' , minsw<br>

Print a warning error<br>

</blockquote>else<br>

endif<br>

</blockquote>next<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_sw_avail_pot">  </A>
<H2>Crop Sw Avail Pot</H2>
<br>
<H3><CENTER>Return potential available soil water from each layer in the root zone.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

Fill sw_avail_pot with 0 . 0<br>

deepest_layer = find_layer_no (root_depth, dlayer, num_layer)<br>

For each layer from 1 to deepest_layer<br>

<blockquote>sw_avail_pot<I><SUB> layer</SUB></I> = dul_dep<I><SUB> layer</SUB></I> - ll_dep<I><SUB> layer</SUB></I><br>

</blockquote>next<br>

sw_avail_pot<I><SUB> deepest_layer</SUB></I> = sw_avail_pot<I><SUB> deepest_layer</SUB></I> * root_proportion (deepest_layer, dlayer, root_depth)<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_sw_avail">  </A>
<H2>Crop Sw Avail</H2>
<br>
<H3><CENTER>Return actual water available for extraction from each layer in the soil profile by the crop (mm water)  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

Fill sw_avail with 0 . 0<br>

deepest_layer = find_layer_no (root_depth, dlayer, num_layer)<br>

For each layer from 1 to deepest_layer<br>

<blockquote>sw_avail<I><SUB> layer</SUB></I> = sw_dep<I><SUB> layer</SUB></I> - ll_dep<I><SUB> layer</SUB></I><br>

sw_avail<I><SUB> layer</SUB></I> = l_bound (sw_avail<I><SUB> layer</SUB></I>, 0 . 0)<br>

</blockquote>next<br>

sw_avail<I><SUB> deepest_layer</SUB></I> = sw_avail<I><SUB> deepest_layer</SUB></I> * root_proportion (deepest_layer, dlayer, root_depth)<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "crop_sw_supply">  </A>
<H2>Crop Sw Supply</H2>
<br>
<H3><CENTER>Return potential water uptake from each layer of the soil profile by the crop (mm water). This represents the maximum amount in each layer regardless of lateral root distribution but takes account of root depth in bottom layer.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

Fill sw_supply with 0 . 0<br>

deepest_layer = find_layer_no (root_depth, dlayer, num_layer)<br>

For each layer from 1 to deepest_layer<br>

<blockquote>sw_avail = (sw_dep<I><SUB> layer</SUB></I>-ll_dep<I><SUB> layer</SUB></I>)<br>

sw_supply<I><SUB> layer</SUB></I> = sw_avail * kl<I><SUB> layer</SUB></I><br>

sw_supply<I><SUB> layer</SUB></I> = l_bound (sw_supply<I><SUB> layer</SUB></I>, 0 . 0)<br>

</blockquote>next<br>

sw_supply<I><SUB> deepest_layer</SUB></I> = sw_supply<I><SUB> deepest_layer</SUB></I> * root_proportion (deepest_layer, dlayer, root_depth)<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "cproc_sw_uptake1">  </A>
<H2>Cproc Sw Uptake1</H2>
<br>
<H3><CENTER>Returns actual water uptake from each layer of the soil profile by the crop (mm).  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

deepest_layer = find_layer_no (root_depth, dlayer, num_layer)<br>

sw_supply_sum = sum_real_array (sw_supply, deepest_layer)<br>

if (sw_supply_sum.&lt;=.0.0.or.sw_demand.&lt;=.0.0) then<br>

<blockquote>Fill dlt_sw_dep with 0 . 0<br>

</blockquote>else<br>

<blockquote>Fill dlt_sw_dep with 0 . 0<br>

if (sw_demand.&lt;.sw_supply_sum) then<br>

<blockquote>For each layer from 1 to deepest_layer<br>

<blockquote>dlt_sw_dep<I><SUB> layer</SUB></I> = - divide (sw_supply<I><SUB> layer</SUB></I>, sw_supply_sum, 0 . 0) * sw_demand<br>

</blockquote>next<br>

</blockquote>else<br>

<blockquote>For each layer from 1 to deepest_layer<br>

<blockquote>dlt_sw_dep<I><SUB> layer</SUB></I> = - sw_supply<I><SUB> layer</SUB></I><br>

</blockquote>next<br>

</blockquote>endif<br>

</blockquote>endif<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "cproc_sw_demand1">  </A>
<H2>Cproc Sw Demand1</H2>
<br>
<H3><CENTER>Return crop water demand from soil by the crop (mm) calculated by dividing biomass production limited by radiation by transpiration efficiency.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

sw_demand = divide (dlt_dm_pot_rue, transp_eff, 0 . 0)<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "cproc_transp_eff1">  </A>
<H2>Cproc Transp Eff1</H2>
<br>
<H3><CENTER>Calculate today's transpiration efficiency from the transpiration efficiency coefficient and vapour pressure deficit, which is calculated from min and max temperatures.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

current_phase = int (current_stage)<br>

vpd = svp_fract * (svp<I><SUB> maxt</SUB></I>-svp<I><SUB> mint</SUB></I>)<br>

vpd = l_bound (vpd, 0 . 01)<br>

transp_eff = divide (transp_eff_cf<I><SUB> current_phase</SUB></I>, vpd, 0 . 0) / g2mm<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "cproc_bio_water1">  </A>
<H2>Cproc Bio Water1</H2>
<br>
<H3><CENTER>Calculate the potential biomass production based upon today's water supply.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<blockquote><br>

deepest_layer = find_layer_no (root_depth, dlayer, num_layer)<br>

sw_supply_sum = sum_real_array (sw_supply, deepest_layer)<br>

dlt_dm_pot_te = sw_supply_sum * transp_eff<br>

<br>

</blockquote></blockquote>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<A NAME = "Contact Information"> <H2>Contact Information</H2> </A>
For Further Information Please Contact:
<p>
<A HREF = "mailto:meinkeh@dpi.qld.gov.au"> Holger Meinke - Module Developer </A><br>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage Express 2.0">
<title></title>
</head>

<body>

<p><img src="..\..\..\docs\shared\apsimdocumentationbanner.jpg" width="640"
height="73"></p>
</body>
</html>
Date: 11/01/2001  APseudo Version:  1. 0 Rev.  1<br>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html> 
