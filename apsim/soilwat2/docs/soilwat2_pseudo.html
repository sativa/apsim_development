<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage Express 2.0">
<title></title>
</head>

<body>

<p><img src="..\..\..\docs\shared\apsimdocumentationbanner.jpg" width="640"
height="73"></p>
</body>
</html>
<TITLE>The APSIM SoilWat2 Model</TITLE>
<FONT SIZE = 7><B><CENTER>The APSIM SoilWat2 Model</CENTER></B></FONT>
<H1>TABLE OF CONTENTS</H1>
<H2><A HREF = "#Contact Information"> Contact Information </A></H2>
<H2><A HREF = "#Module Description"> Module Description </A></H2>
<H2>User Input Files</H2>
<ul><li>The Constants File

<ul><li><A HREF = "#standard.soilwat2.constants"> standard constants </A>

<li><A HREF = "#standard.soilwat2.tillage"> standard tillage </A>

</ul></ul>
<H2>Module Logic</H2>
<ul><li><A HREF = "#SoilWat TimeStep Calculations"> SoilWat TimeStep Calculations </A>

<li><A HREF = "#Add Water"> Add Water </A>

<li><A HREF = "#Tillage"> Tillage </A>

<li><A HREF = "#Structure Charts"> Structure Charts </A>

</ul>
<hr>
<A NAME = "Module Description">  </A>
<H2>Module Documentation</H2>
<br>
<A HREF = "soilwat2_int.pdf"> Interface document </A>
<br>
<A HREF = "soilwat2_science.pdf"> Science document </A>
<br>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<A NAME = "Structure Charts"> <H2>Module Structure Charts</H2> </A>
<H2>SoilWat TimeStep Calculations</H2>
<ul><li><A HREF = "#soilwat2_process"> soilwat2_process </A>

<ul><li><A HREF = "#soilwat2_runoff"> soilwat2_runoff </A>

<ul><li><A HREF = "#soilwat2_scs_runoff"> soilwat2_scs_runoff </A>

<ul><li><A HREF = "#soilwat2_runoff_depth_factor"> soilwat2_runoff_depth_factor </A>

<li><A HREF = "#soilwat2_runoff_cover"> soilwat2_runoff_cover </A>

</ul><li><A HREF = "#soilwat2_tillage_addrain"> soilwat2_tillage_addrain </A>

</ul><li><A HREF = "#soilwat2_infiltration"> soilwat2_infiltration </A>

<li><A HREF = "#soilwat2_irrig_solute"> soilwat2_irrig_solute </A>

<li><A HREF = "#soilwat2_drainage"> soilwat2_drainage </A>

<li><A HREF = "#soilwat2_move_solute_down"> soilwat2_move_solute_down </A>

<ul><li><A HREF = "#soilwat2_solute_flux"> soilwat2_solute_flux </A>

</ul><li><A HREF = "#soilwat2_pot_evapotranspiration"> soilwat2_pot_evapotranspiration </A>

<ul><li><A HREF = "#soilwat2_priestly_taylor"> soilwat2_priestly_taylor </A>

<ul><li><A HREF = "#soilwat2_eeq_fac"> soilwat2_eeq_fac </A>

</ul></ul><li><A HREF = "#soilwat2_evaporation"> soilwat2_evaporation </A>

<ul><li><A HREF = "#soilwat2_pot_soil_evaporation"> soilwat2_pot_soil_evaporation </A>

<li><A HREF = "#soilwat2_soil_evaporation"> soilwat2_soil_evaporation </A>

<ul><li><A HREF = "#soilwat2_ritchie_evaporation"> soilwat2_ritchie_evaporation </A>

<li><A HREF = "#soilwat2_bs_a_evaporation"> soilwat2_bs_a_evaporation </A>

<li><A HREF = "#soilwat2_bs_b_evaporation"> soilwat2_bs_b_evaporation </A>

<li><A HREF = "#soilwat2_bs_acs_evaporation"> soilwat2_bs_acs_evaporation </A>

<li><A HREF = "#soilwat2_rickert_evaporation"> soilwat2_rickert_evaporation </A>

<ul><li><A HREF = "#soilwat2_comp_curve"> soilwat2_comp_curve </A>

</ul></ul></ul><li><A HREF = "#soilwat2_unsat_flow"> soilwat2_unsat_flow </A>

<li><A HREF = "#soilwat2_check_profile"> soilwat2_check_profile </A>

<li><A HREF = "#soilwat2_move_solute_up"> soilwat2_move_solute_up </A>

<ul><li><A HREF = "#soilwat2_solute_flow"> soilwat2_solute_flow </A>

</ul></ul></ul>
<H2>Add Water</H2>
<ul><li><A HREF = "#soilwat2_add_water"> soilwat2_add_water </A>

</ul>
<H2>Tillage</H2>
<ul><li><A HREF = "#soilwat2_tillage"> soilwat2_tillage </A>

</ul>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<CENTER><A NAME = "Module Pseudo Code"> <H2><BIG>Module Pseudo Code</BIG></H2> </A></CENTER>
<hr>
<H2><BIG><A NAME = "SoilWat TimeStep Calculations"> SoilWat TimeStep Calculations </A></BIG></H2>
<A NAME = "soilwat2_process">  </A>
<H2>Soilwat2 Process</H2>
<br>
<H3><CENTER>simulates runoff, infiltration, flux (drainage), unsaturated flow, evaporation, solute movement, transpiration.  this needs further redesign and cleaning up. this is a test version only.   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

number of layers = number of elements in <A HREF = "#dlayer"> dlayer </A><br>

<A HREF = "#soilwat2_runoff"> Calculate Runoff </A><br>

<A HREF = "#soilwat2_infiltration"> Calculate infiltration into top layer </A><br>

sw<SUB>(in mm)</SUB><I><SUB> 1</SUB></I> = sw<SUB>(in mm)</SUB><I><SUB> 1</SUB></I> + infiltration<br>

<A HREF = "#soilwat2_irrig_solute"> Add solutes with irrigation </A><br>

irrigation = 0 . 0<br>

Fill irrigation_solute with 0 . 0<br>

<A HREF = "#soilwat2_drainage"> Calculate Drainage from each layer </A><br>

Move amounts of flux down array sw<SUB>(in mm)</SUB><br>

drain = flux<I><SUB> number of layers</SUB></I><br>

<A HREF = "#soilwat2_move_solute_down"> Calculate downward movement of solutes </A><br>

<A HREF = "#soilwat2_pot_evapotranspiration"> Calculate Potential EvapoTranspiration </A><br>

<A HREF = "#soilwat2_evaporation"> Calculate Actual Soil Evaporation </A><br>

For each layer from 1 to number of layers<br>

<dl>sw<SUB>(in mm)</SUB><I><SUB> layer</SUB></I> = sw<SUB>(in mm)</SUB><I><SUB> layer</SUB></I> - es_layers<I><SUB> layer</SUB></I><br>

</dl>next<br>

<A HREF = "#soilwat2_unsat_flow"> Calculate Unsaturated Solute and Water Flow </A><br>

Move amounts flow up array sw<SUB>(in mm)</SUB><br>

For each layer from 1 to number of layers<br>

<dl><A HREF = "#soilwat2_check_profile"> Check Soil Water Parameters for each layer </A><br>

<A HREF = "#soilwat2_move_solute_up"> Calculate upward movement of solutes </A><br>

<br>

</dl></dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<A NAME = "soilwat2_runoff">  </A>
<H2>Soilwat2 Runoff</H2>
<br>
<H3><CENTER>Runoff. Either predicted or observed.   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

runoff = 0 . 0<br>

if (rain.>.0.0) then<br>

<dl>if (obsrunoff_name.=.blank) then<br>

<dl><A HREF = "#soilwat2_scs_runoff"> Calculate runoff using scs curve number method </A><br>

</dl>else<br>

<dl>if (obsrunoff_found) then<br>

<dl>runoff = obsrunoff<br>

</dl>else<br>

<dl>write (to string)  'year = ' , year , ', day = ' , day , ', using predicted runoff for missing observation'<br>

Print a warning error<br>

<A HREF = "#soilwat2_scs_runoff"> Calculate runoff using scs curve number method </A><br>

</dl>endif<br>

</dl>endif<br>

<A HREF = "#soilwat2_tillage_addrain"> Accumulate rainfall for tillage cn reduction </A><br>

</dl>else<br>

endif<br>

<br>

</dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<A NAME = "soilwat2_scs_runoff">  </A>
<H2>Soilwat2 Scs Runoff</H2>
<br>
<H3><CENTER>calculate runoff using scs curve number method   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

number of layers = number of elements in <A HREF = "#dlayer"> dlayer </A><br>

<A HREF = "#soilwat2_runoff_depth_factor"> Calculate soil moisture effect on runoff </A><br>

For each layer from 1 to number of layers<br>

<dl>cnpd = cnpd + sw<SUB>(in mm)</SUB><I><SUB> layer</SUB></I> - ll15<SUB>(in mm)</SUB><I><SUB> layer</SUB></I> / dul<SUB>(in mm)</SUB><I><SUB> layer</SUB></I> - ll15<SUB>(in mm)</SUB><I><SUB> layer</SUB></I> * runoff_wf<I><SUB> layer</SUB></I><br>

</dl>next<br>

cnpd = cnpd constrained between 0 . 0 and 1 . 0<br>

<A HREF = "#soilwat2_runoff_cover"> Calculate the Effective Runoff Cover </A><br>

cover_fract = runoff_cover / <A HREF = "#cn_cov"> cn_cov </A><br>

cover_fract = cover_fract constrained between 0 . 0 and 1 . 0<br>

cn2_new = <A HREF = "#cn2_bare"> cn2_bare </A> - (<A HREF = "#cn_red"> cn_red </A>*cover_fract)<br>

if (tillage_cn_rain.>.0.0) then<br>

<dl>tillage_reduction = tillage_cn_red * (tillage_rain_sum / tillage_cn_rain-1.0)<br>

cn2_new = cn2_new + tillage_reduction<br>

</dl>else<br>

endif<br>

cn2_new = cn2_new constrained between 0 . 0 and 100 . 0<br>

cn1 = cn2_new / (2.334-0.01334*cn2_new)<br>

cn3 = cn2_new / (0.4036+0.005964*cn2_new)<br>

cn = cn1 + (cn3-cn1) * cnpd<br>

s = 254 . 0 * (100 . 0 / cn-1.0)<br>

xpb = rain - 0 . 2 * s<br>

xpb = xpb constrained above 0 . 0<br>

runoff = xpb * xpb / (rain+0.8*s)<br>

Check that runoff lies between 0 . 0 and rain<br>

<br>

</dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<A NAME = "soilwat2_runoff_depth_factor">  </A>
<H2>Soilwat2 Runoff Depth Factor</H2>
<br>
<H3><CENTER>Calculate the weighting factor hydraulic effectiveness used to weight the effect of soil moisture on runoff.   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

Fill runoff_wf with 0 . 0<br>

xx = 0 . 0<br>

cumulativedepth = 0 . 0<br>

wf<SUB>(total)</SUB> = 0 . 0<br>

number of layers = number of elements in <A HREF = "#dlayer"> dlayer </A><br>

profile_depth = <FONT FACE = "SYMBOL">S</FONT><SUP>1</SUP><SUB>number of layers</SUB> <A HREF = "#dlayer"> dlayer </A><br>

hydrol_effective_depth = minimum of (<A HREF = "#hydrol_effective_depth"> hydrol_effective_depth </A>, profile_depth)<br>

scale_fact = 1 . 0 / (1.0-<I><BIG>e</BIG></I><SUP>- 4 . 16</SUP>)<br>

hydrol_effective_layer = layer number corresponding to hydrol_effective_depth<br>

For each layer from 1 to hydrol_effective_layer<br>

<dl>cumulativedepth = cumulativedepth + <A HREF = "#dlayer"> dlayer </A><I><SUB> layer</SUB></I><br>

cumulativedepth = cumulativedepth constrained above hydrol_effective_depth<br>

wx = scale_fact * (1.0-<I><BIG>e</BIG></I><SUP>- 4 . 16 * cumulativedepth / hydrol_effective_depth</SUP>)<br>

runoff_wf<I><SUB> layer</SUB></I> = wx - xx<br>

xx = wx<br>

wf<SUB>(total)</SUB> = wf<SUB>(total)</SUB> + runoff_wf<I><SUB> layer</SUB></I><br>

</dl>next<br>

Check that wf<SUB>(total)</SUB> lies between 0 . 9999 and 1 . 0001<br>

<br>

</dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<A NAME = "soilwat2_runoff_cover">  </A>
<H2>Soilwat2 Runoff Cover</H2>
<br>
<H3><CENTER>calculate the effective runoff cover   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

effective_cover<SUB>(total)</SUB> = 0 . 0<br>

For each crop from 1 to number ofcrops<br>

<dl>if (canopy_height<I><SUB> crop</SUB></I>.>=.0.0) then<br>

<dl>canopy_fact = A linearly interpolated value based upon canopy_height<I><SUB> crop</SUB></I> (where X = <A HREF = "#canopy_fact_height"> canopy_fact_height </A>, Y = <A HREF = "#canopy_fact"> canopy_fact </A>)..<br>

</dl>else<br>

<dl>canopy_fact = <A HREF = "#canopy_fact_default"> canopy_fact_default </A><br>

</dl>endif<br>

effective_crop_cover = cover<SUB>(total)</SUB><I><SUB> crop</SUB></I> * canopy_fact<br>

effective_cover<SUB>(total)</SUB> = cover as a result of effective_cover<SUB>(total)</SUB> and effective_crop_cover<br>

runoff_cover = cover as a result of effective_cover<SUB>(total)</SUB> and residue_cover<br>

<br>

</dl></dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<A NAME = "soilwat2_tillage_addrain">  </A>
<H2>Soilwat2 Tillage Addrain</H2>
<br>
<H3><CENTER>accumulate rainfall for tillage cn reduction   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

tillage_rain_sum = tillage_rain_sum + rain<br>

if (tillage_cn_rain.>.0.0.and.tillage_rain_sum.>.tillage_cn_rain) then<br>

<dl>tillage_cn_rain = 0 . 0<br>

tillage_cn_red = 0 . 0<br>

write (to string)  'tillage cn reduction finished'<br>

Report this event to the system<br>

</dl>else<br>

endif<br>

<br>

</dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<A NAME = "soilwat2_infiltration">  </A>
<H2>Soilwat2 Infiltration</H2>
<br>
<H3><CENTER>infiltration into top layer after runoff.   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

infiltration = irrigation + rain - runoff<br>

<br>

</dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<A NAME = "soilwat2_irrig_solute">  </A>
<H2>Soilwat2 Irrig Solute</H2>
<br>
<H3><CENTER><insert here>   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

For each irr_solnum from 1 to number ofirrigation_solutes<br>

<dl>solnum = position of irrigation_solute_names<I><SUB> irr_solnum</SUB></I> in the list solute_names<br>

if (solnum.=/=.0) then<br>

<dl>solute<I><SUB> solnum, 1</SUB></I> = solute<I><SUB> solnum, 1</SUB></I> + irrigation_solute<I><SUB> irr_solnum</SUB></I><br>

<FONT FACE = "SYMBOL">D</FONT>solute<I><SUB> solnum, 1</SUB></I> = <FONT FACE = "SYMBOL">D</FONT>solute<I><SUB> solnum, 1</SUB></I> + irrigation_solute<I><SUB> irr_solnum</SUB></I><br>

</dl>else<br>

endif<br>

</dl>next<br>

<br>

</dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<A NAME = "soilwat2_drainage">  </A>
<H2>Soilwat2 Drainage</H2>
<br>
<H3><CENTER>calculate flux - drainage from each layer   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

w_in = 0 . 0<br>

Fill flux with 0 . 0<br>

number of layers = number of elements in <A HREF = "#dlayer"> dlayer </A><br>

For each layer from 1 to number of layers<br>

<dl>w<SUB>(total)</SUB> = sw<SUB>(in mm)</SUB><I><SUB> layer</SUB></I> + w_in<br>

if (w<SUB>(total)</SUB>.>.sat<SUB>(in mm)</SUB><I><SUB> layer</SUB></I>) then<br>

<dl>excess = w<SUB>(total)</SUB> - sat<SUB>(in mm)</SUB><I><SUB> layer</SUB></I><br>

w<SUB>(total)</SUB> = sat<SUB>(in mm)</SUB><I><SUB> layer</SUB></I><br>

</dl>else<br>

<dl>excess = 0 . 0<br>

</dl>endif<br>

if (w<SUB>(total)</SUB>.>.dul<SUB>(in mm)</SUB><I><SUB> layer</SUB></I>) then<br>

<dl>w_drain = (w<SUB>(total)</SUB>-dul<SUB>(in mm)</SUB><I><SUB> layer</SUB></I>) * <A HREF = "#swcon"> swcon </A><I><SUB> layer</SUB></I><br>

</dl>else<br>

<dl>w_drain = 0 . 0<br>

</dl>endif<br>

w_out = excess + w_drain<br>

flux<I><SUB> layer</SUB></I> = w_out<br>

w_in = w_out<br>

<br>

</dl></dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<A NAME = "soilwat2_move_solute_down">  </A>
<H2>Soilwat2 Move Solute Down</H2>
<br>
<H3><CENTER><insert here>   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

number of layers = number of elements in <A HREF = "#dlayer"> dlayer </A><br>

For each solnum from 1 to number ofsolutes<br>

<dl>mobile_no = position of solute_names<I><SUB> solnum</SUB></I> in the list <A HREF = "#mobile_solutes"> mobile_solutes </A><br>

if (mobile_no.=/=.0) then<br>

<dl>For each layer from 1 to maximum number of layers<br>

<dl>temp_solute<I><SUB> layer</SUB></I> = solute<I><SUB> solnum, layer</SUB></I><br>

leach<I><SUB> layer</SUB></I> = 0 . 0<br>

temp_solute_min<I><SUB> layer</SUB></I> = solute_min<I><SUB> solnum, layer</SUB></I><br>

temp<FONT FACE = "SYMBOL">D</FONT>solute<I><SUB> layer</SUB></I> = <FONT FACE = "SYMBOL">D</FONT>solute<I><SUB> solnum, layer</SUB></I><br>

</dl>next<br>

<A HREF = "#soilwat2_solute_flux"> Calculate the Solute Movement with Saturated Water Flux </A><br>

Move amounts of leach down array temp_solute<br>

Move amounts of leach down array temp<FONT FACE = "SYMBOL">D</FONT>solute<br>

For each layer from 1 to maximum number of layers<br>

<dl>solute<I><SUB> solnum, layer</SUB></I> = temp_solute<I><SUB> layer</SUB></I><br>

solute_leach<I><SUB> solnum, layer</SUB></I> = leach<I><SUB> layer</SUB></I><br>

<FONT FACE = "SYMBOL">D</FONT>solute<I><SUB> solnum, layer</SUB></I> = temp<FONT FACE = "SYMBOL">D</FONT>solute<I><SUB> layer</SUB></I><br>

</dl>next<br>

</dl>else<br>

endif<br>

</dl>next<br>

<br>

</dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<A NAME = "soilwat2_solute_flux">  </A>
<H2>Soilwat2 Solute Flux</H2>
<br>
<H3><CENTER>calculate the downward movement of solute with percolating water   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

Fill solute_out with 0 . 0<br>

number of layers = number of elements in <A HREF = "#dlayer"> dlayer </A><br>

in_solute = 0 . 0<br>

For each layer from 1 to number of layers<br>

<dl>out_w = flux<I><SUB> layer</SUB></I><br>

solute_kg_layer = solute_kg<I><SUB> layer</SUB></I> + in_solute<br>

water = sw<SUB>(in mm)</SUB><I><SUB> layer</SUB></I> + out_w<br>

out_solute = solute_kg_layer * out_w / water * <A HREF = "#solute_flux_eff"> solute_flux_eff </A><br>

out_max = solute_kg_layer - solute_min<I><SUB> layer</SUB></I> constrained above 0 . 0<br>

out_solute = out_solute constrained between 0 . 0 and out_max<br>

solute_out<I><SUB> layer</SUB></I> = out_solute<br>

in_solute = out_solute<br>

</dl>next<br>

<br>

</dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<A NAME = "soilwat2_pot_evapotranspiration">  </A>
<H2>Soilwat2 Pot Evapotranspiration</H2>
<br>
<H3><CENTER>calculate potential evapotranspiration   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

if (eo_source.=.blank) then<br>

<dl><A HREF = "#soilwat2_priestly_taylor"> Calculate potential evapotranspiration using priestly-taylor method </A><br>

</dl>else<br>

<dl>eo = eo_system<br>

</dl>endif<br>

<br>

</dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<A NAME = "soilwat2_priestly_taylor">  </A>
<H2>Soilwat2 Priestly Taylor</H2>
<br>
<H3><CENTER>calculate potential evapotranspiration via priestly-taylor   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

cover_green_sum = Total cover for all values of cover_green<br>

albedo = <A HREF = "#max_albedo"> max_albedo </A> - (<A HREF = "#max_albedo"> max_albedo </A>-<A HREF = "#salb"> salb </A>) * (1.0-cover_green_sum)<br>

wt_ave_temp = 0 . 60 * maxt + 0 . 40 * mint<br>

eeq = radn * 23 . 8846 * (0.000204-0.000183*albedo) * (wt_ave_temp+29.0)<br>

eo = eeq * <A HREF = "#soilwat2_eeq_fac"> Calculate the Equilibrium Evaporation Rate </A><br>

<br>

</dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<A NAME = "soilwat2_eeq_fac">  </A>
<H2>Soilwat2 Eeq Fac</H2>
<br>
<H3><CENTER>calculate coefficient for equilibrium evaporation rate   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

if (maxt.>.<A HREF = "#max_crit_temp"> max_crit_temp </A>) then<br>

<dl>soilwat2_eeq_fac = ((maxt-<A HREF = "#max_crit_temp"> max_crit_temp </A>)*0.05+1.1)<br>

</dl>else if (maxt.<.<A HREF = "#min_crit_temp"> min_crit_temp </A>) then<br>

<dl>soilwat2_eeq_fac = 0 . 01 * <I><BIG>e</BIG></I><SUP>0 . 18 * (maxt+20.0)</SUP><br>

</dl>else<br>

<dl>soilwat2_eeq_fac = 1 . 1<br>

</dl>endif<br>

<br>

</dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<A NAME = "soilwat2_evaporation">  </A>
<H2>Soilwat2 Evaporation</H2>
<br>
<H3><CENTER>calculate actual soil evaporation   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

<A HREF = "#soilwat2_pot_soil_evaporation"> Calculate potential soil evaporation </A><br>

asw1 = sw<SUB>(in mm)</SUB><I><SUB> 1</SUB></I> - air_dry<SUB>(in mm)</SUB><I><SUB> 1</SUB></I><br>

asw1 = asw1 constrained between 0 . 0 and eo<br>

<A HREF = "#soilwat2_soil_evaporation"> Soil Evaporation from Soil Surface </A><br>

<br>

</dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<A NAME = "soilwat2_pot_soil_evaporation">  </A>
<H2>Soilwat2 Pot Soil Evaporation</H2>
<br>
<H3><CENTER>calculate potential soil evaporation   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

cover_tot_sum = Total cover for all values of cover<SUB>(total)</SUB><br>

eos_canopy_fract = <I><BIG>e</BIG></I><SUP>- <A HREF = "#canopy_eos_coef"> canopy_eos_coef </A> * cover_tot_sum</SUP><br>

if (residue_cover.>=.1.0) then<br>

<dl>eos_residue_fract = 0 . 0<br>

</dl>else<br>

<dl>resid_area = - <I>log</I><SUB>e</SUB>(1 . 0 - residue_cover) / residueweight<br>

eos_resid_coef = resid_area * <A HREF = "#a_to_evap_fact"> a_to_evap_fact </A><br>

eos_residue_fract = <I><BIG>e</BIG></I><SUP>- eos_resid_coef * residueweight</SUP><br>

</dl>endif<br>

eos = eo * eos_canopy_fract * eos_residue_fract<br>

<br>

</dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<A NAME = "soilwat2_soil_evaporation">  </A>
<H2>Soilwat2 Soil Evaporation</H2>
<br>
<H3><CENTER>Wrapper for various evaporation models. Returns actual evaporation from soil surface (es).   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

Fill es with 0 . 0<br>

if (<A HREF = "#evap_method"> evap_method </A>.=.<A HREF = "#ritchie_method"> ritchie_method </A>) then<br>

<dl><A HREF = "#soilwat2_ritchie_evaporation"> Calculate evaporation Ritchie model </A><br>

</dl>else if (<A HREF = "#evap_method"> evap_method </A>.=.<A HREF = "#bs_a_method"> bs_a_method </A>) then<br>

<dl><A HREF = "#soilwat2_bs_a_evaporation"> Calculate evaporation using B&S (A) model </A><br>

</dl>else if (<A HREF = "#evap_method"> evap_method </A>.=.<A HREF = "#bs_b_method"> bs_b_method </A>) then<br>

<dl><A HREF = "#soilwat2_bs_b_evaporation"> Calculate evaporation using B&S (B) model </A><br>

</dl>else if (<A HREF = "#evap_method"> evap_method </A>.=.<A HREF = "#bs_acs_method"> bs_acs_method </A>) then<br>

<dl><A HREF = "#soilwat2_bs_acs_evaporation"> Calculate evaporation using B&S (B, ACS) model </A><br>

</dl>else if (<A HREF = "#evap_method"> evap_method </A>.=.<A HREF = "#rickert_method"> rickert_method </A>) then<br>

<dl><A HREF = "#soilwat2_rickert_evaporation"> Calculate evaporation using Rickert model </A><br>

</dl>else<br>

<dl>Report a fatal error<br>

</dl>endif<br>

<br>

</dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<A NAME = "soilwat2_ritchie_evaporation">  </A>
<H2>Soilwat2 Ritchie Evaporation</H2>
<br>
<H3><CENTER>****** calculate actual evaporation from soil surface (es) ****** most es takes place in two stages: the constant rate stage and the falling rate stage (philip, 1957).  in the constant rate stage (stage 1), the soil is sufficiently wet for water be transported to the surface at a rate at least equal to the evaporation potential (eos). in the falling rate stage (stage 2), the surface soil water content has decreased below a threshold value, so that es depends on the flux of water through the upper layer of soil to the evaporating site near the surface.   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

sumes1_max = <A HREF = "#u"> u </A><br>

w_inf = infiltration<br>

if (w_inf.>.0.0) then<br>

<dl>sumes2 = maximum of (0 . 0, sumes2 - maximum of (0 . 0, w_inf - sumes1))<br>

sumes1 = maximum of (0 . 0, sumes1 - w_inf)<br>

t = (sumes2 / <A HREF = "#cona"> cona </A>) * * 2<br>

</dl>else<br>

endif<br>

if (sumes1.<.sumes1_max) then<br>

<dl>esoil1 = minimum of (eos, sumes1_max - sumes1)<br>

if (eos.>.esoil1.and.esoil1.<.eos_max) then<br>

<dl>if (sumes2.>.0.0) then<br>

<dl>t = t + 1 . 0<br>

esoil2 = minimum of (eos - esoil1, <A HREF = "#cona"> cona </A> * t * * 0 . 5 - sumes2)<br>

</dl>else<br>

<dl>esoil2 = 0 . 6 * (eos-esoil1)<br>

</dl>endif<br>

</dl>else<br>

<dl>esoil2 = 0 . 0<br>

</dl>endif<br>

esoil2 = minimum of (esoil2, eos_max - esoil1)<br>

sumes1 = sumes1 + esoil1<br>

sumes2 = sumes2 + esoil2<br>

t = (sumes2 / <A HREF = "#cona"> cona </A>) * * 2<br>

</dl>else<br>

<dl>esoil1 = 0 . 0<br>

t = t + 1 . 0<br>

esoil2 = minimum of (eos, <A HREF = "#cona"> cona </A> * t * * 0 . 5 - sumes2)<br>

esoil2 = minimum of (esoil2, eos_max)<br>

sumes2 = sumes2 + esoil2<br>

</dl>endif<br>

es = esoil1 + esoil2<br>

es = es constrained between 0 . 0 and eos<br>

es = es constrained between 0 . 0 and eos_max<br>

<br>

</dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<A NAME = "soilwat2_bs_a_evaporation">  </A>
<H2>Soilwat2 Bs A Evaporation</H2>
<br>
<H3><CENTER>B&S (in their paper this is Option A. Fig 2)   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

sumes1_max = <A HREF = "#beta"> beta </A> * * 2<br>

w_inf = infiltration<br>

if (w_inf.>=.eos) then<br>

<dl>sumes = maximum of (0 . 0, sumes - (w_inf-eos))<br>

es = eos<br>

espot = sumes * * 2 / <A HREF = "#beta"> beta </A> * * 2<br>

sumeos = maximum of (sumes, espot)<br>

</dl>else<br>

<dl>sumeos = sumeos + (eos-w_inf)<br>

es = w_inf + (minimum of (sumeos, <A HREF = "#beta"> beta </A> * sumeos * * 0 . 5)-sumes)<br>

sumes = minimum of (sumeos, <A HREF = "#beta"> beta </A> * sumeos * * 0 . 5)<br>

</dl>endif<br>

if (es . > . sumes) then<br>

sumes = es<br>

</dl>endif<br>

if (sumes . <= . sumes1_max) then<br>

sumeos = sumes<br>

</dl>else<br>

<dl>sumeos = (sumes / <A HREF = "#beta"> beta </A>) * * 2<br>

</dl>endif<br>

if (sumes.>=.sumes1_max) then<br>

<dl>sumes1 = sumes1_max<br>

sumes2 = sumes - sumes1<br>

</dl>else<br>

<dl>sumes1 = sumes<br>

sumes2 = 0 . 0<br>

</dl>endif<br>

es = es constrained between 0 . 0 and eos<br>

es = es constrained between 0 . 0 and eos_max<br>

<br>

</dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<A NAME = "soilwat2_bs_b_evaporation">  </A>
<H2>Soilwat2 Bs B Evaporation</H2>
<br>
<H3><CENTER>B&S. This code tries to achieve the result stated for their Option B. Evaporate small rainfall events & then step back to the original state   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

sumes1_max = <A HREF = "#beta"> beta </A> * * 2<br>

w_inf = infiltration<br>

if (w_inf.>.0.0) then<br>

<dl>sumes2 = maximum of (0 . 0, sumes2 - maximum of (0 . 0, w_inf - sumes1))<br>

sumes1 = maximum of (0 . 0, sumes1 - w_inf)<br>

sumes = sumes1 + sumes2<br>

if (sumes . <= . sumes1_max) then<br>

sumeos = sumes<br>

</dl>else<br>

<dl>sumeos = (sumes / <A HREF = "#beta"> beta </A>) * * 2<br>

</dl>endif<br>

</dl>else<br>

endif<br>

sumeos = sumeos + eos<br>

if (sumeos . <= . sumes1_max) then<br>

todays_es = eos<br>

sumes = sumes + todays_es<br>

</dl>else<br>

<dl>todays_es = <A HREF = "#beta"> beta </A> * sumeos * * 0 . 5 - sumes<br>

todays_es = todays_es constrained between 0 . 0 and eos<br>

sumes = sumes + todays_es<br>

sumeos = (sumes / <A HREF = "#beta"> beta </A>) * * 2<br>

</dl>endif<br>

if (sumes1.<.sumes1_max) then<br>

<dl>esoil1 = minimum of (eos, sumes1_max - sumes1)<br>

if (eos.>.esoil1.and.esoil1.<.eos_max) then<br>

<dl>esoil2 = (eos-esoil1) * 0 . 6<br>

</dl>else<br>

<dl>esoil2 = 0 . 0<br>

</dl>endif<br>

esoil2 = minimum of (esoil2, eos_max - esoil1)<br>

sumes1 = sumes1 + esoil1<br>

sumes2 = sumes2 + esoil2<br>

</dl>else<br>

<dl>esoil1 = 0 . 0<br>

esoil2 = todays_es<br>

esoil2 = minimum of (esoil2, eos_max)<br>

sumes2 = sumes2 + esoil2<br>

</dl>endif<br>

sumes = sumes1 + sumes2<br>

sumeos = (sumes / <A HREF = "#beta"> beta </A>) * * 2<br>

es = esoil1 + esoil2<br>

es = es constrained between 0 . 0 and todays_es<br>

es = es constrained between 0 . 0 and eos_max<br>

<br>

</dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<A NAME = "soilwat2_bs_acs_evaporation">  </A>
<H2>Soilwat2 Bs Acs Evaporation</H2>
<br>
<H3><CENTER>acs attempt at B&S Option B infiltration > evap at stage 1, then return to original (pdev - I think this is work in progress, incomplete)   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

sumes1_max = <A HREF = "#beta"> beta </A> * * 2<br>

w_inf = infiltration<br>

sumes_yest = sumes<br>

if ((inf_pool.=.0.0).and.(w_inf.>.0.0)) then<br>

<dl>sumes_yest = 0 . 0<br>

sumes_last = sumes<br>

sumeos_last = sumeos<br>

</dl>else<br>

endif<br>

inf_pool = inf_pool + w_inf<br>

if (inf_pool.>.0.0) then<br>

<dl>sumes = 0 . 0<br>

sumeos = 0 . 0<br>

</dl>else<br>

endif<br>

if (sw<SUB>(in mm)</SUB><I><SUB> 1</SUB></I>.>.(0.9*(dul<SUB>(in mm)</SUB><I><SUB> 1</SUB></I>-air_dry<SUB>(in mm)</SUB><I><SUB> 1</SUB></I>))) then<br>

<dl>sumes_last = 0 . 0<br>

sumeos_last = 0 . 0<br>

</dl>else<br>

endif<br>

sumeos = sumeos + eos<br>

if (sumes.<.sumes1_max) then<br>

<dl>sumes = sumeos<br>

</dl>else<br>

<dl>sumes = <A HREF = "#beta"> beta </A> * sumeos * * 0 . 5<br>

</dl>endif<br>

es = sumes - sumes_yest<br>

inf_pool = maximum of (0 . 0, inf_pool - es)<br>

if (inf_pool.<=.0.0) then<br>

<dl>if (sumes_last.>.0.0) then<br>

<dl>surplus_es = 0 . 0 - inf_pool<br>

inf_pool = 0 . 0<br>

sumes = sumes_last + surplus_es<br>

if (surplus_es.<.sumes1_max) then<br>

<dl>sumeos = sumeos_last + surplus_es<br>

</dl>else<br>

<dl>sumeos = sumeos_last + (surplus_es/<A HREF = "#beta"> beta </A>) * * 2<br>

</dl>endif<br>

</dl>else<br>

endif<br>

</dl>else<br>

endif<br>

es = es constrained between 0 . 0 and eos_max<br>

<br>

</dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<A NAME = "soilwat2_rickert_evaporation">  </A>
<H2>Soilwat2 Rickert Evaporation</H2>
<br>
<H3><CENTER>Ex Grasp                <<< need better description here - dms!!!>>> Evaporate moisture from the soil surface. The moisture can come from layers 1 & 2, if the supply is sufficient. Total evap is limited by an upper bound, max_evap, from soil parameters.    </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

Fill es with 0 . 0<br>

avail_water_l1 = sw<SUB>(in mm)</SUB><I><SUB> 1</SUB></I> - air_dry<SUB>(in mm)</SUB><I><SUB> 1</SUB></I><br>

avail_capacity_l1 = dul<SUB>(in mm)</SUB><I><SUB> 1</SUB></I> - air_dry<SUB>(in mm)</SUB><I><SUB> 1</SUB></I><br>

supply_ratio_l1 = avail_water_l1 / avail_capacity_l1<br>

supply_ratio_l1 = <A HREF = "#soilwat2_comp_curve"> Competition curve supply_ratio_l1, weighting 0 . 285 </A><br>

supply_ratio_l1 = supply_ratio_l1 constrained between 0 . 0 and 1 . 0<br>

avail_water_l1_l2 = sw<SUB>(in mm)</SUB><I><SUB> 1</SUB></I> + sw<SUB>(in mm)</SUB><I><SUB> 2</SUB></I> - air_dry<SUB>(in mm)</SUB><I><SUB> 1</SUB></I> - ll15<SUB>(in mm)</SUB><I><SUB> 2</SUB></I><br>

avail_capacity_l1_l2 = dul<SUB>(in mm)</SUB><I><SUB> 1</SUB></I> + dul<SUB>(in mm)</SUB><I><SUB> 2</SUB></I> - air_dry<SUB>(in mm)</SUB><I><SUB> 1</SUB></I> - ll15<SUB>(in mm)</SUB><I><SUB> 2</SUB></I><br>

supply_ratio_l1_l2 = avail_water_l1_l2 / avail_capacity_l1_l2<br>

supply_ratio_l1_l2 = <A HREF = "#soilwat2_comp_curve"> Competition curve supply_ratio_l1_l2, weighting 0 . 117 </A><br>

supply_ratio_l1_l2 = supply_ratio_l1_l2 constrained between 0 . 0 and 1 . 0<br>

evap_l1 = supply_ratio_l1 * eos<br>

eos_max = minimum of (<A HREF = "#max_evap"> max_evap </A>, sw<SUB>(in mm)</SUB><I><SUB> 1</SUB></I> - air_dry<SUB>(in mm)</SUB><I><SUB> 1</SUB></I>)<br>

evap_l1 = evap_l1 constrained between 0 . 0 and eos_max<br>

if (supply_ratio_l1_l2.>.supply_ratio_l1.and.sw<SUB>(in mm)</SUB><I><SUB> 2</SUB></I>.>.ll15<SUB>(in mm)</SUB><I><SUB> 2</SUB></I>) then<br>

<dl>supply_ratio_l2 = supply_ratio_l1_l2 - supply_ratio_l1<br>

evap_l2 = supply_ratio_l2 * eos<br>

eos_max = minimum of (<A HREF = "#max_evap"> max_evap </A> - evap_l1, sw<SUB>(in mm)</SUB><I><SUB> 2</SUB></I> - ll15<SUB>(in mm)</SUB><I><SUB> 2</SUB></I>)<br>

evap_l2 = evap_l2 constrained between 0 . 0 and eos_max<br>

</dl>else<br>

<dl>evap_l2 = 0 . 0<br>

</dl>endif<br>

eos_max = sw<SUB>(in mm)</SUB><I><SUB> 1</SUB></I> - air_dry<SUB>(in mm)</SUB><I><SUB> 1</SUB></I> + sw<SUB>(in mm)</SUB><I><SUB> 2</SUB></I> - ll15<SUB>(in mm)</SUB><I><SUB> 2</SUB></I><br>

if (evap_l1+evap_l2.>.eos_max) then<br>

<dl>Print a warning error<br>

</dl>else<br>

endif<br>

es<I><SUB> 1</SUB></I> = evap_l1<br>

es<I><SUB> 2</SUB></I> = evap_l2<br>

<br>

</dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<A NAME = "soilwat2_comp_curve">  </A>
<H2>Soilwat2 Comp Curve</H2>
<br>
<H3><CENTER>.... from GRASP (Surfair) Standard competition curve (or at least so McKeon calls it) This function is used by McKeon in several places to transform an index in the range [0-1] to another index in the same range, but weighted in a different way. The weighting is controlled by the a parameter. An "a" value  of 1 leaves the index untransformed.   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

soilwat2_comp_curve = a * ndx / ndx * (a-1.0) + 1 . 0<br>

<br>

</dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<A NAME = "soilwat2_unsat_flow">  </A>
<H2>Soilwat2 Unsat Flow</H2>
<br>
<H3><CENTER>calculate unsaturated flow below drained upper limit   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

number of layers = number of elements in <A HREF = "#dlayer"> dlayer </A><br>

Fill flow with 0 . 0<br>

second_last_layer = number of layers - 1<br>

w_out = 0 . 0<br>

For each layer from 1 to second_last_layer<br>

<dl>next_layer = layer + 1<br>

dlayer1 = <A HREF = "#dlayer"> dlayer </A><I><SUB> layer</SUB></I><br>

dlayer2 = <A HREF = "#dlayer"> dlayer </A><I><SUB> next_layer</SUB></I><br>

ave_dlayer = (dlayer1+dlayer2) * 0 . 5<br>

sw_dep1 = sw<SUB>(in mm)</SUB><I><SUB> layer</SUB></I><br>

sw_dep2 = sw<SUB>(in mm)</SUB><I><SUB> next_layer</SUB></I><br>

ll15_dep1 = ll15<SUB>(in mm)</SUB><I><SUB> layer</SUB></I><br>

ll15_dep2 = ll15<SUB>(in mm)</SUB><I><SUB> next_layer</SUB></I><br>

sat_dep1 = sat<SUB>(in mm)</SUB><I><SUB> layer</SUB></I><br>

sat_dep2 = sat<SUB>(in mm)</SUB><I><SUB> next_layer</SUB></I><br>

esw_dep1 = (sw_dep1-w_out) - ll15_dep1 constrained above 0 . 0<br>

esw_dep2 = sw_dep2 - ll15_dep2 constrained above 0 . 0<br>

<FONT FACE = "SYMBOL">T</FONT>1 = esw_dep1 / dlayer1<br>

<FONT FACE = "SYMBOL">T</FONT>2 = esw_dep2 / dlayer2<br>

dbar = <A HREF = "#diffus_const"> diffus_const </A> * <I><BIG>e</BIG></I><SUP><A HREF = "#diffus_slope"> diffus_slope </A> * (<FONT FACE = "SYMBOL">T</FONT>1+<FONT FACE = "SYMBOL">T</FONT>2) * 0 . 5</SUP><br>

dbar = dbar constrained between 0 . 0 and 10000 . 0<br>

sw1 = (sw_dep1-w_out) / dlayer1<br>

sw1 = sw1 constrained above 0 . 0<br>

sw2 = sw_dep2 / dlayer2<br>

sw2 = sw2 constrained above 0 . 0<br>

gradient = (sw2-sw1) / ave_dlayer - <A HREF = "#gravity_gradient"> gravity_gradient </A><br>

flow<I><SUB> layer</SUB></I> = dbar * gradient<br>

swg = <A HREF = "#gravity_gradient"> gravity_gradient </A> * ave_dlayer<br>

sum_inverse_dlayer = 1 . 0 / dlayer1 + 1 . 0 / dlayer2<br>

flow_max = (sw2-sw1-swg) / sum_inverse_dlayer<br>

if (flow<I><SUB> layer</SUB></I>.<.0.0) then<br>

<dl>next_layer_cap = sat_dep2 - sw_dep2 constrained above 0 . 0<br>

flow_max = flow_max constrained above - next_layer_cap<br>

flow_max = flow_max constrained above - esw_dep1<br>

flow<I><SUB> layer</SUB></I> = flow<I><SUB> layer</SUB></I> constrained above flow_max<br>

</dl>elseif (flow<I><SUB> layer</SUB></I>.>.0.0) then<br>

<dl>this_layer_cap = sat_dep1 - (sw_dep1-w_out) constrained above 0 . 0<br>

flow_max = flow_max constrained above this_layer_cap<br>

flow_max = flow_max constrained above esw_dep2<br>

flow<I><SUB> layer</SUB></I> = flow<I><SUB> layer</SUB></I> constrained above flow_max<br>

</dl>else<br>

endif<br>

w_out = flow<I><SUB> layer</SUB></I><br>

</dl>next<br>

<br>

</dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<A NAME = "soilwat2_check_profile">  </A>
<H2>Soilwat2 Check Profile</H2>
<br>
<H3><CENTER>checks validity of soil water parameters for a soil profile layer   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl>max_sw = 1 . 0 - bd<I><SUB> layer</SUB></I> / <A HREF = "#specific_bd"> specific_bd </A><br>

sw = sw<SUB>(in mm)</SUB><I><SUB> layer</SUB></I> / <A HREF = "#dlayer"> dlayer </A><I><SUB> layer</SUB></I><br>

sat = sat<SUB>(in mm)</SUB><I><SUB> layer</SUB></I> / <A HREF = "#dlayer"> dlayer </A><I><SUB> layer</SUB></I><br>

dul = dul<SUB>(in mm)</SUB><I><SUB> layer</SUB></I> / <A HREF = "#dlayer"> dlayer </A><I><SUB> layer</SUB></I><br>

ll15 = ll15<SUB>(in mm)</SUB><I><SUB> layer</SUB></I> / <A HREF = "#dlayer"> dlayer </A><I><SUB> layer</SUB></I><br>

air_dry = air_dry<SUB>(in mm)</SUB><I><SUB> layer</SUB></I> / <A HREF = "#dlayer"> dlayer </A><I><SUB> layer</SUB></I><br>

sw_errmargin = the assumed numerical precision for the value sw<br>

sat_errmargin = the assumed numerical precision for the value sat<br>

dul_errmargin = the assumed numerical precision for the value dul<br>

ll15_errmargin = the assumed numerical precision for the value ll15<br>

air_dry_errmargin = the assumed numerical precision for the value air_dry<br>

if (air_dry+air_dry_errmargin.<.min_sw) then<br>

<dl>write (to err_messg)  ' air dry lower limit of ' , air_dry , ' in layer ' , layer , new_line , '         is below acceptable value of ' , min_sw<br>

Print a warning error<br>

</dl>else<br>

endif<br>

if (ll15+ll15_errmargin.<.air_dry-air_dry_errmargin) then<br>

<dl>write (to err_messg)  ' 15 bar lower limit of ' , ll15 , ' in layer ' , layer , new_line , '         is below air dry value of ' , air_dry<br>

Print a warning error<br>

</dl>else<br>

endif<br>

if (dul+dul_errmargin.<=.ll15-ll15_errmargin) then<br>

<dl>write (to err_messg)  ' drained upper limit of ' , dul , ' in layer ' , layer , new_line , '         is at or below lower limit of ' , ll15<br>

Print a warning error<br>

</dl>else<br>

endif<br>

if (sat+sat_errmargin.<=.dul-dul_errmargin) then<br>

<dl>write (to err_messg)  ' saturation of ' , sat , ' in layer ' , layer , new_line , '         is at or below drained upper limit of ' , dul<br>

Print a warning error<br>

</dl>else<br>

endif<br>

if (sat-sat_errmargin.>.max_sw+max_sw_margin) then<br>

<dl>write (to err_messg)  ' saturation of ' , sat , ' in layer ' , layer , new_line , '         is above acceptable value of ' , max_sw , new_line , 'you must adjust bulk density (bd ) to below) , (1.0-sat) * <A HREF = "#specific_bd"> specific_bd </A> , new_line , 'or saturation (sat ) to below) , max_sw<br>

Print a warning error<br>

</dl>else<br>

endif<br>

if (sw-sw_errmargin.>.sat+sat_errmargin) then<br>

<dl>write (to err_messg)  ' soil water of ' , sw , ' in layer ' , layer , new_line , '         is above saturation of ' , sat<br>

Print a warning error<br>

</dl>else<br>

endif<br>

if (sw+sw_errmargin.<.air_dry-air_dry_errmargin) then<br>

<dl>write (to err_messg)  ' soil water of ' , sw , ' in layer ' , layer , new_line , '         is below air-dry value of ' , air_dry<br>

Print a warning error<br>

</dl>else<br>

endif<br>

</dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<A NAME = "soilwat2_move_solute_up">  </A>
<H2>Soilwat2 Move Solute Up</H2>
<br>
<H3><CENTER><insert here>   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

number of layers = number of elements in <A HREF = "#dlayer"> dlayer </A><br>

For each solnum from 1 to number ofsolutes<br>

<dl>mobile_no = position of solute_names<I><SUB> solnum</SUB></I> in the list <A HREF = "#mobile_solutes"> mobile_solutes </A><br>

if (mobile_no.=/=.0) then<br>

<dl>For each layer from 1 to maximum number of layers<br>

<dl>temp_solute<I><SUB> layer</SUB></I> = solute<I><SUB> solnum, layer</SUB></I><br>

leach<I><SUB> layer</SUB></I> = 0 . 0<br>

temp_solute_min<I><SUB> layer</SUB></I> = solute_min<I><SUB> solnum, layer</SUB></I><br>

temp<FONT FACE = "SYMBOL">D</FONT>solute<I><SUB> layer</SUB></I> = <FONT FACE = "SYMBOL">D</FONT>solute<I><SUB> solnum, layer</SUB></I><br>

</dl>next<br>

<A HREF = "#soilwat2_solute_flow"> Calculate the Solute Movement with Unsaturated Water Flow </A><br>

Move amounts leach up array temp_solute<br>

Move amounts leach up array temp<FONT FACE = "SYMBOL">D</FONT>solute<br>

For each layer from 1 to maximum number of layers<br>

<dl>solute<I><SUB> solnum, layer</SUB></I> = temp_solute<I><SUB> layer</SUB></I><br>

solute_up<I><SUB> solnum, layer</SUB></I> = leach<I><SUB> layer</SUB></I><br>

<FONT FACE = "SYMBOL">D</FONT>solute<I><SUB> solnum, layer</SUB></I> = temp<FONT FACE = "SYMBOL">D</FONT>solute<I><SUB> layer</SUB></I><br>

</dl>next<br>

</dl>else<br>

endif<br>

</dl>next<br>

<br>

</dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<A NAME = "soilwat2_solute_flow">  </A>
<H2>Soilwat2 Solute Flow</H2>
<br>
<H3><CENTER>movement of solute in response to differences in water content of adjacent soil layers when the soil water content is < the drained upper limit (unsaturated flow)   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

Fill solute_up with 0 . 0<br>

number of layers = number of elements in <A HREF = "#dlayer"> dlayer </A><br>

in_solute = 0 . 0<br>

For each layer from number of layers to 2 stepping by -1<br>

<dl>solute_up<I><SUB> layer</SUB></I> = in_solute<br>

out_w = flow<I><SUB> layer - 1</SUB></I><br>

if (out_w.<=.0.0) then<br>

<dl>out_solute = 0 . 0<br>

</dl>else<br>

<dl>bottomw = flow<I><SUB> layer</SUB></I><br>

solute_kg_layer = solute_kg<I><SUB> layer</SUB></I> + in_solute<br>

water = sw<SUB>(in mm)</SUB><I><SUB> layer</SUB></I> + out_w - bottomw<br>

out_solute = solute_kg_layer * out_w / water * <A HREF = "#solute_flow_eff"> solute_flow_eff </A><br>

out_solute = out_solute constrained between 0 . 0 and solute_kg_layer - solute_min<I><SUB> layer</SUB></I><br>

</dl>endif<br>

in_solute = out_solute<br>

solute_up<I><SUB> 1</SUB></I> = in_solute<br>

remain<I><SUB> 1</SUB></I> = solute_up<I><SUB> 1</SUB></I><br>

For each layer from 2 to number of layers<br>

<dl>remain<I><SUB> layer</SUB></I> = solute_up<I><SUB> layer</SUB></I> - solute_up<I><SUB> layer - 1</SUB></I><br>

Fill solute_down with 0 . 0<br>

in_solute = 0 . 0<br>

top_w = 0 . 0<br>

For each layer from 1 to number of layers<br>

<dl>out_w = - flow<I><SUB> layer</SUB></I><br>

if (out_w.<=.0.0) then<br>

<dl>out_solute = 0 . 0<br>

</dl>else<br>

<dl>solute_kg_layer = solute_kg<I><SUB> layer</SUB></I> + in_solute + remain<I><SUB> layer</SUB></I><br>

water = sw<SUB>(in mm)</SUB><I><SUB> layer</SUB></I> + out_w - top_w<br>

out_solute = solute_kg_layer * out_w / water * <A HREF = "#solute_flow_eff"> solute_flow_eff </A><br>

out_solute = out_solute constrained between 0 . 0 and solute_kg_layer - solute_min<I><SUB> layer</SUB></I><br>

</dl>endif<br>

solute_down<I><SUB> layer</SUB></I> = out_solute<br>

in_solute = out_solute<br>

top_w = out_w<br>

For each layer from 1 to number of layers<br>

<dl>solute_up<I><SUB> layer</SUB></I> = solute_up<I><SUB> layer</SUB></I> - solute_down<I><SUB> layer</SUB></I><br>

<br>

</dl></dl></dl></dl></dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<H2><BIG><A NAME = "Add Water"> Add Water </A></BIG></H2>
<A NAME = "soilwat2_add_water">  </A>
<H2>Soilwat2 Add Water</H2>
<br>
<H3><CENTER><insert here>   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

Get amount from the message (Lower Bound = 0 . 0, Upper Bound = 1000 .)<br>

irrigation = irrigation + amount<br>

For each solnum from 1 to number ofirrigation_solutes<br>

<dl>Get solconc from the message (Lower Bound = 0 . 0, Upper Bound = 1000 .)<I>(OPTIONAL)</I><br>

if (number of values returned.>.0) then<br>

<dl>irrigation_solute<I><SUB> solnum</SUB></I> = irrigation_solute<I><SUB> solnum</SUB></I> + solconc<br>

</dl>else<br>

endif<br>

</dl>next<br>

<br>

</dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<H2><BIG><A NAME = "Tillage"> Tillage </A></BIG></H2>
<A NAME = "soilwat2_tillage">  </A>
<H2>Soilwat2 Tillage</H2>
<br>
<H3><CENTER>Set up for CN reduction after tillage operation   </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

Get type from the message<br>

Get tillage_cn_red from the message (Lower Bound = 0 . 0, Upper Bound = 100 . 0)<I>(OPTIONAL)</I><br>

Get tillage_cn_rain from the message (Lower Bound = 0 . 0, Upper Bound = 1000 . 0)<I>(OPTIONAL)</I><br>

if (number of values returned_cnred.<=.0.or.number of values returned_cnrain.<=.0) then<br>

<dl>Write a string to a file<br>

Read type_info from file (Lower Bound = number of values returned, Upper Bound = 0 . 0) <I>(OPTIONAL)</I><br>

if (number of values returned.=/=.2) then<br>

<dl>tillage_cn_red = 0 . 0<br>

tillage_cn_rain = 0 . 0<br>

string = 'cannot find info for tillage:- ' / / type<br>

Report a fatal error<br>

</dl>else<br>

<dl>if (number of values returned_cnred.<=.0) then<br>

<dl>tillage_cn_red = type_info<I><SUB> 1</SUB></I><br>

</dl>else<br>

endif<br>

if (number of values returned_cnrain.<=.0) then<br>

<dl>tillage_cn_rain = type_info<I><SUB> 2</SUB></I><br>

</dl>else<br>

endif<br>

</dl>endif<br>

</dl>endif<br>

tillage_cn_red = tillage_cn_red constrained between 0 . 0 and <A HREF = "#cn2_bare"> cn2_bare </A><br>

write (to string)  'soil tilled using ' , type , new_line , 'cn reduction = ' , tillage_cn_red , new_line , 'acc rain     = ' , tillage_cn_rain<br>

Report this event to the system<br>

tillage_rain_sum = 0 . 0<br>

<br>

</dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<TABLE WIDTH = 100% ALIGN=center BORDER=1><CAPTION><H1><A NAME = "standard.soilwat2.constants"> Standard Constants </A></H1></CAPTION><TD><B>Parameter</B></TD><TD><B>Description</B></TD><TD><B>Specification</B></TD><TD><B>Usage</B></TD><TR><TD VALIGN=TOP><A NAME = "min_crit_temp"> min_crit_temp </A></TD><TD> temperature below which eeq decreases (oC)</TD><TD> 5.0  (oC)</TD><TD><A HREF = "#soilwat2_eeq_fac"> soilwat2_eeq_fac </A> , <A HREF = "#soilwat2_read_constants"> soilwat2_read_constants </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "max_crit_temp"> max_crit_temp </A></TD><TD> temperature above which eeq increases (oC)</TD><TD> 35.0  (oC)</TD><TD><A HREF = "#soilwat2_eeq_fac"> soilwat2_eeq_fac </A> , <A HREF = "#soilwat2_read_constants"> soilwat2_read_constants </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "max_albedo"> max_albedo </A></TD><TD> albedo at 100% green crop cover (0-1). Bare soil albedo must not exceed this value.</TD><TD> 0.23  ()</TD><TD><A HREF = "#soilwat2_priestly_taylor"> soilwat2_priestly_taylor </A> , <A HREF = "#soilwat2_read_constants"> soilwat2_read_constants </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "a_to_evap_fact"> a_to_evap_fact </A></TD><TD> converts residue specfic area "A" to a coef. in exp effect on reducing pot. soil evap for wt. of mixed residues. 0.44 = 0.00022/0.0005 DMS 1st approx. 6/95</TD><TD> 0.44       ()</TD><TD><A HREF = "#soilwat2_pot_soil_evaporation"> soilwat2_pot_soil_evaporation </A> , <A HREF = "#soilwat2_read_constants"> soilwat2_read_constants </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "canopy_eos_coef"> canopy_eos_coef </A></TD><TD> coef. in exp effect of canopy on reducing pot. soil evap. = 1.7 Adams, Arkin & Ritchie 1976</TD><TD> 1.7        ()</TD><TD><A HREF = "#soilwat2_pot_soil_evaporation"> soilwat2_pot_soil_evaporation </A> , <A HREF = "#soilwat2_read_constants"> soilwat2_read_constants </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "sw_top_crit"> sw_top_crit </A></TD><TD> critical sw ratio in top layer below which stage 2 evaporation occurs</TD><TD> 0.9  ()</TD><TD><A HREF = "#soilwat2_read_constants"> soilwat2_read_constants </A> , <A HREF = "#soilwat2_ritchie_init"> soilwat2_ritchie_init </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "sumes1_max"> sumes1_max </A></TD><TD> upper limit of sumes1</TD><TD> 100.0  (mm)</TD><TD><A HREF = "#soilwat2_read_constants"> soilwat2_read_constants </A> , <A HREF = "#soilwat2_ritchie_init"> soilwat2_ritchie_init </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "sumes2_max"> sumes2_max </A></TD><TD> upper limit of sumes2</TD><TD> 25.0  (mm)</TD><TD><A HREF = "#soilwat2_read_constants"> soilwat2_read_constants </A> , <A HREF = "#soilwat2_ritchie_init"> soilwat2_ritchie_init </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "solute_flow_eff"> solute_flow_eff </A></TD><TD> efficiency of moving solute with flow (0-1)</TD><TD> 0.5  ()</TD><TD><A HREF = "#soilwat2_read_constants"> soilwat2_read_constants </A> , <A HREF = "#soilwat2_solute_flow"> soilwat2_solute_flow </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "solute_flux_eff"> solute_flux_eff </A></TD><TD> efficiency of moving solute with flux (0-1)</TD><TD> 0.5  ()</TD><TD><A HREF = "#soilwat2_read_constants"> soilwat2_read_constants </A> , <A HREF = "#soilwat2_solute_flux"> soilwat2_solute_flux </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "gravity_gradient"> gravity_gradient </A></TD><TD> soil water gradient due to gravitational pressure head</TD><TD> 0.00002  ()</TD><TD><A HREF = "#soilwat2_unsat_flow"> soilwat2_unsat_flow </A> , <A HREF = "#soilwat2_read_constants"> soilwat2_read_constants </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "specific_bd"> specific_bd </A></TD><TD> specific bulk density</TD><TD> 2.65  (g/cc)</TD><TD><A HREF = "#soilwat2_check_profile"> soilwat2_check_profile </A> , <A HREF = "#soilwat2_read_constants"> soilwat2_read_constants </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "hydrol_effective_depth"> hydrol_effective_depth </A></TD><TD></TD><TD> 450  (mm)</TD><TD><A HREF = "#soilwat2_read_constants"> soilwat2_read_constants </A> , <A HREF = "#soilwat2_sum_report"> soilwat2_sum_report </A> , <A HREF = "#soilwat2_runoff_depth_factor"> soilwat2_runoff_depth_factor </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "mobile_solutes"> mobile_solutes </A></TD><TD></TD><TD> no3 urea cl br org_n org_c ()</TD><TD><A HREF = "#soilwat2_read_constants"> soilwat2_read_constants </A> , <A HREF = "#soilwat2_solute_init"> soilwat2_solute_init </A> , <A HREF = "#soilwat2_move_solute_down"> soilwat2_move_solute_down </A> , <A HREF = "#soilwat2_move_solute_up"> soilwat2_move_solute_up </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "immobile_solutes"> immobile_solutes </A></TD><TD></TD><TD> nh4 ()</TD><TD><A HREF = "#soilwat2_read_constants"> soilwat2_read_constants </A> , <A HREF = "#soilwat2_solute_init"> soilwat2_solute_init </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "canopy_fact"> canopy_fact </A></TD><TD></TD><TD>        1.0  1.0  0.0  0.0   ()</TD><TD><A HREF = "#soilwat2_runoff_cover"> soilwat2_runoff_cover </A> , <A HREF = "#soilwat2_read_constants"> soilwat2_read_constants </A> , <A HREF = "#soilwat2_zero_variables"> soilwat2_zero_variables </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "canopy_fact_height"> canopy_fact_height </A></TD><TD></TD><TD>   0  600  1800 30000  (mm)</TD><TD><A HREF = "#soilwat2_runoff_cover"> soilwat2_runoff_cover </A> , <A HREF = "#soilwat2_read_constants"> soilwat2_read_constants </A> , <A HREF = "#soilwat2_zero_variables"> soilwat2_zero_variables </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "canopy_fact_default"> canopy_fact_default </A></TD><TD> canopy factor to use if height is missing</TD><TD> 0.5  ()</TD><TD><A HREF = "#soilwat2_runoff_cover"> soilwat2_runoff_cover </A> , <A HREF = "#soilwat2_read_constants"> soilwat2_read_constants </A> , <A HREF = "#soilwat2_zero_variables"> soilwat2_zero_variables </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "act_evap_method"> act_evap_method </A></TD><TD></TD><TD> ritchie act_evap_method = rickert act_evap_method = bs_a act_evap_method = bs_b ()</TD><TD></TD></TR>

</TABLE>
<br>
<TABLE WIDTH = 100% ALIGN=center BORDER=1><CAPTION><H1><A NAME = "standard.soilwat2.tillage"> Standard Tillage </A></H1></CAPTION><TD><B>Parameter</B></TD><TD><B>Description</B></TD><TD><B>Specification</B></TD><TD><B>Usage</B></TD><TR><TD VALIGN=TOP><A NAME = "chisel"> chisel </A></TD><TD> will have no effect - SOILWAT the same as old ver.</TD><TD>      0.0           0.    ()</TD><TD></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "disc"> disc </A></TD><TD></TD><TD>      0.0           0. ()</TD><TD></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "planter"> planter </A></TD><TD></TD><TD>      0.0           0. ()</TD><TD></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "burn"> burn </A></TD><TD></TD><TD>      0.0           0. ()</TD><TD></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "">  </A></TD><TD></TD><TD> ()</TD><TD></TD></TR>

</TABLE>
<br>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<br>
<A NAME = "Contact Information"> <H2>Contact Information</H2> </A>
For Further Information Please Contact:
<p>
<A HREF = "mailto:SilburM@dpi.qld.gov.au"> Mark Silburn - Module Developer </A><br>
<A HREF = "mailto:APSIM-help@tag.csiro.au"> APSIM Help Desk </A><br>
<A HREF = "http:\\apsim-help.tag.csiro.au"> APSIM Help WEB Page </A><br>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage Express 2.0">
<title></title>
</head>

<body>

<p><img src="..\..\..\docs\shared\apsimdocumentationbanner.jpg" width="640"
height="73"></p>
</body>
</html>
Date: 3/12/98  APseudo Version:  1. 0 Rev.  0<br>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
