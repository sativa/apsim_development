<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage Express 2.0">
<title></title>
</head>

<body>

<p><img src="..\..\..\docs\shared\apsimdocumentationbanner.jpg" width="640"
height="73"></p>
</body>
</html>
<TITLE>The APSIM SoilP Model</TITLE>
<FONT SIZE = 7><B><CENTER>The APSIM SoilP Model</CENTER></B></FONT>
<H1>TABLE OF CONTENTS</H1>
<H2><A HREF = "#Contact Information"> Contact Information </A></H2>
<H2><A HREF = "#Module Description"> Module Description </A></H2>
<H2>User Input Files</H2>
<ul><li>The Constants File

<ul><li><A HREF = "#standard.soilp.constants"> standard constants </A>

</ul></ul>
<H2>Module Logic</H2>
<ul><li><A HREF = "#SoilP timestep calculations"> SoilP timestep calculations </A>

<li><A HREF = "#Decompose residues"> Decompose residues </A>

<li><A HREF = "#Incorporate fresh organic matter"> Incorporate fresh organic matter </A>

<li><A HREF = "#Tillage"> Tillage </A>

<li><A HREF = "#Structure Charts"> Structure Charts </A>

</ul>
<hr>
<A NAME = "Module Description">  </A>
<H2>Module Documentation</H2>
<br>
<A HREF = "soilp_int.pdf"> Interface document </A>
<br>
<A HREF = "soilp_science.pdf"> Science document </A>
<br>
<hr>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<A NAME = "Structure Charts"> <H2>Module Structure Charts</H2> </A>
<H2>SoilP timestep calculations</H2>
<ul><li><A HREF = "#soilp_process"> soilp_process </A>

<ul><li><A HREF = "#soilp_availability_loss"> soilp_availability_loss </A>

<ul><li><A HREF = "#soilp_wf"> soilp_wf </A>

<li><A HREF = "#soilp_bound_check"> soilp_bound_check </A>

</ul><li><A HREF = "#soilp_rock_p_dissolution"> soilp_rock_p_dissolution </A>

<ul><li><A HREF = "#soilp_bound_check"> soilp_bound_check </A>

</ul><li><A HREF = "#soilp_decrease_banded_p_effect"> soilp_decrease_banded_p_effect </A>

<ul><li><A HREF = "#soilp_bound_check"> soilp_bound_check </A>

</ul><li><A HREF = "#soilp_min_hum"> soilp_min_hum </A>

<li><A HREF = "#soilp_min_biom"> soilp_min_biom </A>

<li><A HREF = "#soilp_min_fom"> soilp_min_fom </A>

<li><A HREF = "#soilp_find_crops"> soilp_find_crops </A>

<li><A HREF = "#soilp_get_crop_variables"> soilp_get_crop_variables </A>

<li><A HREF = "#soilp_crop_p_uptake"> soilp_crop_p_uptake </A>

<ul><li><A HREF = "#soilp_sorption_fn"> soilp_sorption_fn </A>

<li><A HREF = "#soilp_root_fac"> soilp_root_fac </A>

<li><A HREF = "#soilp_sw_fn"> soilp_sw_fn </A>

<li><A HREF = "#soilp_bound_check"> soilp_bound_check </A>

</ul></ul></ul>
<H2>Decompose residues</H2>
<ul><li><A HREF = "#soilp_min_residues"> soilp_min_residues </A>

<ul><li><A HREF = "#soilp_bound_check"> soilp_bound_check </A>

</ul></ul>
<H2>Incorporate fresh organic matter</H2>
<ul><li><A HREF = "#soilp_incorp_residues"> soilp_incorp_residues </A>

<ul><li><A HREF = "#soilp_bound_check"> soilp_bound_check </A>

</ul></ul>
<H2>Tillage</H2>
<ul><li><A HREF = "#soilp_tillage"> soilp_tillage </A>

<ul><li><A HREF = "#soilp_redistribute_p"> soilp_redistribute_p </A>

</ul></ul>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<CENTER><A NAME = "Module Pseudo Code"> <H2><BIG>Module Pseudo Code</BIG></H2> </A></CENTER>
<hr>
<H2><BIG><A NAME = "SoilP timestep calculations"> SoilP timestep calculations </A></BIG></H2>
<A NAME = "soilp_process">  </A>
<H2>Soilp Process</H2>
<br>
<H3><CENTER>Calculates changes in soil P. Processes considered are: - loss of available P - dissolution of a non water soluble source - loss of effectiveness of banded P fertilizer - organic P transformations - addition of P from residues including roots - P uptake by crops  </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

<A HREF = "#soilp_availability_loss"> Change P availability </A><br>

<A HREF = "#soilp_rock_p_dissolution"> Release labile P from non-water soluble source </A><br>

<A HREF = "#soilp_decrease_banded_p_effect"> Decrease effectiveness of banded P </A><br>

<A HREF = "#soilp_min_hum"> Mineralise P from humic pool </A><br>

<A HREF = "#soilp_min_biom"> Mineralise P from biom pool </A><br>

<A HREF = "#soilp_min_fom"> Mineralise P from fom pool </A><br>

<A HREF = "#soilp_find_crops"> Find crops in the system </A><br>

<A HREF = "#soilp_get_crop_variables"> Request variables from crops </A><br>

<A HREF = "#soilp_crop_p_uptake"> Uptake P for each crop </A><br>

<br>

</dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<A NAME = "soilp_availability_loss">  </A>
<H2>Soilp Availability Loss</H2>
<br>
<H3><CENTER>Calculate changes in P availability. Transformation of labile P to unavailable P assumed to depend on temperature (defined in terms of activation energy, after Barrow) and soil moisture Both labile P and banded P are affected by loss in availability. Reverse process converts unavailable P to labile P assuming rate constants are in ratio of availP_ratio  </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

number of layers = number of elements in dlayer<br>

For each layer from 1 to number of layers<br>

<dl>adj_rate_loss_avail_p = <A HREF = "#rate_loss_avail_p"> rate_loss_avail_p </A> * <I><BIG>e</BIG></I><SUP><A HREF = "#act_energy_loss_avail_p"> act_energy_loss_avail_p </A> * 1000 . 0 / 8 . 314 * ((1.0/298.0)-(1.0/(273.0+soil_t<I><SUB> layer</SUB></I>)))</SUP><br>

wf = <A HREF = "#soilp_wf"> Loss of availability water factor for layer </A><br>

flux_p1 = labile_p<I><SUB> layer</SUB></I> * wf * adj_rate_loss_avail_p<br>

flux_p2 = banded_p<I><SUB> layer</SUB></I> * wf * adj_rate_loss_avail_p<br>

flux_p3 = unavail_p<I><SUB> layer</SUB></I> * wf * adj_rate_loss_avail_p * <A HREF = "#availp_ratio"> availp_ratio </A><br>

unavail_p<I><SUB> layer</SUB></I> = unavail_p<I><SUB> layer</SUB></I> + flux_p1 + flux_p2 - flux_p3<br>

labile_p<I><SUB> layer</SUB></I> = labile_p<I><SUB> layer</SUB></I> - flux_p1 + flux_p3<br>

banded_p<I><SUB> layer</SUB></I> = banded_p<I><SUB> layer</SUB></I> - flux_p2<br>

</dl>next<br>

<A HREF = "#soilp_bound_check"> Check P pools </A><br>

<br>

</dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<A NAME = "soilp_wf">  </A>
<H2>Soilp Wf</H2>
<br>
<H3><CENTER>Calculates a 0-1 water factor for loss of availability.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

if (sw<SUB>(in mm)</SUB><I><SUB> layer</SUB></I>.>.dul<SUB>(in mm)</SUB><I><SUB> layer</SUB></I>) then<br>

<dl>wfd = 1 . 0 + sw<SUB>(in mm)</SUB><I><SUB> layer</SUB></I> - dul<SUB>(in mm)</SUB><I><SUB> layer</SUB></I> / sat<SUB>(in mm)</SUB><I><SUB> layer</SUB></I> - dul<SUB>(in mm)</SUB><I><SUB> layer</SUB></I><br>

wfd = wfd constrained between 1 . 0 and 2 . 0<br>

</dl>else<br>

<dl>wfd = sw<SUB>(in mm)</SUB><I><SUB> layer</SUB></I> - ll15<SUB>(in mm)</SUB><I><SUB> layer</SUB></I> / (dul<SUB>(in mm)</SUB><I><SUB> layer</SUB></I>-ll15<SUB>(in mm)</SUB><I><SUB> layer</SUB></I>)<br>

wfd = wfd constrained between 0 . 0 and 1 . 0<br>

</dl>endif<br>

soilp_wf = A linearly interpolated value based upon wfd (where X = <A HREF = "#wf_loss_index"> wf_loss_index </A>, Y = <A HREF = "#wf_loss_values"> wf_loss_values </A>)..<br>

<br>

</dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<A NAME = "soilp_bound_check">  </A>
<H2>Soilp Bound Check</H2>
<br>
<H3><CENTER>Bound check all P pools  </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

Check that all labile_p lies between <A HREF = "#lb_labile_p"> lb_labile_p </A> and <A HREF = "#ub_labile_p"> ub_labile_p </A><br>

Check that all banded_p lies between <A HREF = "#lb_banded_p"> lb_banded_p </A> and <A HREF = "#ub_banded_p"> ub_banded_p </A><br>

Check that all rock_p lies between <A HREF = "#lb_rock_p"> lb_rock_p </A> and <A HREF = "#ub_rock_p"> ub_rock_p </A><br>

Check that all unavail_p lies between <A HREF = "#lb_unavail_p"> lb_unavail_p </A> and <A HREF = "#ub_unavail_p"> ub_unavail_p </A><br>

<br>

</dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<A NAME = "soilp_rock_p_dissolution">  </A>
<H2>Soilp Rock P Dissolution</H2>
<br>
<H3><CENTER>Describes release of Labile P from a non-water soluble source.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

number of layers = number of elements in dlayer<br>

For each layer from 1 to number of layers<br>

<dl>flux_p = rock_p<I><SUB> layer</SUB></I> * <A HREF = "#rate_dissol_rock_p"> rate_dissol_rock_p </A><br>

labile_p<I><SUB> layer</SUB></I> = labile_p<I><SUB> layer</SUB></I> + flux_p<br>

rock_p<I><SUB> layer</SUB></I> = rock_p<I><SUB> layer</SUB></I> - flux_p<br>

</dl>next<br>

<A HREF = "#soilp_bound_check"> Check P pools </A><br>

<br>

</dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<A NAME = "soilp_decrease_banded_p_effect">  </A>
<H2>Soilp Decrease Banded P Effect</H2>
<br>
<H3><CENTER>Fertiliser effectiveness is higher when applied as a band than when broadcast.  However effect decreases with time. Tillage destroys any banding.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

number of layers = number of elements in dlayer<br>

For each layer from 1 to number of layers<br>

<dl>flux_p = banded_p<I><SUB> layer</SUB></I> * <A HREF = "#rate_decr_placement"> rate_decr_placement </A><br>

labile_p<I><SUB> layer</SUB></I> = labile_p<I><SUB> layer</SUB></I> + flux_p<br>

banded_p<I><SUB> layer</SUB></I> = banded_p<I><SUB> layer</SUB></I> - flux_p<br>

</dl>next<br>

<A HREF = "#soilp_bound_check"> Check P pools </A><br>

<br>

</dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<A NAME = "soilp_min_hum">  </A>
<H2>Soilp Min Hum</H2>
<br>
<H3><CENTER>Mineralise P from hum pool  </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

number of layers = number of elements in dlayer<br>

For each layer from 1 to number of layers<br>

<dl>tot_hum_c_decomposed = <FONT FACE = "SYMBOL">D</FONT>hum_c_atm<I><SUB> layer</SUB></I> + <FONT FACE = "SYMBOL">D</FONT>hum_c_biom<I><SUB> layer</SUB></I><br>

hum_p_decomposed = tot_hum_c_decomposed / <A HREF = "#hum_cp"> hum_cp </A><br>

min_p = hum_p_decomposed - <FONT FACE = "SYMBOL">D</FONT>hum_c_biom<I><SUB> layer</SUB></I> / <A HREF = "#biom_cp"> biom_cp </A><br>

hum_p<I><SUB> layer</SUB></I> = hum_p<I><SUB> layer</SUB></I> - hum_p_decomposed<br>

biom_p<I><SUB> layer</SUB></I> = biom_p<I><SUB> layer</SUB></I> + <FONT FACE = "SYMBOL">D</FONT>hum_c_biom<I><SUB> layer</SUB></I> / <A HREF = "#biom_cp"> biom_cp </A><br>

labile_p<I><SUB> layer</SUB></I> = labile_p<I><SUB> layer</SUB></I> + min_p<br>

</dl>next<br>

<br>

</dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<A NAME = "soilp_min_biom">  </A>
<H2>Soilp Min Biom</H2>
<br>
<H3><CENTER>Mineralise P from biom pool  </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

number of layers = number of elements in dlayer<br>

For each layer from 1 to number of layers<br>

<dl>tot_biom_c_decomposed = <FONT FACE = "SYMBOL">D</FONT>biom_c_atm<I><SUB> layer</SUB></I> + <FONT FACE = "SYMBOL">D</FONT>biom_c_hum<I><SUB> layer</SUB></I><br>

biom_p_decomposed = tot_biom_c_decomposed / <A HREF = "#biom_cp"> biom_cp </A><br>

min_p = biom_p_decomposed - <FONT FACE = "SYMBOL">D</FONT>biom_c_hum<I><SUB> layer</SUB></I> / <A HREF = "#hum_cp"> hum_cp </A><br>

biom_p<I><SUB> layer</SUB></I> = biom_p<I><SUB> layer</SUB></I> - biom_p_decomposed<br>

hum_p<I><SUB> layer</SUB></I> = hum_p<I><SUB> layer</SUB></I> + <FONT FACE = "SYMBOL">D</FONT>biom_c_hum<I><SUB> layer</SUB></I> / <A HREF = "#hum_cp"> hum_cp </A><br>

labile_p<I><SUB> layer</SUB></I> = labile_p<I><SUB> layer</SUB></I> + min_p<br>

</dl>next<br>

<br>

</dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<A NAME = "soilp_min_fom">  </A>
<H2>Soilp Min Fom</H2>
<br>
<H3><CENTER>Mineralise P from fom pool  </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

number of layers = number of elements in dlayer<br>

For each layer from 1 to number of layers<br>

<dl>tot_fom_c_decomposed = <FONT FACE = "SYMBOL">D</FONT>fom_c_atm<I><SUB> layer</SUB></I> + <FONT FACE = "SYMBOL">D</FONT>fom_c_biom<I><SUB> layer</SUB></I> + <FONT FACE = "SYMBOL">D</FONT>fom_c_hum<I><SUB> layer</SUB></I><br>

fom_p_decomposed = tot_fom_c_decomposed / fom_cp<I><SUB> layer</SUB></I><br>

min_p = fom_p_decomposed - <FONT FACE = "SYMBOL">D</FONT>fom_c_biom<I><SUB> layer</SUB></I> / <A HREF = "#biom_cp"> biom_cp </A> - <FONT FACE = "SYMBOL">D</FONT>fom_c_hum<I><SUB> layer</SUB></I> / <A HREF = "#hum_cp"> hum_cp </A><br>

fom_p<I><SUB> layer</SUB></I> = fom_p<I><SUB> layer</SUB></I> - fom_p_decomposed<br>

hum_p<I><SUB> layer</SUB></I> = hum_p<I><SUB> layer</SUB></I> + <FONT FACE = "SYMBOL">D</FONT>fom_c_hum<I><SUB> layer</SUB></I> / <A HREF = "#hum_cp"> hum_cp </A><br>

biom_p<I><SUB> layer</SUB></I> = biom_p<I><SUB> layer</SUB></I> + <FONT FACE = "SYMBOL">D</FONT>fom_c_biom<I><SUB> layer</SUB></I> / <A HREF = "#biom_cp"> biom_cp </A><br>

labile_p<I><SUB> layer</SUB></I> = labile_p<I><SUB> layer</SUB></I> + min_p<br>

</dl>next<br>

<br>

</dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<A NAME = "soilp_find_crops">  </A>
<H2>Soilp Find Crops</H2>
<br>
<H3><CENTER>Find all crops in the system.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

request_no = 0<br>

number ofcrops = 0<br>

</dl>next<br>

request_no = request_no + 1<br>

Get next crpname from the system<br>

if (number of values returned.=.0) then<br>

<dl>goto 999<br>

</dl>else<br>

<dl>if (number ofcrops.<.max_crops) then<br>

<dl>get_posting_module<I><SUB> owner_module</SUB></I><br>

number ofcrops = number ofcrops + 1<br>

crop_names<I><SUB> number ofcrops</SUB></I> = crpname<br>

crop_owners<I><SUB> number ofcrops</SUB></I> = owner_module<br>

</dl>else<br>

<dl>Report a fatal error<br>

</dl>endif<br>

</dl>endif<br>

goto 10<br>

</dl>next<br>

nveg = number ofcrops<br>

<br>

</dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<A NAME = "soilp_get_crop_variables">  </A>
<H2>Soilp Get Crop Variables</H2>
<br>
<H3><CENTER>Get crop variables from crop modules.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

For each vegnum from 1 to number ofcrops<br>

<dl>Fill rlv with 0 . 0<br>

if (position of crop_names<I><SUB> vegnum</SUB></I> in the list <A HREF = "#crop_table_name"> crop_table_name </A>.=.0.0) then<br>

<dl>Report a fatal error<br>

</dl>else<br>

<dl>Get rlv from the system (Lower Bound = 0 . 0, Upper Bound = 1 . 0)<br>

if (number of values returned.>.0) then<br>

<dl>For each layer from 1 to number of values returned<br>

<dl>rlv<I><SUB> vegnum, layer</SUB></I> = rlv<I><SUB> layer</SUB></I><br>

</dl>next<br>

</dl>else<br>

<dl>Report a fatal error<br>

</dl>endif<br>

Get crop_p_demand<I><SUB> vegnum</SUB></I> from the system (Lower Bound = 0 . 0, Upper Bound = 20 . 0)<br>

if (number of values returned.=.0) then<br>

<dl>Report a fatal error<br>

</dl>endif<br>

</dl>endif<br>

</dl>next<br>

<br>

</dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<A NAME = "soilp_crop_p_uptake">  </A>
<H2>Soilp Crop P Uptake</H2>
<br>
<H3><CENTER>Calculate Phosphorus uptake for each crop based on phosphorus status in each layer.  P status depends on labile p in soil and is modified by soil P sorption, roots and soil water content.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

number of layers = number of elements in dlayer<br>

For each crop from 1 to number ofcrops<br>

<dl>status_profile = 0 . 0<br>

For each layer from 1 to number of layers<br>

<dl>effective_p<I><SUB> layer</SUB></I> = labile_p<I><SUB> layer</SUB></I> + <A HREF = "#eff_band"> eff_band </A> * banded_p<I><SUB> layer</SUB></I><br>

status<I><SUB> layer</SUB></I> = effective_p<I><SUB> layer</SUB></I> * <A HREF = "#soilp_sorption_fn"> P sorption factor for layer </A> * <A HREF = "#soilp_root_fac"> Root factor for crop in layer </A> * <A HREF = "#soilp_sw_fn"> Water function in layer </A><br>

status_profile = status_profile + status<I><SUB> layer</SUB></I><br>

</dl>next<br>

crop_num = position of crop_names<I><SUB> crop</SUB></I> in the list <A HREF = "#crop_table_name"> crop_table_name </A><br>

uptake_p<SUB>(total)</SUB> = status_profile * <A HREF = "#crit_p_supply"> crit_p_supply </A><I><SUB> crop_num</SUB></I><br>

uptake_p<SUB>(total)</SUB> = uptake_p<SUB>(total)</SUB> constrained between 0 . 0 and crop_p_demand<I><SUB> crop</SUB></I><br>

For each layer from 1 to number of layers<br>

<dl>uptake_p_crop<I><SUB> crop, layer</SUB></I> = uptake_p<SUB>(total)</SUB> * status<I><SUB> layer</SUB></I> / status_profile<br>

fr_labile = labile_p<I><SUB> layer</SUB></I> / effective_p<I><SUB> layer</SUB></I><br>

labile_p<I><SUB> layer</SUB></I> = labile_p<I><SUB> layer</SUB></I> - uptake_p_crop<I><SUB> crop, layer</SUB></I> * fr_labile<br>

banded_p<I><SUB> layer</SUB></I> = banded_p<I><SUB> layer</SUB></I> - uptake_p_crop<I><SUB> crop, layer</SUB></I> * (1.0-fr_labile)<br>

</dl>next<br>

<A HREF = "#soilp_bound_check"> Check P pools </A><br>

</dl>next<br>

<br>

</dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<A NAME = "soilp_sorption_fn">  </A>
<H2>Soilp Sorption Fn</H2>
<br>
<H3><CENTER>Soil P sorption factor.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

soilp_sorption_fn = 1 . 0 / <A HREF = "#sorption"> sorption </A><I><SUB> layer</SUB></I><br>

<br>

</dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<A NAME = "soilp_root_fac">  </A>
<H2>Soilp Root Fac</H2>
<br>
<H3><CENTER>Crop root factor.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

crop_num = position of crop_names<I><SUB> crop</SUB></I> in the list <A HREF = "#crop_table_name"> crop_table_name </A><br>

soilp_root_fac = rlv<I><SUB> crop, layer</SUB></I> * 1 . 0 / <A HREF = "#crit_p_rlv"> crit_p_rlv </A><I><SUB> crop_num</SUB></I><br>

soilp_root_fac = soilp_root_fac constrained between 0 . 0 and 1 . 0<br>

<br>

</dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<A NAME = "soilp_sw_fn">  </A>
<H2>Soilp Sw Fn</H2>
<br>
<H3><CENTER>Soil water function.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

sw = sw<SUB>(in mm)</SUB><I><SUB> layer</SUB></I> / dlayer<I><SUB> layer</SUB></I><br>

ll = ll15<SUB>(in mm)</SUB><I><SUB> layer</SUB></I> / dlayer<I><SUB> layer</SUB></I><br>

dul = dul<SUB>(in mm)</SUB><I><SUB> layer</SUB></I> / dlayer<I><SUB> layer</SUB></I><br>

soilp_sw_fn = minimum of (sw * (sw-ll), dul * (dul-ll))<br>

soilp_sw_fn = soilp_sw_fn constrained above 0 . 0<br>

<br>

</dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<H2><BIG><A NAME = "Decompose residues"> Decompose residues </A></BIG></H2>
<A NAME = "soilp_min_residues">  </A>
<H2>Soilp Min Residues</H2>
<br>
<H3><CENTER>Mineralise P from fom pool  </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

<FONT FACE = "SYMBOL">D</FONT>res_c_atm = 0 . 0<br>

<FONT FACE = "SYMBOL">D</FONT>res_c_hum = 0 . 0<br>

<FONT FACE = "SYMBOL">D</FONT>res_c_biom = 0 . 0<br>

<FONT FACE = "SYMBOL">D</FONT>org_p = 0 . 0<br>

Get <FONT FACE = "SYMBOL">D</FONT>res_c_atm from the message (Lower Bound = 0 . 0, Upper Bound = 1000 . 0)<br>

Get <FONT FACE = "SYMBOL">D</FONT>res_c_hum from the message (Lower Bound = 0 . 0, Upper Bound = 1000 . 0)<br>

Get <FONT FACE = "SYMBOL">D</FONT>res_c_biom from the message (Lower Bound = 0 . 0, Upper Bound = 1000 . 0)<br>

Get <FONT FACE = "SYMBOL">D</FONT>org_p from the message (Lower Bound = 0 . 0, Upper Bound = 1000 . 0)<br>

number of layers = number of elements in <FONT FACE = "SYMBOL">D</FONT>res_c_biom<br>

res_p_decomposed = <FONT FACE = "SYMBOL">S</FONT><SUP>1</SUP><SUB>number of layers</SUB> <FONT FACE = "SYMBOL">D</FONT>org_p<br>

min_p = res_p_decomposed - <FONT FACE = "SYMBOL">S</FONT><SUP>1</SUP><SUB>number of layers</SUB> <FONT FACE = "SYMBOL">D</FONT>res_c_biom / <A HREF = "#biom_cp"> biom_cp </A> - <FONT FACE = "SYMBOL">S</FONT><SUP>1</SUP><SUB>number of layers</SUB> <FONT FACE = "SYMBOL">D</FONT>res_c_hum / <A HREF = "#hum_cp"> hum_cp </A><br>

For each layer from 1 to number of layers<br>

<dl>hum_p<I><SUB> layer</SUB></I> = hum_p<I><SUB> layer</SUB></I> + <FONT FACE = "SYMBOL">D</FONT>res_c_hum<I><SUB> layer</SUB></I> / <A HREF = "#hum_cp"> hum_cp </A><br>

biom_p<I><SUB> layer</SUB></I> = biom_p<I><SUB> layer</SUB></I> + <FONT FACE = "SYMBOL">D</FONT>res_c_biom<I><SUB> layer</SUB></I> / <A HREF = "#biom_cp"> biom_cp </A><br>

labile_p<I><SUB> layer</SUB></I> = labile_p<I><SUB> layer</SUB></I> + min_p * <FONT FACE = "SYMBOL">D</FONT>res_c_biom<I><SUB> layer</SUB></I> / <FONT FACE = "SYMBOL">S</FONT><SUP>1</SUP><SUB>number of layers</SUB> <FONT FACE = "SYMBOL">D</FONT>res_c_biom<br>

</dl>next<br>

<A HREF = "#soilp_bound_check"> Check P pools </A><br>

<br>

</dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<H2><BIG><A NAME = "Incorporate fresh organic matter"> Incorporate fresh organic matter </A></BIG></H2>
<A NAME = "soilp_incorp_residues">  </A>
<H2>Soilp Incorp Residues</H2>
<br>
<H3><CENTER>Transfers P from surface residues to fom pool. Presently assumes residues c:p is invariant.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

<FONT FACE = "SYMBOL">D</FONT>fom_incorp = 0 . 0<br>

<FONT FACE = "SYMBOL">D</FONT>fom_p_incorp = 0 . 0<br>

<FONT FACE = "SYMBOL">D</FONT>fom_cpr_incorp = 0 . 0<br>

<FONT FACE = "SYMBOL">D</FONT>labile_p = 0 . 0<br>

Get <FONT FACE = "SYMBOL">D</FONT>fom_incorp from the message (Lower Bound = 0 . 0, Upper Bound = 10000 . 0)<br>

Get <FONT FACE = "SYMBOL">D</FONT>fom_p_incorp from the message (Lower Bound = 0 . 0, Upper Bound = 10000 . 0)<I>(OPTIONAL)</I><br>

if (numval_p.=.0) then<br>

<dl>Get <FONT FACE = "SYMBOL">D</FONT>fom_cpr_incorp from the message (Lower Bound = 0 . 0, Upper Bound = 10000 . 0)<I>(OPTIONAL)</I><br>

For each layer from 1 to numval_cpr<br>

<dl><FONT FACE = "SYMBOL">D</FONT>fom_p_incorp<I><SUB> layer</SUB></I> = <FONT FACE = "SYMBOL">D</FONT>fom_incorp<I><SUB> layer</SUB></I> * residue_c_frac / <FONT FACE = "SYMBOL">D</FONT>fom_cpr_incorp<I><SUB> layer</SUB></I><br>

</dl>next<br>

</dl>else<br>

endif<br>

if (numval_p.=.0.and.numval_cpr.=.0) then<br>

<dl>For each layer from 1 to numval_cpr<br>

<dl><FONT FACE = "SYMBOL">D</FONT>fom_p_incorp<I><SUB> layer</SUB></I> = <FONT FACE = "SYMBOL">D</FONT>fom_incorp<I><SUB> layer</SUB></I> * residue_c_frac / <A HREF = "#root_cp"> root_cp </A><br>

</dl>next<br>

</dl>else<br>

endif<br>

For each layer from 1 to number of values returned<br>

<dl>fom_p<I><SUB> layer</SUB></I> = fom_p<I><SUB> layer</SUB></I> + <FONT FACE = "SYMBOL">D</FONT>fom_p_incorp<I><SUB> layer</SUB></I><br>

</dl>next<br>

Get <FONT FACE = "SYMBOL">D</FONT>labile_p from the message (Lower Bound = 0 . 0, Upper Bound = 10000 . 0)<I>(OPTIONAL)</I><br>

For each layer from 1 to numval_p<br>

<dl>labile_p<I><SUB> layer</SUB></I> = labile_p<I><SUB> layer</SUB></I> + <FONT FACE = "SYMBOL">D</FONT>labile_p<I><SUB> layer</SUB></I><br>

</dl>next<br>

<A HREF = "#soilp_bound_check"> Check P pools </A><br>

<br>

</dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<H2><BIG><A NAME = "Tillage"> Tillage </A></BIG></H2>
<A NAME = "soilp_tillage">  </A>
<H2>Soilp Tillage</H2>
<br>
<H3><CENTER>Capture tillage events to destroy banding.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

Get f_incorp from the message (Lower Bound = 0 . 0, Upper Bound = 1 . 0)<I>(OPTIONAL)</I><br>

if (number of values returned.=.0) then<br>

<dl>f_incorp = 1 . 0<br>

</dl>else<br>

endif<br>

Get tillage_depth from the message (Lower Bound = 0 . 0, Upper Bound = 1000 . 0)<I>(OPTIONAL)</I><br>

if (number of values returned.=.0) then<br>

<dl>tillage_depth = dlayer<I><SUB> 1</SUB></I><br>

</dl>else<br>

endif<br>

if ((tillage_depth.>.0.0).and.(f_incorp.>.0.0)) then<br>

<dl>number of layers = number of elements in dlayer<br>

tilled_layers = layer number corresponding to tillage_depth<br>

For each layer from 1 to tilled_layers<br>

<dl>labile_p<I><SUB> layer</SUB></I> = labile_p<I><SUB> layer</SUB></I> + banded_p<I><SUB> layer</SUB></I><br>

banded_p<I><SUB> layer</SUB></I> = 0 . 0<br>

</dl>next<br>

<A HREF = "#soilp_redistribute_p"> Redistribute labile_p over tillage_depth </A><br>

<A HREF = "#soilp_redistribute_p"> Redistribute rock_p over tillage_depth </A><br>

<A HREF = "#soilp_redistribute_p"> Redistribute effective_p over tillage_depth </A><br>

Check that all labile_p lies between 0 . 0 and 1000 . 0<br>

Report this event to the system<br>

</dl>else<br>

endif<br>

<br>

</dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<A NAME = "soilp_redistribute_p">  </A>
<H2>Soilp Redistribute P</H2>
<br>
<H3><CENTER>Evenly redistribute P to specified depth.  </CENTER></H3>
<H4>Subprogram Logic</H4>
<dl><br>

number of layers = number of elements in dlayer<br>

redistribute_layer = layer number corresponding to depth<br>

frac_bottom_layer = depth - <FONT FACE = "SYMBOL">S</FONT><SUP>1</SUP><SUB>redistribute_layer - 1</SUB> dlayer / dlayer<I><SUB> redistribute_layer</SUB></I><br>

redistributed_p = <FONT FACE = "SYMBOL">S</FONT><SUP>1</SUP><SUB>redistribute_layer</SUB> parray - (1.0-frac_bottom_layer) * parray<I><SUB> redistribute_layer</SUB></I><br>

if (redistribute_layer.>.1) then<br>

<dl>For each layer from 1 to redistribute_layer<br>

<dl>if (layer.=.redistribute_layer) then<br>

<dl>parray<I><SUB> layer</SUB></I> = (1.0-frac_bottom_layer) * parray<I><SUB> layer</SUB></I> + redistributed_p * dlayer<I><SUB> layer</SUB></I> * frac_bottom_layer / depth<br>

</dl>else<br>

<dl>parray<I><SUB> layer</SUB></I> = redistributed_p * dlayer<I><SUB> layer</SUB></I> / depth<br>

</dl>endif<br>

</dl>next<br>

</dl>else<br>

endif<br>

<br>

</dl></dl>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<TABLE WIDTH = 100% ALIGN=center BORDER=1><CAPTION><H1><A NAME = "standard.soilp.constants"> Standard Constants </A></H1></CAPTION><TD><B>Parameter</B></TD><TD><B>Description</B></TD><TD><B>Specification</B></TD><TD><B>Usage</B></TD><TR><TD VALIGN=TOP><A NAME = "rate_loss_avail_p"> rate_loss_avail_p </A></TD><TD> Fraction lost per yr (less then 1) specified at 25 oC</TD><TD>   0.30  ()</TD><TD><A HREF = "#soilp_zero_variables"> soilp_zero_variables </A> , <A HREF = "#soilp_read_constants"> soilp_read_constants </A> , <A HREF = "#soilp_availability_loss"> soilp_availability_loss </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "rate_decr_placement"> rate_decr_placement </A></TD><TD>0.5 ()   ! Fractional loss of placement effect per yr (less then 1)</TD><TD>  0.8    ()</TD><TD><A HREF = "#soilp_zero_variables"> soilp_zero_variables </A> , <A HREF = "#soilp_read_constants"> soilp_read_constants </A> , <A HREF = "#soilp_decrease_banded_p_effect"> soilp_decrease_banded_p_effect </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "act_energy_loss_avail_p"> act_energy_loss_avail_p </A></TD><TD> Effect of soil temperature on P availability</TD><TD>   90  (kJ/mole)</TD><TD><A HREF = "#soilp_zero_variables"> soilp_zero_variables </A> , <A HREF = "#soilp_read_constants"> soilp_read_constants </A> , <A HREF = "#soilp_availability_loss"> soilp_availability_loss </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "availp_ratio"> availp_ratio </A></TD><TD> Ratio of available P : unavailable P at a steady state</TD><TD>      0.1  ()</TD><TD><A HREF = "#soilp_zero_variables"> soilp_zero_variables </A> , <A HREF = "#soilp_read_param"> soilp_read_param </A> , <A HREF = "#soilp_read_constants"> soilp_read_constants </A> , <A HREF = "#soilp_availability_loss"> soilp_availability_loss </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "eff_band"> eff_band </A></TD><TD> Relative effectiveness of banded_p compared with broadcast_p</TD><TD>          3.0  ()</TD><TD><A HREF = "#soilp_zero_variables"> soilp_zero_variables </A> , <A HREF = "#soilp_read_constants"> soilp_read_constants </A> , <A HREF = "#soilp_crop_p_uptake"> soilp_crop_p_uptake </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "biom_cp"> biom_cp </A></TD><TD> c:p ratio of biom pool</TD><TD>          40.0  ()</TD><TD><A HREF = "#soilp_zero_variables"> soilp_zero_variables </A> , <A HREF = "#soilp_read_constants"> soilp_read_constants </A> , <A HREF = "#soilp_get_other_init_variables"> soilp_get_other_init_variables </A> , <A HREF = "#soilp_min_hum"> soilp_min_hum </A> , <A HREF = "#soilp_min_fom"> soilp_min_fom </A> , <A HREF = "#soilp_min_biom"> soilp_min_biom </A> , <A HREF = "#soilp_min_residues"> soilp_min_residues </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "hum_cp"> hum_cp </A></TD><TD> c:p ratio of hum pool</TD><TD>          100.0  ()</TD><TD><A HREF = "#soilp_zero_variables"> soilp_zero_variables </A> , <A HREF = "#soilp_read_constants"> soilp_read_constants </A> , <A HREF = "#soilp_get_other_init_variables"> soilp_get_other_init_variables </A> , <A HREF = "#soilp_min_hum"> soilp_min_hum </A> , <A HREF = "#soilp_min_fom"> soilp_min_fom </A> , <A HREF = "#soilp_min_biom"> soilp_min_biom </A> , <A HREF = "#soilp_min_residues"> soilp_min_residues </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "wf_loss_index"> wf_loss_index </A></TD><TD> index specifying water content for water factor for loss of availability</TD><TD>  0.0 0.5  1.0  2.0    ()</TD><TD><A HREF = "#soilp_zero_variables"> soilp_zero_variables </A> , <A HREF = "#soilp_read_constants"> soilp_read_constants </A> , <A HREF = "#soilp_wf"> soilp_wf </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "wf_loss_values"> wf_loss_values </A></TD><TD> value of water factor function at given index values</TD><TD>  0.6 1.0  1.0  1.0    ()</TD><TD><A HREF = "#soilp_zero_variables"> soilp_zero_variables </A> , <A HREF = "#soilp_read_constants"> soilp_read_constants </A> , <A HREF = "#soilp_wf"> soilp_wf </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "crop_name"> crop_name </A></TD><TD> name of crop</TD><TD>       maize  wheat  bananas  apples    ()</TD><TD></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "crit_p_supply"> crit_p_supply </A></TD><TD> factor to calc potential P supply from soil P status</TD><TD>   4.0      0.5     0.05    0.05      (??)</TD><TD><A HREF = "#soilp_zero_variables"> soilp_zero_variables </A> , <A HREF = "#soilp_read_constants"> soilp_read_constants </A> , <A HREF = "#soilp_crop_p_uptake"> soilp_crop_p_uptake </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "p_supply_factor"> p_supply_factor </A></TD><TD> factor to calc potential P supply from soil P status</TD><TD>   3.0      0.5     0.05    0.05      (??)</TD><TD></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "crit_p_rlv"> crit_p_rlv </A></TD><TD> critical P rlv</TD><TD>     .00001    .05     .05     0.05    (mm/mm^3)</TD><TD><A HREF = "#soilp_zero_variables"> soilp_zero_variables </A> , <A HREF = "#soilp_read_constants"> soilp_read_constants </A> , <A HREF = "#soilp_root_fac"> soilp_root_fac </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "lb_labile_p"> lb_labile_p </A></TD><TD></TD><TD>  0 ()</TD><TD><A HREF = "#soilp_zero_variables"> soilp_zero_variables </A> , <A HREF = "#soilp_read_param"> soilp_read_param </A> , <A HREF = "#soilp_read_constants"> soilp_read_constants </A> , <A HREF = "#soilp_bound_check"> soilp_bound_check </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "ub_labile_p"> ub_labile_p </A></TD><TD></TD><TD>  1000 ()</TD><TD><A HREF = "#soilp_zero_variables"> soilp_zero_variables </A> , <A HREF = "#soilp_read_param"> soilp_read_param </A> , <A HREF = "#soilp_read_constants"> soilp_read_constants </A> , <A HREF = "#soilp_bound_check"> soilp_bound_check </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "lb_unavail_p"> lb_unavail_p </A></TD><TD></TD><TD>  0 ()</TD><TD><A HREF = "#soilp_zero_variables"> soilp_zero_variables </A> , <A HREF = "#soilp_read_param"> soilp_read_param </A> , <A HREF = "#soilp_read_constants"> soilp_read_constants </A> , <A HREF = "#soilp_bound_check"> soilp_bound_check </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "ub_unavail_p"> ub_unavail_p </A></TD><TD></TD><TD>  10000 ()</TD><TD><A HREF = "#soilp_zero_variables"> soilp_zero_variables </A> , <A HREF = "#soilp_read_param"> soilp_read_param </A> , <A HREF = "#soilp_read_constants"> soilp_read_constants </A> , <A HREF = "#soilp_bound_check"> soilp_bound_check </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "lb_banded_p"> lb_banded_p </A></TD><TD></TD><TD>  0 ()</TD><TD><A HREF = "#soilp_zero_variables"> soilp_zero_variables </A> , <A HREF = "#soilp_read_param"> soilp_read_param </A> , <A HREF = "#soilp_read_constants"> soilp_read_constants </A> , <A HREF = "#soilp_bound_check"> soilp_bound_check </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "ub_banded_p"> ub_banded_p </A></TD><TD></TD><TD>  1000 ()</TD><TD><A HREF = "#soilp_zero_variables"> soilp_zero_variables </A> , <A HREF = "#soilp_read_param"> soilp_read_param </A> , <A HREF = "#soilp_read_constants"> soilp_read_constants </A> , <A HREF = "#soilp_bound_check"> soilp_bound_check </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "lb_rock_p"> lb_rock_p </A></TD><TD></TD><TD>  0 ()</TD><TD><A HREF = "#soilp_zero_variables"> soilp_zero_variables </A> , <A HREF = "#soilp_read_param"> soilp_read_param </A> , <A HREF = "#soilp_read_constants"> soilp_read_constants </A> , <A HREF = "#soilp_bound_check"> soilp_bound_check </A></TD></TR>

<TR><TD VALIGN=TOP><A NAME = "ub_rock_p"> ub_rock_p </A></TD><TD></TD><TD>  1000 ()</TD><TD><A HREF = "#soilp_zero_variables"> soilp_zero_variables </A> , <A HREF = "#soilp_read_param"> soilp_read_param </A> , <A HREF = "#soilp_read_constants"> soilp_read_constants </A> , <A HREF = "#soilp_bound_check"> soilp_bound_check </A></TD></TR>

</TABLE>
<br>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<br>
<A NAME = "Contact Information"> <H2>Contact Information</H2> </A>
For Further Information Please Contact:
<p>
<A HREF = "mailto:Merv.Probert@tag.csiro.au"> Merv Probert - Module Developer </A><br>
<A HREF = "mailto:APSIM-help@tag.csiro.au"> APSIM Help Desk </A><br>
<A HREF = "http:\\apsim-help.tag.csiro.au"> APSIM Help WEB Page </A><br>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage Express 2.0">
<title></title>
</head>

<body>

<p><img src="..\..\..\docs\shared\apsimdocumentationbanner.jpg" width="640"
height="73"></p>
</body>
</html>
Date: 3/12/98  APseudo Version:  1. 0 Rev.  0<br>
<html>
<body>
<p>
<MAP NAME="FrontPageMap0">
<AREA SHAPE="RECT" COORDS="513, 2, 635, 18" HREF="#Top">
<AREA SHAPE="RECT" COORDS="103, 4, 204, 18" HREF="#Structure Charts">
<AREA SHAPE="RECT" COORDS="14, 3, 76, 18" HREF="#Top">
</MAP>
<img src="..\..\..\docs\shared\apseudopagebreak.jpg" width="640" height="19" (5835 bytes)" border="0" usemap="#FrontPageMap0">
</p>
</body>
</html>
