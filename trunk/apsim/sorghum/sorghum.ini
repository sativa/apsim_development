!====================================================================================================
!  CONSTANTS  - SPECIES-SPECIFIC PARAMETERS
!====================================================================================================

[standard.sorghum.constants]

crop_type = sorghum

!*****************************************************************************************************
!SECTION 1 - CROP PHENOLOGY: DEVELOPMENT PARAMETERS
!*****************************************************************************************************

stage_names = sowing germination emergence end_of_juvenile floral_initiation flag_leaf flowering start_grain_fill end_grain_fill maturity harvest_ripe end_crop
!                 sow ger eme  juv    fi  flag   fl  st_gf end_gf mat hv_rpe end_crop
stage_code       = 1   2   3    4      5     6     7    8    9    10   11   12

!------------------------------------------------------------------------------
!Seed Germination

!Water stress factor for germination
pesw_germ = 0.0 (mm/mm)                ! plant extractable soil water in seedling layer inadequate for germination (mm/mm)

!-----------------------------------------------------------------------------------------------------------
!Emergence

shoot_lag  = 15.0 (oC)                 ! time lag before linear coleoptile growth starts (deg days)
shoot_rate = 0.6  (oC/mm)              ! growing deg day increase with depth for coleoptile (deg day/mm depth)

!Water stress factor for emergence
!fasw_emerg     = 0.0  1.0    ! Fraction of available soil water
!rel_emerg_rate = 1.0  1.0    ! Stress factor for thermal time calculation between germination and emergence

!-----------------------------------------------------------------------------------------------------------
!Photoperiod and twilight

twilight = -2.2 (o)   ! Twilight is defined as the interval between sunrise or sunset and the time when the true
                      ! centre of the sun is 2.2 degrees below the horizon. Sunrise or sunset is defined as when
                      ! the true centre of the sun is 50' below the horizon.

!-----------------------------------------------------------------------------------------------------------
!Thermal time calculation

x_temp  = 11 30  42  (oC) !cardinal temps.
y_tt    = 0  19   0  (oC) !diff

! sorghum TT parameters between flowering and maturity
tt_base = 5.7        (oC) !base temp
tt_opt  = 30.0            !

!-----------------------------------------------------------------------------------------------------------
!Leaf number development
!sorghum number of expanded leaves = number of nodes

leaf_no_at_emerg    = 1.0  ()    ! (expanded) leaf number at emergence ()
leaf_no_seed        = 4.0  ()    ! number of leaf primordia present in seed

leaf_no_min         = 10.0 ()    ! minimum leaf number
leaf_no_max         = 40.0 ()    ! maximum leaf number

leaf_init_rate      = 21.6 (oCd) ! degree days to initiate each leaf primordium until floral init (deg day)

leaf_app_rate1      = 41.0 (oCd) ! Growing deg day required to develop the most leaf ligules. (deg day).
leaf_app_rate2      = 20.0 (oCd) ! Growing deg day required to develop last leaf ligules. (deg day).
leaf_no_rate_change = 3.5  ()    ! Leaf no below flag above which leaf appearance rate changes from rate1 to rate2.
                                 ! RELATIVE to FLAG

photoperiod_base    = 13.2 (hr)  ! lower threshold of hours of light (hrs)
leaf_app_rate       = 41.0 (oC)  ! last leaf ligules. (deg day).

!*****************************************************************************************************
!SECTION 2 - PHOTOSYNTHESIS, BIOMASS GROWTH AND PARTITION
!*****************************************************************************************************

!Photosynthesis and radiation use efficiency (RUE)

!Stage dependent RUE
!                 sow ger eme  juv    fi  flag   fl  st_gf end_gf mat hv_rpe end_crop
!stage_code       = 1   2   3    4     5     6    7    8     9    10    11   12
 rue              = 0   0  1.25  1.25  1.25 1.25  1.25 1.25 1.25 1.25    0    0 ! g bio/MJ Radn radiation use efficiency

!     sorg_rue_reduction
x_temp_photo = 5 15 40 55 (oC) !for cool nights - not working yet

!-----------------------------------------------------------------------------------------------------------
!Extinction coefficient before anthesis

!Row spacing determined
row_spacing_default     = 0.75                (m)  ! Default rowing spacing used to  calculate k
x_row_spacing           = 0.20   0.50   1.00  (m)  ! Row spacing
y_extinct_coef          = 0.70   0.40   0.40  ()   ! extinction coefficient for green leaf
y_extinct_coef_dead     = 0.30   0.30   0.30  ()   ! extinction coefficient for dead material

!-----------------------------------------------------------------------------------------------------------
!Temperature response of photosynthesis- RUE

x_ave_temp      = 8 20 35 50  (oC)  ! mean daily temperature
y_stress_photo  = 0  1  1  0  ()    ! multiplier on RUE


!-------------------------------------------------
!Biomass initiation, partition and translocation
!-------------------------------------------------

!Initiation

dm_leaf_init    = 0.1   (g/plant)           ! leaf weight at emergence (g/plant)
dm_root_init    = 0.1   (g/plant)           ! root weight at emergence (g/plant)
dm_stem_init    = 0.1   (g/plant)           ! stem weight at emergence (g/plant)

!-----------------------------------------------------------------------------------------------------------
!Translocation parts

stem_trans_frac = 0.20 ()     ! fraction of stem used in translocation to grain
leaf_trans_frac = 0.15 ()     ! fraction of leaf used in translocation to grain

!-----------------------------------------------------------------------------------------------------------
!Biomass partitioning

!stage_name       = sow ger eme  juv    fi  flag   fl  st_gf end_gf mat hv_rpe end_crop
!stage_code       = 1   2   3    4      5    6      7     8    9    10   11   12
ratio_root_shoot  = 0   0   1    1     0.33  0.33  0.087  0    0     0    0    0

partition_rate_leaf = 0.012  ()   ! coefficient of sigmoidal function between leaf partition fraction and internode no**2 (0-1)
frac_stem2flower    = 0.30   ()   ! fraction of dm allocated to stem that goes to developing head

!-----------------------------------------------------------------------------------------------------------
!GRAIN NUMBER DETERMINATION

!grno_grate =   1   3    6                ! average growth rate per plant (g/day) during grain-number sensitive phase
!grno_grate = 0.5   3    6                ! average growth rate per plant (g/day) during grain-number sensitive phase
!grno_fract =   0  0.6   1                ! multiplier on potential grain number per plant

temp_grain_crit_stress = 50.0   (oC)      ! Tmax above which grain no. is reduced
htstress_coeff         = 0.0    ()        ! coeff for conversion of heat stress during flowering to heat stress factor on grain number development.

grain_n_conc_min       = 0.0102 ()        ! minimum nitrogen concentration of grain
seed_wt_min            = 0.01   (g/seed)  ! minimum grain weight (g/seed)


swdf_grain_min = 0.45 ()                  ! minimum of water stress factor

head_grain_no_crit     = 0      ()        ! grains per head minimum, below which all heads are barren
barren_crit            = 0.0    ()        ! fraction of maximum grains per plant below which barrenness occurs (0-1)

!-----------------------------------------------------------------------------------------------------------
!Grain filling

x_temp_grain = 3.68  30.00  56.32 (oC)
y_grain_rate = 0       1      0   ()

!-----------------------------------------------------------------------------------------------------------
!Grain water content

grn_water_cont = 0.130 (g/g)           ! water content of grain g/g

!-----------------------------------------------------------------------------------------------------------
!Grain growth TEMPLATE OPTION - NOT USED in Sorghum

growth_rate_min  = 0.195 (g/plant) ! minimum rate of photosynthesis below which there is no grain produced (g/plant)
growth_rate_crit = 1.2132 (g/plant)! threshold  rate of photosynthesis, below which heat stress has no
                                   ! effect (g/plant).  This is also the rate at which the grains/plant
                                   ! is half of the maximum grains.

hi_min = 0.1 (g dm grain/g dm plant top) ! minimum harvest index (g grain/g biomass)

!*****************************************************************************************************
!SECTION 3 - LEAF/STEM/POD AREA GROWTH
!*****************************************************************************************************

!------------------------------------------------------------------------------
!LEAF SIZE AS A FUNCTION OF LEAF NUMBER

leaf_no_correction = 1.52 ()            ! corrects for other growing leaves

!------------------------------------------------------------------------------
!SPECIFIC LEAF AREA - SLA

x_lai           =    0.1    4
y_lai_sla_max   =  50000 25000           ! maximum specific leaf area for delta LAI
lai_sla_min     =   8000  8000           ! minimum specific leaf area for delta LAI
sla_max         =  45000       (mm^2/g)
sla_min         =   8000       (mm^2/g)  ! minimum specific leaf area for new leaf area

!------------------------------------------------------------------------------
!TPLA  - USED TO INTIALISE THE INITIAL LAI

initial_tpla     =  200.0    (mm^2/plant) ! initial total plant leaf area
!min_tpla        =    0.0    (mm^2/plant) ! minimum leaf area


!------------------------------------------------------------------------------
! Leaf Area development - TPLA

tiller_coef           = 0.66 ()       ! exponent for determining leaf area on each additional tiller
tpla_inflection_ratio = 0.66 ()       ! inflection coefficient of TPLA curve

!------------------------------------------------------------------------------
! Height

height_max        = 3500.0  (mm)         ! maximum canopy height
height_stem_slope =  250.0  (mm/g/stem)  ! rate of height growth (mm/g/stem)


!*****************************************************************************************************
!SECTION 4 - ROOT DEPTH AND ROOT LENGTH GROWTH
!*****************************************************************************************************

!-----------------------------------------------------------------------------------------------------------
!ROOTING DEPTH

!stage_name       sow  ger  eme  juv    fi   flag    fl  st_gf end_gf   mat  hv_rpe  end_crop
!stage_code      = 1    2    3    4      5     6     7    8      9      10   11   12
root_depth_rate  = 0 27.0  27.0  27.0 27.0  27.0   27.0   0      0       0    0    0 !mm/day.

!x_sw_ratio = [sw_dep(lay)-ll_dep(lay)]/[dul_dep(lay)-ll_dep(lay)] in the deepest root layer
x_sw_ratio       = 0   0.25 ()       ! water availability for effects on root depth growth
y_sw_fac_root    = 0   1    ()       ! stress factor for root depth growth, This may be probably the same for all crops

!-----------------------------------------------------------------------------------------------------------
!ROOT LENGTH CALCULATION

initial_root_depth   = 50     (mm)          ! initial depth of roots (mm)
specific_root_length = 100000 (mm/g)

!The following can increase or decrease the root length density in a layer based on the rld per plant

x_plant_rld          = 0.0  0.1 (mm/mm3/plant)  ! root branching
y_rel_root_rate      = 1.0  1.0 (0-1)


!*****************************************************************************************************
!SECTION 5 - WATER RELATIONS AND WATER STRESS FACTORS
!*****************************************************************************************************

!STAGE DEPENDENT TRANSPIRATION COEFFICIENTS

!Transpiration efficiency coefficient to convert vpd to transpiration efficiency (kpa)
!The following transp_eff_cf values are from i_wheat model  - ew
!in the form kpa/g carbo per m^2 / g water per m^2 (kpa/g carbo per m^2 / mm water) because 1g water = 1 cm^3 water

!                 sow    ger     eme    juv      fi      flag   fl  st_gf end_gf mat hv_rpe end_crop
!stage_code       = 1    2       3       4       5       6      7      8      9      10     11     12
transp_eff_cf =  0.009 0.009 0.009 0.009 0.009 0.009  0.009  0.009  0.009  0.009   0.009   0.009  (kpa)

!-----------------------------------------------------------------------------------------------------------
!VPD FRACTION

!Fraction of distance between svp at min temp and svp at max temp where average svp during transpiration lies.
svp_fract   = 0.75  !   (0-1)

!-----------------------------------------------------------------------------------------------------------

!WATER STRESS FACTORS FOR PHOTOSYNTHESIS, EXPANSION AND DEVELOPMENT

!swdef_photo for photosynthesis is calculated in the code as = sw_supply_sum/sw_demand - function crop_swdef_photo

!For expansion growth, more sensitive than other growth processes
!x_sw_demand_ratio = sw_supply_sum/sw_demand

x_sw_demand_ratio = 0.1 1.1 ()          ! water availability This is the original value
y_swdef_leaf      = 0   1   ()          ! stress indices

!For phenology stress factor based on available soil water portion
!sw_avail_pot_sum = sum_real_array (sw_avail_pot, deepest_layer),
!sw_avail_sum     = sum_real_array (sw_avail, deepest_layer)
!sw_avail_ratio   = divide (sw_avail_sum, sw_avail_pot_sum, 1.0) !???

x_sw_avail_ratio = 0 0.2 1.0 ()        ! water availability Needs to be severe to worry phenology
y_swdef_pheno    = 0 1.0 1.0 ()        ! stress indices


!*****************************************************************************************************
!SECTION 6 -NITROGEN RELATIONS, UPTAKE AND STRESS FACTORS
!*****************************************************************************************************

!------------------------------------------------------------------------------
!UPTAKE PREFERENCE AND CONSTANTS

!preference for n supply - it is assumed that mass flow is always predominant, but further crop preference can
!be specified as follows:
! 'active'   = diffusive flow before fixation
! 'fixation' = fixed N before active uptake.

n_supply_preference = active

!Time constant for N uptake by diffusion. H van Keulen &  NG Seligman. Purdoe 1987.
!This is the  time it would take to remove, by diffusion, current amount of N if it wasn't depleted between time steps

no3_diffn_const  = 2.0 (days)

!------------------------------------------------------------------------------

!LEGUME N FIXATION RATE
!              sow  ger     eme  juv     fi   flag    fl   st_gf  end_gf   mat  hv_rpe  end_crop
!stage_code  =  1     2      3    4      5      6      7      8      9      10     11     12
n_fix_rate   =  0.0   0.0   0.0   0.0   0.0    0.0   0.0     0.0    0.0     0.0    0.0   0.0   ()

!------------------------------------------------------------------------------

!NITROGEN STRESS FACTORS FOR PHOTOSYNTHESIS,LEAF GROWTH AND DEVELOPMENT

!scc Some of these probably need to be smaller - not seeing an effect or else too much N being made available?

!n_conc_ratio      = divide ((N_conc_stover - N_conc_stover_min),(N_conc_stover_crit-N_conc_stover_min),0.0)
!n_conc_ratio_leaf = divide ((N_conc_leaf - N_conc_leaf_min), (N_conc_leaf_crit - N_conc_leaf_min), 0.0)
!g_nfact_photo     = N_fact_photo * N_conc_ratio   <------ why here not using the leaf nitrogen
!g_n_fact_pheno    = N_fact_pheno * N_conc_ratio
!g_nfact_expansion = N_fact_expansion * n_conc_ratio_leaf

n_fact_photo     = 1.25    ! multipler for N deficit effect on photosynthesis
n_fact_expansion = 1.0     ! multipler for N deficit effect on leaf expansion
n_fact_pheno     = 1.25    ! multipler for N deficit effect on phenology


!------------------------------------------------------------------------------
!NITROGEN CONCENTRATION LIMITS: MAX. CRITICAL AND MINIMUM N CONCENTRATIONS

!                      emerg   flag  maturity
x_stage_code         = 3       6       10    ()
y_n_conc_min_leaf    = 0.017   0.015  0.010  ()
y_n_conc_crit_leaf   = 0.045   0.040  0.035  ()
y_n_conc_max_leaf    = 0.045   0.040  0.035  ()

y_n_conc_min_stem    = 0.017   0.010  0.010  ()
y_n_conc_crit_stem   = 0.055   0.010  0.005  ()
y_n_conc_max_stem    = 0.045   0.040  0.030  ()

y_n_conc_min_flower  = 0.000   0.000  0.010  ()
y_n_conc_crit_flower = 0.000   0.000  0.025  ()
y_n_conc_max_flower  = 0.000   0.000  0.030  ()

y_n_conc_min_root    = 0.00800 0.00800 0.00800
y_n_conc_crit_root   = 0.01200 0.01200 0.01200
y_n_conc_max_root    = 0.02000 0.02000 0.02000

n_conc_min_grain    = 0.011    () !by side-dressing N at boot or flowering
n_conc_crit_grain   = 0.016    ()
n_conc_max_grain    = 0.030    () !scc - might be wrong. Max Cowie got 3% N in grain in the field in Gatton

!------------------------------------------------------------------------------
!INITIAL NITROGEN CONCENTRATION OF ORGANS
!leaf in SLN
!               root   leaf   stem   flower   grain
n_init_conc   = 0.020  1.5    0.04    0.000   0.000
n_target_conc = 0.002  1.5    0.005   0.01    0.001

!------------------------------------------------------------------------------
!NITROGEN CONCENTRATION IN SENESCENCED ORGANS
!This means that as soon as leaves fall off, all N except for the amount below is
!instantly transferred from leaves to stem (need to stop this occuring if you 'kill' crop)

!            root  leaf  stem  flower grain
n_sen_conc = 0.001 0.001 0.001 0.001  0.001

!------------------------------------------------------------------------------
!GRAIN NITROGEN CONCENTRATION

sw_fac_max   = 1.125  ()                ! soil water stress factor maximum
temp_fac_min = 0.69   ()                ! temperature stress factor minimum
sfac_slope   = -0.125 ()                ! soil water stress factor slope
tfac_slope   = 0.0125 ()                ! temperature stress factor slope


!*****************************************************************************************************
!SECTION 7 -SENESCENCE AND DETACHMENT
!*****************************************************************************************************

!------------------------------------------------------------------------------
!DM SENESCENCE

dm_root_sen_frac = 0.002 ()   ! fraction of root dry matter senesced each day
dm_leaf_sen_frac = 1.0   ()   ! fraction of senescing leaf dry matter remaining in leaf (0-1)

!------------------------------------------------------------------------------
!LEAF NUMBER AND AREA SENESCENCE

leaf_no_dead_const = 0.0    ()         ! coefficients for rate of leaf number senescence following flowering
leaf_no_dead_slope = 0.0009 ()         !

lai_sen_light = 4.0         (m^2/m^2)  ! induced senescence occurs (m^2/m^2)
sen_light_slope = 0.008     ()         ! sensitivity of leaf area senescence to shading

x_temp_senescence = 0.0 6.0            ! minimum temperature for frost senescence table (oC)
y_senescence_fac  = 1   0              ! daily fraction of leaf area senesced due to frost (0-1)

sen_rate_water = 0.05       ()         ! slope in linear eqn relating soil water stress during photosynthesis to leaf senesence rate

!------------------------------------------------------------------------------
!DETACHMENT

! root leaf stem flower grain

dead_detach_frac = 0 0 0 0 0   ()      ! fraction detached from each part of a dead plant per day.
dm_leaf_detach_frac = 0        ()

!------------------------------------------------------------------------------
! Sorghum Senescence

! light
sen_light_time_const = 10.0 (days)     ! delay factor for light senescence
sen_radn_crit        = 2    (Mj/m^2)   ! radiation level for onset of light senescence

! frost
frost_kill           = 1.0  (oC)       ! temperature threshold for leaf death

! water
sen_water_time_const = 10.0 (days)     ! delay factor for water senescence
sen_threshold        = 0.25 ()         ! supply:demand ratio for onset of water senescence

!age
spla_slope           = 81.5 (oC/leaf)  ! regression slope for calculating inflection point for leaf senescence


!*****************************************************************************************************
!SECTION 8 - WE MIGHT PUT RETRANSLOCATION OF DM AND N IN THIS SECTION
!*****************************************************************************************************

!*****************************************************************************************************
!SECTION 9 - CROP FAILURE AND DEATH
!*****************************************************************************************************

!------------------------------------------------------------------------------
! crop failure

leaf_no_crit      =   0.0       ()      ! critical number of leaves, below which portion of the crop may die due to water stress
tt_emerg_limit    = 150.0       (oCd)   ! maximum degree days allowed for emergence to take place
days_germ_limit   =  40.0       (days)  ! maximum days allowed after sowing for germination to take place (days)
swdf_photo_limit  =  99.0       ()      ! critical cumulative photosynthesis water stress, above which the crop partly fails (unitless)
swdf_photo_rate   =   0.0       ()      ! rate of plant reduction with photosynthesis water stress
swdf_pheno_limit  =  99.0       ()      ! critical cumulative phenology water stress, above which the crop fails (unitless)

!------------------------------------------------------------------------------
!PLANT DEATH

x_weighted_temp = 55.0  60.0  (oC)
y_plant_death   =  0.0   1.0

!*****************************************************************************************************
!SECTION 10 - PHOSPHORUS RELATIONS, UPTAKE AND STRESS FACTORS
!*****************************************************************************************************

!               emerg   juv     fi      flower  maturity
!p_stage_code =  3       4      5      7       8         10     ()
!p_conc_max   =  0.005   0.004  0.003  0.0015  0.0015   0.0020  ()
!p_conc_min   =  0.003   0.002  0.0015 0.0007  0.0007   0.0007  ()
!
!k_pfact_photo     =  2.0
!k_pfact_pheno     =  10
!k_pfact_expansion =  20
!k_pfact_grain     =  4
!
!p_uptake_factor   =  1.5     ! factor to calc total P uptake from demand for today's growth

!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
!SECTION 10 - PHOSPHORUS RELATIONS, UPTAKE AND STRESS FACTORS
!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

!------------------------------------------------------------------------------
!PHOSPHORUS CONCENTRATION LIMITS: MAXIMUM, MINIMUM AND SENESCED P CONCENTRATIONS

stress_determinants = leaf stem grain
yield_parts = grain
retrans_parts = leaf stem  flower

pfact_photo_slope = 2.5
pfact_expansion_slope = 2.5
pfact_pheno_slope = 6
pfact_grain_slope = 20

p_uptake_factor =   1.5   ! factor to calc total P uptake from demand for today's growth

x_p_stage_code =       3       4      5      6      7      8      10     ()

y_p_conc_max_leaf =    0.0059  0.0054 0.0040 0.0029 0.0026 0.0025 0.0022  ()
y_p_conc_min_leaf =    0.0037  0.0029 0.0030 0.0022 0.0019 0.0018 0.0014  ()
y_p_conc_sen_leaf =    0.0005  0.0005 0.0005 0.0005 0.0005 0.0005 0.0005  ()

y_p_conc_max_stem =    0.0057  0.0038 0.0037 0.0018 0.0016 0.0013 0.0013 ()
y_p_conc_min_stem =    0.0044  0.0023 0.0022 0.0011 0.0009 0.0008 0.0007  ()
y_p_conc_sen_stem =    0.0002  0.0002 0.0002 0.0002 0.0002 0.0002 0.0002  ()

y_p_conc_max_root =    0.0010  0.0010 0.0010 0.0010 0.0010 0.0010 0.0010 ()  !assume P conc in roots non-varying
y_p_conc_min_root =    0.0010  0.0010 0.0010 0.0010 0.0010 0.0010 0.0010 ()
y_p_conc_sen_root =    0.0010  0.0010 0.0010 0.0010 0.0010 0.0010 0.0010 ()

y_p_conc_max_flower=   0.0057  0.0038 0.0037 0.0018 0.0016 0.0013 0.0013 () ! assumed same as stem
y_p_conc_min_flower=   0.0044  0.0023 0.0022 0.0011 0.0009 0.0008 0.0007()
y_p_conc_sen_flower=   0.0002  0.0002 0.0002 0.0002 0.0002 0.0002 0.0002()

y_p_conc_max_grain =   0.001   0.001  0.001  0.001  0.052  0.0044  0.0034 ()
y_p_conc_min_grain =   0.001   0.001  0.001  0.001  0.028  0.0023  0.0018 ()
y_p_conc_sen_grain =   0.001   0.001  0.001  0.001  0.001  0.0015  0.0015 ()

y_p_conc_max_energy =  0.001   0.001  0.001  0.001  0.001  0.001  0.001 ()
y_p_conc_min_energy =  0.001   0.001  0.001  0.001  0.001  0.001  0.001 ()
y_p_conc_sen_energy =  0.001   0.001  0.001  0.001  0.001  0.001  0.001 ()

p_conc_init_leaf = 0.004
p_conc_init_stem = 0.004
p_conc_init_root = 0.010
p_conc_init_flower = 0.002
p_conc_init_grain  = 0.0025
p_conc_init_energy = 0.0


!*****************************************************************************************************
!SECTION 11 - VALUE LIMITS - MAX AND MINS
!*****************************************************************************************************

!------------------------------------------------------------------------------

!ROOT PARAMETERS

ll_ub  = 1000.0 ()                     ! upper limit of lower limit
kl_ub  = 1.0    ()                     ! upper limit of water uptake factor

!------------------------------------------------------------------------------

!SOIL WATER

minsw  = 0.00001 ()                    ! lowest acceptable value for ll

!------------------------------------------------------------------------------

!OTHER VARIABLES
! limits set to check inputs

latitude_ub         =    90     (oL)    !  latitude upper limit
latitude_lb         =   -90     (oL)    !  latitude lower limit
maxt_ub             =    55     (oC)    !  max. temperature upper limit
maxt_lb             =     0     (oC)    !  max. temperature lower limit
mint_ub             =    40     (oC)    !  min. temperature upper limit
mint_lb             =   -10     (oC)    !  min. temperature lower limit
radn_ub             =    50     (MJ/m^2)!  radiation upper limit
radn_lb             =     1     (MJ/m^2)!  radiation lower limit
dlayer_ub           =  1000     (mm)    !  layer depth upper limit
dlayer_lb           =     0     (mm)    !  layer depth lower limit
dul_dep_ub          =  1000     (mm)    !  drained upper limit upper limit
dul_dep_lb          =     0     (mm)    !  drained upper limit lower limit
sw_dep_ub           =  1000     (mm)    !  soil water upper limit
sw_dep_lb           =     0     (mm)    !  soil water lower limit
sw_ub               =   1.0     (mm)    !  soil water upper limit
sw_lb               =   0.0     (mm)    !  soil water upper limit
no3_ub              = 10000     (kg/ha) !  soil nitrate upper limit
no3_lb              =     0     (kg/ha) !  soil nitrate lower limit
no3_min_ub          = 10000     (kg/ha) !  min. soil nitrate upper limit
no3_min_lb          =     0     (kg/ha) !  min. soil nitrate lower limit
nh4_ub              = 10000     (kg/ha) !  soil nitrate upper limit
nh4_lb              =     0     (kg/ha) !  soil nitrate lower limit
nh4_min_ub          = 10000     (kg/ha) !  min. soil nitrate upper limit
nh4_min_lb          =     0     (kg/ha) !  min. soil nitrate lower limit

! cultivar parameter upper bounds

head_grain_no_max_ub        = 45000.0 () ! upper limit  !NOT USED
grain_gth_rate_ub           =    20.0 () ! upper limit  !NOT USED
tt_emerg_to_endjuv_ub       =   500.0 () ! upper limit
pp_endjuv_to_init_ub        =   200.0 () ! upper limit oC h-1
tt_flower_to_maturity_ub    =  1000.0 () ! upper limit
tt_maturity_to_ripe_ub      =  1000.0 () ! upper limit
tt_flower_to_start_grain_ub =  1000.0 () ! upper limit
tt_flag_to_flower_ub        =  1000.0 () ! upper limit





!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! CULTIVAR PARAMERAMETERS !!!!!!!!!!!!!!!!!!!!!!!!!!!!

[standard.sorghum.early]   ! pioneer_s34

!--------------------------------------------------------------------------------------------------------
! PHENOLOGY
!--------------------------------------------------------------------------------------------------------

tt_emerg_to_endjuv       = 100.0 (oC)           ! fixed for all genotypes
photoperiod_crit1        =  12.3 (hours)
photoperiod_crit2        =  14.6 (hours)
photoperiod_slope        =  25.0
tt_endjuv_to_init        = 115.0 (oC)
pp_endjuv_to_init        =  30.0 ()
est_days_endjuv_to_init  =  15.0
tt_flag_to_flower        = 100.0
tt_flower_to_start_grain =  30.0
tt_maturity_to_ripe      =   1.0
tt_flower_to_maturity    = 695.0 (oC)       ! using base temp of 5.7

!--------------------------------------------------------------------------------------------------------
! LEAF AREA - TPLA approach
!--------------------------------------------------------------------------------------------------------

main_stem_coef  = 2.95  ()     ! Power coeff for TPLAmax=TLN^coef
tpla_prod_coef  = 0.015 (1/oC) ! curvature coefficient for leaf area
tpla_inflection = 320.0 (oC)   ! inflection point of leaf area production

!--------------------------------------------------------------------------------------------------------
! SENESCING LEAF AREA - SPLA approach
!--------------------------------------------------------------------------------------------------------

spla_prod_coef = 0.007 (1/oC)    ! curvature coefficient for leaf area senescence function
spla_intercept = -250.0 (oC)     ! intercept of regression for calculating inflection point of senescence function

!--------------------------------------------------------------------------------------------------------
! GRAIN GROWTH - HI approach
!--------------------------------------------------------------------------------------------------------

hi_incr = 0.0185 (1/days)
x_hi_max_pot_stress  = 0.0  1.0
y_hi_max_pot         = 0.2  0.55

!--------------------------------------------------------------------------------------------------------
! GRAIN GROWTH - number/size approach
!--------------------------------------------------------------------------------------------------------

head_grain_no_max       = 5000.0 ()       !not needed here
grain_gth_rate          = 9.17   ()       !not needed here

!--------------------------------------------------------------------------------------------------------
! GRAIN GROWTH - source/sink approach
!--------------------------------------------------------------------------------------------------------
dm_per_seed = 0.00083

!--------------------------------------------------------------------------------------------------------
! CANOPY HEIGHT - function of stem biomass per plant (need to adjust this for density effects)
!--------------------------------------------------------------------------------------------------------
x_stem_wt = 0    80 (g/stem)    ! look up table for canopy height
y_height  = 0  2000 (mm)        !



[standard.sorghum.medium]  !       texas_RS610
!--------------------------------------------------------------------------------------------------------
! PHENOLOGY
!--------------------------------------------------------------------------------------------------------

tt_emerg_to_endjuv       = 100  (oC)           ! fixed for all genotypes
photoperiod_crit1        = 12.3 (hours)
photoperiod_crit2        = 14.6 (hours)
photoperiod_slope        = 38.4 (oC/hour)
tt_endjuv_to_init        = 120. (oC)
pp_endjuv_to_init        = 30   ()
est_days_endjuv_to_init  = 20
tt_flag_to_flower        = 100
tt_flower_to_start_grain = 30
tt_maturity_to_ripe      = 1
tt_flower_to_maturity    = 695 (oC)       ! using base temp of 5.7

!--------------------------------------------------------------------------------------------------------
! LEAF AREA - TPLA approach
!--------------------------------------------------------------------------------------------------------

main_stem_coef  = 2.88  ()     ! Power coeff for TPLAmax=TLN^coef
tpla_prod_coef  = 0.018 (1/oC) ! curvature coefficient for leaf area
tpla_inflection = 355.7 (oC)   ! inflection point of leaf area production

!--------------------------------------------------------------------------------------------------------
! SENESCING LEAF AREA - SPLA approach
!--------------------------------------------------------------------------------------------------------

spla_prod_coef = 0.007 (1/oC)    ! curvature coefficient for leaf area senescence function
spla_intercept = -280.0 (oC)     ! intercept of regression for calculating inflection point of senescence function

!--------------------------------------------------------------------------------------------------------
! GRAIN GROWTH - HI approach
!--------------------------------------------------------------------------------------------------------

hi_incr = 0.0185 (1/days)
x_hi_max_pot_stress  = 0.0  1.0
y_hi_max_pot         = 0.2  0.55

!--------------------------------------------------------------------------------------------------------
! GRAIN GROWTH - number/size approach
!--------------------------------------------------------------------------------------------------------

head_grain_no_max       = 5000.0 ()       !not needed here
grain_gth_rate          = 9.17   ()       !not needed here

!--------------------------------------------------------------------------------------------------------
! GRAIN GROWTH - source/sink approach
!--------------------------------------------------------------------------------------------------------
dm_per_seed = 0.00083

!--------------------------------------------------------------------------------------------------------
! CANOPY HEIGHT - function of stem biomass per plant (need to adjust this for density effects)
!--------------------------------------------------------------------------------------------------------
x_stem_wt = 0    80 (g/stem)    ! look up table for canopy height
y_height  = 0  2000 (mm)        !




[standard.sorghum.late]    ! tx623/tx430

!--------------------------------------------------------------------------------------------------------
! PHENOLOGY
!--------------------------------------------------------------------------------------------------------

tt_emerg_to_endjuv       = 100.0  (oC)           ! fixed for all genotypes
photoperiod_crit1        =  12.3 (hours)
photoperiod_crit2        =  14.6 (hours)
photoperiod_slope        =  38.4
tt_endjuv_to_init        = 255.0 (oC)
pp_endjuv_to_init        =  30.0 ()
est_days_endjuv_to_init  =  20.0
tt_flag_to_flower        =  80.0
tt_flower_to_start_grain =  50.0
tt_maturity_to_ripe      = 1
tt_flower_to_maturity    = 695 (oC)       ! using base temp of 5.7

!--------------------------------------------------------------------------------------------------------
! LEAF AREA - TPLA approach
!--------------------------------------------------------------------------------------------------------

main_stem_coef  = 2.95  ()     ! Power coeff for TPLAmax=TLN^coef
tpla_prod_coef  = 0.018 (1/oC) ! curvature coefficient for leaf area
tpla_inflection = 400.8 (oC)   ! inflection point of leaf area production

!--------------------------------------------------------------------------------------------------------
! SENESCING LEAF AREA - SPLA approach
!--------------------------------------------------------------------------------------------------------

spla_prod_coef = 0.005 (1/oC)    ! curvature coefficient for leaf area senescence function
spla_intercept = -321.0 (oC)     ! intercept of regression for calculating inflection point of senescence function

!--------------------------------------------------------------------------------------------------------
! GRAIN GROWTH - HI approach
!--------------------------------------------------------------------------------------------------------

hi_incr = 0.0185 (1/days)
x_hi_max_pot_stress  = 0.0  1.0
y_hi_max_pot         = 0.2  0.55

!--------------------------------------------------------------------------------------------------------
! GRAIN GROWTH - number/size approach
!--------------------------------------------------------------------------------------------------------

head_grain_no_max       = 5000.0 ()       !not needed here
grain_gth_rate          = 9.17   ()       !not needed here

!--------------------------------------------------------------------------------------------------------
! GRAIN GROWTH - source/sink approach
!--------------------------------------------------------------------------------------------------------
dm_per_seed = 0.00083

!--------------------------------------------------------------------------------------------------------
! CANOPY HEIGHT - function of stem biomass per plant (need to adjust this for density effects)
!--------------------------------------------------------------------------------------------------------
x_stem_wt = 0    80 (g/stem)    ! look up table for canopy height
y_height  = 0  2000 (mm)        !


[standard.sorghum.dekalb_DK55]

!--------------------------------------------------------------------------------------------------------
! PHENOLOGY
!--------------------------------------------------------------------------------------------------------

tt_emerg_to_endjuv       = 100  (oC)           ! fixed for all genotypes
photoperiod_crit1        = 11.0 (hours)
photoperiod_crit2        = 13.0 (hours)
photoperiod_slope        =  0.0
tt_endjuv_to_init        = 205. (oC)
pp_endjuv_to_init        = 30   ()
est_days_endjuv_to_init  = 20
tt_flag_to_flower        = 100
tt_flower_to_start_grain = 30
tt_maturity_to_ripe      = 1
tt_flower_to_maturity    = 695 (oC)       ! using base temp of 5.7

!--------------------------------------------------------------------------------------------------------
! LEAF AREA - TPLA approach
!--------------------------------------------------------------------------------------------------------

main_stem_coef  = 2.95  ()     ! Power coeff for TPLAmax=TLN^coef
tpla_prod_coef  = 0.012 (1/oC) ! curvature coefficient for leaf area
tpla_inflection = 416.6 (oC)   ! inflection point of leaf area production

!--------------------------------------------------------------------------------------------------------
! SENESCING LEAF AREA - SPLA approach
!--------------------------------------------------------------------------------------------------------

spla_prod_coef = 0.005 (1/oC)    ! curvature coefficient for leaf area senescence function
spla_intercept = -321.0 (oC)     ! intercept of regression for calculating inflection point of senescence function

!--------------------------------------------------------------------------------------------------------
! GRAIN GROWTH - HI approach
!--------------------------------------------------------------------------------------------------------

hi_incr = 0.0185 (1/days)
x_hi_max_pot_stress  = 0.0  1.0
y_hi_max_pot         = 0.2  0.55

!--------------------------------------------------------------------------------------------------------
! GRAIN GROWTH - number/size approach
!--------------------------------------------------------------------------------------------------------

head_grain_no_max       = 5000.0 ()       !not needed here
grain_gth_rate          = 9.17   ()       !not needed here

!--------------------------------------------------------------------------------------------------------
! GRAIN GROWTH - source/sink approach
!--------------------------------------------------------------------------------------------------------
dm_per_seed = 0.00083

!--------------------------------------------------------------------------------------------------------
! CANOPY HEIGHT - function of stem biomass per plant (need to adjust this for density effects)
!--------------------------------------------------------------------------------------------------------
x_stem_wt = 0    80 (g/stem)    ! look up table for canopy height
y_height  = 0  2000 (mm)        !

[standard.sorghum.texas_RS610]

!--------------------------------------------------------------------------------------------------------
! PHENOLOGY
!--------------------------------------------------------------------------------------------------------

tt_emerg_to_endjuv       = 100   (oC)           ! fixed for all genotypes
photoperiod_crit1        = 12.3  (hours)
photoperiod_crit2        = 14.6  (hours)
photoperiod_slope        = 38.4
tt_endjuv_to_init        = 120.0 (oC)
pp_endjuv_to_init        = 30    ()
est_days_endjuv_to_init  = 20
tt_flag_to_flower        = 100
tt_flower_to_start_grain = 30
tt_maturity_to_ripe      = 1
tt_flower_to_maturity    = 695   (oC)       ! using base temp of 5.7

!--------------------------------------------------------------------------------------------------------
! LEAF AREA - TPLA approach
!--------------------------------------------------------------------------------------------------------

main_stem_coef  = 2.88  ()     ! Power coeff for TPLAmax=TLN^coef
tpla_prod_coef  = 0.018 (1/oC) ! curvature coefficient for leaf area
tpla_inflection = 355.7 (oC)   ! inflection point of leaf area production

!--------------------------------------------------------------------------------------------------------
! SENESCING LEAF AREA - SPLA approach
!--------------------------------------------------------------------------------------------------------

spla_prod_coef = 0.007 (1/oC)    ! curvature coefficient for leaf area senescence function
spla_intercept = -280.0 (oC)     ! intercept of regression for calculating inflection point of senescence function

!--------------------------------------------------------------------------------------------------------
! GRAIN GROWTH - HI approach
!--------------------------------------------------------------------------------------------------------

hi_incr = 0.0185 (1/days)
x_hi_max_pot_stress  = 0.0  1.0
y_hi_max_pot         = 0.2  0.55

!--------------------------------------------------------------------------------------------------------
! GRAIN GROWTH - number/size approach
!--------------------------------------------------------------------------------------------------------

head_grain_no_max       = 5000.0 ()       !not needed here
grain_gth_rate          = 9.17   ()       !not needed here

!--------------------------------------------------------------------------------------------------------
! GRAIN GROWTH - source/sink approach
!--------------------------------------------------------------------------------------------------------
dm_per_seed = 0.00083

!--------------------------------------------------------------------------------------------------------
! CANOPY HEIGHT - function of stem biomass per plant (need to adjust this for density effects)
!--------------------------------------------------------------------------------------------------------
x_stem_wt = 0    80 (g/stem)    ! look up table for canopy height
y_height  = 0  2000 (mm)        !


[standard.sorghum.pioneer_s34]

!--------------------------------------------------------------------------------------------------------
! PHENOLOGY
!--------------------------------------------------------------------------------------------------------

tt_emerg_to_endjuv       = 100  (oC)           ! fixed for all genotypes
photoperiod_crit1        = 12.3 (hours)
photoperiod_crit2        = 14.6 (hours)
photoperiod_slope        = 25.0
tt_endjuv_to_init        = 115. (oC)
pp_endjuv_to_init        = 30   ()
est_days_endjuv_to_init  = 15
tt_flag_to_flower        = 100
tt_flower_to_start_grain = 30
tt_maturity_to_ripe      = 1
tt_flower_to_maturity    = 695 (oC)       ! using base temp of 5.7

!--------------------------------------------------------------------------------------------------------
! LEAF AREA - TPLA approach
!--------------------------------------------------------------------------------------------------------

main_stem_coef  = 2.95  ()     ! Power coeff for TPLAmax=TLN^coef
tpla_prod_coef  = 0.015 (1/oC) ! curvature coefficient for leaf area
tpla_inflection = 320.0 (oC)   ! inflection point of leaf area production

!--------------------------------------------------------------------------------------------------------
! SENESCING LEAF AREA - SPLA approach
!--------------------------------------------------------------------------------------------------------

spla_prod_coef = 0.007 (1/oC)    ! curvature coefficient for leaf area senescence function
spla_intercept = -250.0 (oC)     ! intercept of regression for calculating inflection point of senescence function

!--------------------------------------------------------------------------------------------------------
! GRAIN GROWTH - HI approach
!--------------------------------------------------------------------------------------------------------

hi_incr = 0.0185 (1/days)
x_hi_max_pot_stress  = 0.0  1.0
y_hi_max_pot         = 0.2  0.55

!--------------------------------------------------------------------------------------------------------
! GRAIN GROWTH - number/size approach
!--------------------------------------------------------------------------------------------------------

head_grain_no_max       = 5000.0 ()       !not needed here
grain_gth_rate          = 9.17   ()       !not needed here

!--------------------------------------------------------------------------------------------------------
! GRAIN GROWTH - source/sink approach
!--------------------------------------------------------------------------------------------------------
dm_per_seed = 0.00083

!--------------------------------------------------------------------------------------------------------
! CANOPY HEIGHT - function of stem biomass per plant (need to adjust this for density effects)
!--------------------------------------------------------------------------------------------------------
x_stem_wt = 0    80 (g/stem)    ! look up table for canopy height
y_height  = 0  2000 (mm)        !

[standard.sorghum.tx623_tx430]

!--------------------------------------------------------------------------------------------------------
! PHENOLOGY
!--------------------------------------------------------------------------------------------------------

tt_emerg_to_endjuv       = 100  (oC)           ! fixed for all genotypes
photoperiod_crit1        = 12.3 (hours)
photoperiod_crit2        = 14.6 (hours)
photoperiod_slope        = 38.4
tt_endjuv_to_init        = 255. (oC)
pp_endjuv_to_init        = 30   ()
est_days_endjuv_to_init  = 20
tt_flag_to_flower        = 80
tt_flower_to_start_grain = 50
tt_maturity_to_ripe      = 1
tt_flower_to_maturity    = 695 (oC)       ! using base temp of 5.7

!--------------------------------------------------------------------------------------------------------
! LEAF AREA - TPLA approach
!--------------------------------------------------------------------------------------------------------

main_stem_coef  = 2.95  ()     ! Power coeff for TPLAmax=TLN^coef
tpla_prod_coef  = 0.018 (1/oC) ! curvature coefficient for leaf area
tpla_inflection = 400.8 (oC)   ! inflection point of leaf area production

!--------------------------------------------------------------------------------------------------------
! SENESCING LEAF AREA - SPLA approach
!--------------------------------------------------------------------------------------------------------

spla_prod_coef = 0.005 (1/oC)    ! curvature coefficient for leaf area senescence function
spla_intercept = -321.0 (oC)     ! intercept of regression for calculating inflection point of senescence function

!--------------------------------------------------------------------------------------------------------
! GRAIN GROWTH - HI approach
!--------------------------------------------------------------------------------------------------------

hi_incr = 0.0185 (1/days)
x_hi_max_pot_stress  = 0.0  1.0
y_hi_max_pot         = 0.2  0.55

!--------------------------------------------------------------------------------------------------------
! GRAIN GROWTH - number/size approach
!--------------------------------------------------------------------------------------------------------

head_grain_no_max       = 5000.0 ()       !not needed here
grain_gth_rate          = 9.17   ()       !not needed here

!--------------------------------------------------------------------------------------------------------
! GRAIN GROWTH - source/sink approach
!--------------------------------------------------------------------------------------------------------
dm_per_seed = 0.00083

!--------------------------------------------------------------------------------------------------------
! CANOPY HEIGHT - function of stem biomass per plant (need to adjust this for density effects)
!--------------------------------------------------------------------------------------------------------
x_stem_wt = 0    80 (g/stem)    ! look up table for canopy height
y_height  = 0  2000 (mm)        !

[standard.sorghum.texas_671]

!--------------------------------------------------------------------------------------------------------
! PHENOLOGY
!--------------------------------------------------------------------------------------------------------

tt_emerg_to_endjuv       = 100  (oC)           ! fixed for all genotypes
photoperiod_crit1        = 12.3 (hours)
photoperiod_crit2        = 14.6 (hours)
photoperiod_slope        = 15.2
tt_endjuv_to_init        = 159.0 (oC)
pp_endjuv_to_init        = 30   ()
est_days_endjuv_to_init  = 20
tt_flag_to_flower        = 100
tt_flower_to_start_grain = 30
tt_maturity_to_ripe      = 1
tt_flower_to_maturity    = 695 (oC)       ! using base temp of 5.7

!--------------------------------------------------------------------------------------------------------
! LEAF AREA - TPLA approach
!--------------------------------------------------------------------------------------------------------

main_stem_coef  = 2.88  ()     ! Power coeff for TPLAmax=TLN^coef
tpla_prod_coef  = 0.015 (1/oC) ! curvature coefficient for leaf area
tpla_inflection = 350.0 (oC)   ! inflection point of leaf area production

!--------------------------------------------------------------------------------------------------------
! SENESCING LEAF AREA - SPLA approach
!--------------------------------------------------------------------------------------------------------

spla_prod_coef = 0.005 (1/oC)    ! curvature coefficient for leaf area senescence function
spla_intercept = -321.0 (oC)     ! intercept of regression for calculating inflection point of senescence function

!--------------------------------------------------------------------------------------------------------
! GRAIN GROWTH - HI approach
!--------------------------------------------------------------------------------------------------------

hi_incr = 0.0185 (1/days)
x_hi_max_pot_stress  = 0.0  1.0
y_hi_max_pot         = 0.2  0.55

!--------------------------------------------------------------------------------------------------------
! GRAIN GROWTH - number/size approach
!--------------------------------------------------------------------------------------------------------

head_grain_no_max       = 5000.0 ()       !not needed here
grain_gth_rate          = 9.17   ()       !not needed here

!--------------------------------------------------------------------------------------------------------
! GRAIN GROWTH - source/sink approach
!--------------------------------------------------------------------------------------------------------
dm_per_seed = 0.00083

!--------------------------------------------------------------------------------------------------------
! CANOPY HEIGHT - function of stem biomass per plant (need to adjust this for density effects)
!--------------------------------------------------------------------------------------------------------
x_stem_wt = 0    80 (g/stem)    ! look up table for canopy height
y_height  = 0  2000 (mm)        !

