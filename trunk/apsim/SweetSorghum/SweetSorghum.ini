C     Last change:  MJR    14 Jan 2003


!***********************************************************************************************************
!  CONSTANTS  - SPECIES-SPECIFIC PARAMETERS
!***********************************************************************************************************

[standard.sweetsorghum.constants]
crop_type = sweetsorghum
default_crop_class = plant
leaf_part = generic_leaf


!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
!SECTION - VALUE LIMITS - MAX AND MINS
!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

!------------------------------------------------------------------------------
!OTHER VARIABLES
! limits set to check inputs

sw_ub                   = 1.0
sw_lb                   = 0.0
year_ub                 = 2000      ()      !  year upper limit
year_lb                 = 1800      ()      !  year lower limit
latitude_ub             = 90        (oL)    !  latitude upper limit
latitude_lb             = -90       (oL)    !  latitude lower limit
maxt_ub                 = 55        (oC)    !  max. temperature upper limit
maxt_lb                 = 0         (oC)    !  max. temperature lower limit
mint_ub                 = 40        (oC)    !  min. temperature upper limit
mint_lb                 = -10       (oC)    !  min. temperature lower limit
radn_ub                 = 50        (MJ/m^2)!  radiation upper limit
radn_lb                 = 1         (MJ/m^2)!  radiation lower limit
dlayer_ub               = 1000      (mm)    !  layer depth upper limit
dlayer_lb               = 0         (mm)    !  layer depth lower limit
dul_dep_ub              = 1000      (mm)    !  drained upper limit upper limit
dul_dep_lb              = 0         (mm)    !  drained upper limit lower limit
sw_dep_ub               = 1000      (mm)    !  soil water upper limit
sw_dep_lb               = 0         (mm)    !  soil water lower limit
no3_ub                  = 10000     (kg/ha) !  soil nitrate upper limit
no3_lb                  = 0         (kg/ha) !  soil nitrate lower limit
no3_min_ub              = 10000     (kg/ha) !  min. soil nitrate upper limit
no3_min_lb              = 0         (kg/ha) !  min. soil nitrate lower limit
nh4_ub                  = 10000     (kg/ha) !  soil ammonium upper limit
nh4_lb                  = 0         (kg/ha) !  soil ammonium lower limit
nh4_min_ub              = 10000     (kg/ha) !  min. soil ammonium upper limit
nh4_min_lb              = 0         (kg/ha) !  min. soil ammonium lower limit

!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
!SECTION - CROP PHENOLOGY: Stage and Phase names
!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
phenology_model = tttrate
stage_code_list=  1         2          3         4                5               6           7               8             9            10       12
stage_names = sowing germination emergence end_of_juvenile floral_initiation flowering start_grain_fill end_grain_fill maturity harvest_ripe end_crop
phase_names = sowing germination emergence end_of_juvenile floral_initiation flowering start_grain_fill end_grain_fill maturity harvest_ripe end_crop
phase_type  = generic generic    generic   generic         generic           generic   generic          generic        generic  generic      generic

composite_phases = under_ground above_ground grainfill reproductive leaf_senescence vernalisation  emergence2floral_initiation preflowering node_formation start_grain_fill2harvest_ripe hi_stress_sensitive stress_reporting tiller_formation

under_ground = sowing germination
above_ground =                   emergence end_of_juvenile floral_initiation flowering start_grain_fill end_grain_fill maturity harvest_ripe
leaf_senescence =                                          floral_initiation flowering start_grain_fill end_grain_fill maturity harvest_ripe
reproductive =                                                               flowering start_grain_fill end_grain_fill
grainfill =                                                                            start_grain_fill end_grain_fill
vernalisation=        germination emergence end_of_juvenile
emergence2floral_initiation  =    emergence end_of_juvenile floral_initiation
start_grain_fill2harvest_ripe =                                                         start_grain_fill end_grain_fill maturity
preflowering  =                   emergence end_of_juvenile floral_initiation
node_formation =                  emergence end_of_juvenile floral_initiation flowering start_grain_fill end_grain_fill
hi_stress_sensitive =                                                         flowering
stress_reporting =                          end_of_juvenile floral_initiation flowering start_grain_fill end_grain_fill
tiller_formation =               emergence end_of_juvenile floral_initiation flowering start_grain_fill end_grain_fill maturity

[standard.sweetsorghum.sweetsorghum]

grain_no_option = 2
partition_option = 2
n_retrans_option = 2
n_retrans_fraction = 1.0 !0.33
n_deficit_uptake_fraction = 0.0

grain_fill_option = 2 ! harvest index approach
n_uptake_option = 3
!no3_uptake_max = 0.9e-6
!no3_conc_half_max = 80
kno3 = 0.02
no3ppm_min = 0.0
knh4 = 0.0
nh4ppm_min = 0.0
total_n_uptake_max = 0.6 (g/m2)

x_temp_grainfill = 3.68  30.00  56.32 (oC)  ! Taken from APSIM 3.6 Sorghum Model
y_rel_grainfill =  0       1      0   ()


fruit_no_option = 1
parasite_option = 1

! list of crop class definitions
plant = sweetsorghum

class_action = harvest
class_change = unchanged

!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
!SECTION 0 - CO2
!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
co2_default = 350                             (ppm)
photosynthetic_pathway = C4                   (C3, or C4)
x_co2_te_modifier = 0  350  700   1000        (ppm co2)
y_co2_te_modifier = 0  1.0  1.37  1.69        ()

x_co2_nconc_modifier = 0  350  700   1000        (ppm co2)
y_co2_nconc_modifier = 0  1.0  0.93  0.9         ()


!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
!SECTION - CROP PHENOLOGY
!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
!-----------------------------------------------------------------------------------------------------------
!STEM REDUCTION EFFECT ON PHENOLOGY
!                                   sow    ger   eme  juv    fi    fl   st_gf end_gf  mat hv_rpe  end
stage_code_list                  = 1      2    3     4     5     6     7      8     9    10     11  ()     ! numeric code for phenological stages
stage_stem_reduction_harvest     = 1      2    3     3     4     4    11     11    11    11    11  ()
stage_stem_reduction_kill_stem   = 1      2    3     3     4     4    11     11    11    11    11  ()
!-----------------------------------------------------------------------------------------------------------
!SEED GERMINATION

!Water stress factor for germination
pesw_germ = 0.00 (mm/mm)     !plant extractable soil water in seedling layer inadequate for germination (mm/mm)

!-----------------------------------------------------------------------------------------------------------
!EMERGENCE

shoot_lag =  0.0 (oCd)      ! Time lag before linear coleoptile growth starts (deg days)
shoot_rate = 2.0 (oCd/mm)   ! Growing deg day increase with depth for coleoptile (deg day/mm depth)

!Water stress factor for emergence
fasw_emerg     = 0.0  1.0    ! Fraction of available soil water
rel_emerg_rate = 1.0  1.0    ! Stress factor for thermal time calculation between germination and emergence

!-----------------------------------------------------------------------------------------------------------
!PHOTOPERIOD AND TWILIGHT

twilight = -6.0 ! -2.2 (o)   ! Twilight is defined as the interval between sunrise or sunset and the time when the true
                      ! centre of the sun is 2.2 degrees below the horizon. Sunrise or sunset is defined as when
                      ! the true centre of the sun is 50' below the horizon.

!-----------------------------------------------------------------------------------------------------------
!Vernalisation

x_vernal_temp = 0 2  8  15
y_vernal_days = 0 1  0.5  0

!-----------------------------------------------------------------------------------------------------------
!THERMAL TIME CALCULATION

!Thermal time calculation
!x_temp  = 13 30  42  (oC) !cardinal temps.  Ferraris and Charles Edwards (Base) and Dolciotti et al (Opt)
!x_temp  = 10 30  42  (oC) !cardinal temps.  From Pac Seeds Expt 2004-5
!y_tt    = 0  20   0  (oC) !diff
!x_temp  = 5 30  42  (oC) !cardinal temps.  From Pac Seeds Expt 2004-5
!y_tt    = 0  25   0  (oC) !diff
!x_temp  = 9 30  42  (oC) !cardinal temps.  Sugar Model
!y_tt    = 0  21   0  (oC) !diff
!x_temp  = 13 25    (oC) !Combine Pac Seeds and Ferraris
!y_tt    = 0  12    (oC) !diff
x_temp  = 11 30    (oC) !sorghum model
y_tt    = 0  19    (oC) !


x_temp_post_anthesis = 5 20
y_tt_post_anthesis   = 0   15
!-----------------------------------------------------------------------------------------------------------
!LEAF NUMBER DEVELOPMENT

!currently leaf number at emergence will affect LAI at early stage, leaf_no_seed has no effect on the model, but will have in future

leaf_no_at_emerg = 2.0 !0.5     ! (expanded) leaf number at emergence ()

leaf_app_rate1      = 75.0 (oCd)       ! Growing deg day required to develop the most leaf ligules. (deg day).
leaf_app_rate2      = 2.0  (oCd)       ! Growing deg day required to develop last leaf ligules. (deg day).
leaf_no_rate_change = 7     ()         ! Leaf no below flag above which leaf appearance rate changes from rate1 to rate2.
                                       ! RELATIVE to FLAG
leaf_no_pot_option = 2

!x_node_no_app    = 1    10 11
!y_node_app_rate  = 30   30 100  ! Dolciotti et al (1998)
!x_node_no_app    = 1     9  10
!y_node_app_rate  = 40   40  83 ! Dolciotti et al (1998)
!x_node_no_app    = 1    12  13
!y_node_app_rate  = 20   20  43 ! Lawes 0405 - Base 13
x_node_no_app    = 1    12  13
y_node_app_rate  = 30   30  55 ! Lawes 0405 - Base 11

!x_node_no_leaf    =   0    5   8
x_node_no_leaf    =   0    2.5   6
y_leaves_per_node =   1    1   1   !4.0

x_lai_ratio      = 0.0  0.1 0.8 1.0 () ! ratio table for critical leaf size below which leaf number is reduced ()
y_leaf_no_frac   = 0.0  1.0 1.0 1.0  () ! reduction in leaf appearance ()

!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
!SECTION 2 - PHOTOSYNTHESIS, BIOMASS GROWTH AND PARTITION
!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
!PHOTOSYNTHESIS AND RADIATION USE EFFICIENCY (RUE)
!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
!STAGE DEPENDENT RUE
x_stage_rue          = 1      2    3     4    4.9   5     6     7      8     9      10    11  ()     ! numeric code for phenological stages
y_rue                = 0      0    0.90  0.90 0.9  1.80  1.80  1.80   0.00  0.00  0.00   0  (g/MJ)
!y_rue                = 0      0    1.50  1.50 1.50 1.50  1.50  1.50   1.50  0.00  0.00   0  (g/MJ)
!y_rue                = 0      0    0.90  0.90 0.9  1.25  1.25  1.25   1.25  0.00  0.00   0  (g/MJ)

!-----------------------------------------------------------------------------------------------------------
!EXTINCTION COEFFICIENT

!ROW SPACING DETERMINED
skiprow_default     = 0
row_spacing_default = 250 (mm)
x_row_spacing      = 200  350  1000
y_extinct_coef     = 0.60 0.60 0.60   ! Ferraris and Charles-Edwards
y_extinct_coef_dead= 0.30 0.30 0.30

!POD EXTINCTION COEFFICIENT and RUE
extinct_coef_pod =  0.0   ()
spec_pod_area    =  0.0   (mm^2/g)
rue_pod          =  0.0   (g/MJ)
!-----------------------------------------------------------------------------------------------------------
!TEMPERATURE RESPONSE OF PHOTOSYNTHESIS - RUE

x_ave_temp      = 8  20 35 50 (oC)  ! From APSIM 3.6 Sorghum module
!x_ave_temp      = 5  20 35 50 (oC)  !
y_stress_photo  = 0  1  1  0  ()    ! multiplier on RUE

!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
!BIOMASS INITIATION, PARTITION AND TRANSLOCATION
!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

!INITIATION
root_dm_init = 0.010    (g/plant)  ! part weight at emergence
leaf_dm_init = 0.003
stem_dm_init = 0.0016
pod_dm_init = 0.0
meal_dm_init = 0.0
oil_dm_init = 0.0
!-----------------------------------------------------------------------------------------------------------
!TRANSLOCATION PARTS

stem_trans_frac = 0.35 ()     ! fraction of stem used in translocation to grain - not used for i_sweetsorghum option
leaf_trans_frac = 0.00 ()     ! fraction of leaf used in translocation to grain
pod_trans_frac  = 0    ()     ! fraction of podwall used in translocation to grain

meal_trans_frac  = 0.00 ()     ! fraction of meal used in translocation to grain
oil_trans_frac  = 0.00 ()     ! fraction of oil used in translocation to grain
root_trans_frac  = 0.00 ()     ! fraction of root used in translocation to grain

!-----------------------------------------------------------------------------------------------------------
!BIOMASS PARTITIONING

!                           sow    ger   eme  endjuv nearfi    fi    flag  flow  endhead st_gf end_gf  mat hv_rpe  end
x_stage_no_partition       = 1      2    3     4    4.9       5     5.7   6       6.9    7      8     9    10     11   ()
!y_ratio_root_shoot         = 0      0    1.0   0.6  0.3       0.25  0.10  0.08          0      0     0     0      0   (0-1)
y_ratio_root_shoot         = 0      0    1.0   1.0  0.3       0.30  0.30  0.08    0.01   0      0     0     0      0   (0-1)
! Leaf partitioning from Ferraris and Charles-Edwards
y_frac_leaf                = 0      0    0.6  0.6  0.6       0.60  0.0   0.0     0.0    0      0     0     0      0   (0-1)  ! fraction of remaining dm allocated to leaves
y_frac_pod                 = 0      0    0     0     0        0     0.0  0.33    0.33   0      0     0     0      0   (0-1)  ! fraction of dm allocated to pod or multiplier of grain dm to account for pod dm
!-----------------------------------------------------------------------------------------------------------
!-----------------------------------------------------------------------------------------------------------
!GRAIN NUMBER DETERMINATION

!-----------------------------------------------------------------------------------------------------------
!GRAIN FILLING

grain_n_option = 2

sw_fac_max              = 1.125     ()      !  soil water stress factor maximum
temp_fac_min            = 0.69      ()      !  temperature stress factor minimum
sfac_slope              = -0.125    ()      !  soil water stress factor slope
tfac_slope              = 0.0125    ()      !  temperature stress factor slope

potential_grain_n_filling_rate = 0.00004 (g/grain/d)
x_temp_grain_n_fill = 0 25
y_rel_grain_n_fill = 0   1
crit_grainfill_rate = 0.0005

x_temp_grain            = 0.0   15.0        (oC)   ! temperature table for grain growth rate
y_grain_rate            = 0.0   1.0         (0-1)  ! temperature factor on grain growth rate

carbo_oil_conv_ratio    = 1.0                 ! Carbohydrate:oil conversion ratio (>= 1.0)
grain_oil_conc          = 0.0                 ! fractional oil content of grain (0-1)

!-----------------------------------------------------------------------------------------------------------
!GRAIN WATER CONTENT

grn_water_cont = 0.125 (g/g)           ! water content of grain g/g

!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
!SECTION 3 - LEAF/STEM/POD AREA GROWTH
!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
!------------------------------------------------------------------------------
!LEAF SIZE AS A FUNCTION OF LEAF NUMBER

node_no_correction =  2.0
x_node_no =   1      4    8      14       15   18
y_leaf_size =  500 1500  1800 60000  65000     80000 ! Pac Seeds 0405

!------------------------------------------------------------------------------
!SPECIFIC LEAF AREA - SLA

x_lai       =   0     3
y_sla_max   =   50000 15000    ! maximum specific leaf area for delta LAI

!sla_min         =  10000           ! minimum specific leaf area for delta LAI
sla_min         =   8000           ! minimum specific leaf area for delta LAI


!------------------------------------------------------------------------------
!TPLA  - USED TO INTIALISE THE INITIAL LAI

initial_tpla    = 200    (mm^2/plant)  ! initial total plant leaf area

!------------------------------------------------------------------------------
!HARVESTING EFFECTS ON LEAF AREA

fr_height_cut           = 0.0  0.1    1
fr_stem_remain          = 0.0  0.2    1

!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
!SECTION 4 - ROOT DEPTH AND ROOT LENGTH GROWTH
!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

!-----------------------------------------------------------------------------------------------------------
!ROOTING DEPTH

!                      sow    ger   eme  juv    fi    fl   st_gf end_gf  mat hv_rpe  end
!stage_code           = 1      2    3     4     5     6     7      8     9    10     11  ()
!root_depth_rate       = 0      5.0  40    40    40    40    0      0.0   0.0   0.0    0  (mm/d)
root_depth_rate       = 0      5.0  30    30    30    30    30      0.0   0.0   0.0    0  (mm/d)

!Effect of sw_supply_demand_ratio on root depth increase
x_ws_root       = 0   1   !sw_supply_demand_ratio
y_ws_root_fac   = 1   1   !effect of supply_demand_ratio on root depth increase


!x_sw_ratio = [sw_dep(lay)-ll_dep(lay)]/[dul_dep(lay)-ll_dep(lay)] in the deepest root layer

x_sw_ratio       = 0.0 0.25 ()       ! water availability for effects on root depth growth
y_sw_fac_root    = 0   1    ()       ! stress factor for root depth growth, This may be probably the same for all crops

!-----------------------------------------------------------------------------------------------------------
!TEMPERATURE EFFECT ON ROOT ADVANCE

x_temp_root_advance = 0 25 35
y_rel_root_advance  = 1 1  1

!-----------------------------------------------------------------------------------------------------------
!ROOT LENGTH CALCULATION

initial_root_depth   = 100 (mm)          ! initial depth of roots (mm)
specific_root_length = 105000 (mm/g)     ! CEREs sweetsorghum

!The following can increase or decrease the root length density in a layer based on the rld per plant

x_plant_rld             = 0   0.0001  0.0003 (mm/mm3/plant)  ! root branching
y_rel_root_rate         = 0.02  0.10  1.0   (0-1)
!y_rel_root_rate          = 1.0   1.0   1.0   (0-1)

!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
!SECTION 5 - WATER RELATIONS AND WATER STRESS FACTORS
!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
!STAGE DEPENDENT TRANSPIRATION EFFICIENCY COEFFICIENTS

!Transpiration efficiency coefficient to convert vpd to transpiration efficiency (kpa)
!The following transp_eff_cf values are
!in the form kpa/g carbo per m^2 / g water per m^2 (kpa/g carbo per m^2 / mm water) because 1g water = 1 cm^3 water

!                      sow    ger   eme  juv    fi    fl   st_gf end_gf  mat hv_rpe  end
!stage_code           = 1      2    3     4     5     6     7      8     9    10     11  ()
transp_eff_cf         = 0      0    .006  .006  .006  .006  .006  .006   .0025 .00    0 (Pa)   !

!-----------------------------------------------------------------------------------------------------------
!VPD FRACTION

!Fraction of distance between svp at min temp and svp at max temp where average svp during transpiration lies.
svp_fract   = 0.75  !   (0-1)
eo_crop_factor_default = 1.1  ! default crop factor for limiting soil
                                ! water demand to some fraction/multiple
                                ! of atmospheric potential.

!-----------------------------------------------------------------------------------------------------------
!WATER STRESS FACTORS FOR PHOTOSYNTHESIS, EXPANSION AND DEVELOPMENT

!swdef_photo for photosynthesis is calculated in the code as = sw_supply_sum/sw_demand - function crop_swdef_photo

!For expansion growth, more sensitive than other growth processes
!x_sw_demand_ratio = sw_supply_sum/sw_demand

x_sw_demand_ratio= 0.1 1.1 ()          ! water availability
y_swdef_leaf     = 0   1   ()          ! stress indices

!For phenology stress factor based on available soil water portion
!sw_avail_pot_sum = sum_real_array (sw_avail_pot, deepest_layer),
!sw_avail_sum     = sum_real_array (sw_avail, deepest_layer)
!sw_avail_ratio   = divide (sw_avail_sum, sw_avail_pot_sum, 1.0) !???

x_sw_avail_ratio = 0.0 0.16 ()           ! water availability
y_swdef_pheno    = 1.0 1.0  ()           ! stress index for phenology

x_sw_avail_ratio_flower =    0.2   0.50  1.0  ()         ! water availability
y_swdef_pheno_flower    =    1.0   1.0    1.0  ()        ! stress index for flowering phenology

x_sw_avail_ratio_grainfill = 0.2   0.50   1.0  ()        ! water availability
y_swdef_pheno_grainfill    = 1.0   1.0    1.0  ()        ! stress index for grainfilling phenology


!-----------------------------------------------------------------------------------------------------------
!WATERLOGGING STRESS (OXYGEN DEFICIT) FACTOR FOR PHOTOSYNTHESIS

oxdef_photo_rtfr        = 0.0  0.8   1.0         ()     ! fraction of roots waterlogged for effect on photosynthesis
oxdef_photo             = 1.0  1.0   1.0         (0-1)  ! stress index on photosynthesis

!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
!SECTION 6 -NITROGEN RELATIONS, UPTAKE AND STRESS FACTORS
!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

!------------------------------------------------------------------------------
!UPTAKE PREFERENCE AND CONSTANTS

!preference for n supply - it is assumed that mass flow is always predominant, but further crop preference can
!be specified as follows:
! 'active'   = diffusive flow before fixation
! 'fixation' = fixed N before active uptake.

n_supply_preference = active

!Time constant for N uptake by diffusion. H van Keulen &  NG Seligman. Purdoe 1987.
!This is the  time it would take to remove, by diffusion, current amount of N if it wasn't depleted between time steps

no3_diffn_const  = 4.0 ! 2.0 (days)

!------------------------------------------------------------------------------
!LEGUME N FIXATION RATE - potential rate of N fixation (g N fixed per g above ground biomass)

!                      sow    ger   eme  juv    fi    fl   st_gf end_gf  mat hv_rpe  end
!stage_code           = 1      2    3     4     5     6     7      8     9    10     11  ()
N_fix_rate            = 0      0    0     .00  0.00  0.00  0.00   0.00  0.00  0.00    0  (gN/gDM)

x_sw_avail_fix          = 0.0  0.50  0.95  1.0   ()     ! soil water ratio for effect on N fixation
y_swdef_fix             = 1.0  1.0   1.0   1.0   (0-1)  ! stress index on N fixation

!------------------------------------------------------------------------------
!NITROGEN STRESS FACTORS FOR PHOTOSYNTHESIS,LEAF GROWTH AND DEVELOPMENT

!n_conc_ratio      = divide ((N_conc_stover - N_conc_stover_min),(N_conc_stover_crit-N_conc_stover_min),0.0)
!n_conc_ratio_leaf = divide ((N_conc_leaf - N_conc_leaf_min), (N_conc_leaf_crit - N_conc_leaf_min), 0.0)
!g_nfact_photo     = N_fact_photo * N_conc_ratio
!g_n_fact_pheno    = N_fact_pheno * N_conc_ratio
!g_nfact_expansion = N_fact_expansion * n_conc_ratio_leaf

n_stress_option = 2

n_stress_start_stage = 4.3

N_fact_photo     = 1.5    ! multipler for N deficit effect on photosynthesis

N_fact_expansion = 1.0    ! multipler for N deficit effect on leaf expansion

N_fact_pheno     = 100    ! multipler for N deficit effect on phenology

!------------------------------------------------------------------------------
!NITROGEN CONCENTRATION LIMITS: MAX. CRITICAL AND MINIMUM N CONCENTRATIONS


!                      emerg   endjuv fi    flower end gf maturity     !FIXME??
x_stage_code         = 3       4      5     6      8      10    ()     ! Perhaps should be 7 for start of grain fill

y_n_conc_min_leaf    = 0.025   0.025  0.021 0.010  0.010  0.010 ()
y_n_conc_crit_leaf   = 0.063   0.063  0.042 0.030  0.020  0.015 ()
y_n_conc_max_leaf    = 0.070   0.070  0.050 0.020  0.010  0.005 ()

y_n_conc_min_stem    = 0.025   0.025  0.004 0.003  0.003  0.0025 ()
y_n_conc_crit_stem   = 0.050   0.050  0.020 0.010  0.005  0.0035 ()
y_n_conc_max_stem    = 0.070   0.070  0.040 0.015  0.015  0.015 ()

y_n_conc_min_pod    = 0.025   0.025  0.004 0.003  0.003  0.0025 ()
y_n_conc_crit_pod   = 0.050   0.050  0.020 0.010  0.005  0.0035 ()
y_n_conc_max_pod    = 0.070   0.070  0.040 0.015  0.015  0.015 ()

!n_conc_min_root    =  0.010   0.010  0.006 0.006  0.006  0.006 ()
!n_conc_crit_root   =  0.020   0.016  0.016 0.016  0.015  0.015 ()
!n_conc_min_root    =  0.010   0.006  0.006 0.006  0.006  0.006 ()
!n_conc_crit_root   =  0.020   0.010  0.010 0.010  0.010  0.010 ()
!n_conc_max_root    =  0.020   0.020  0.020 0.020  0.020  0.020 ()
n_conc_min_root    =  0.010
n_conc_crit_root   =  0.020
n_conc_max_root    =  0.020

n_conc_min_grain    = 0.014   ()
n_conc_crit_grain   = 0.030   ()
n_conc_max_grain    = 0.030   ()

y_n_conc_min_meal    = 0.0     0.0    0.0    0.014   0.014   0.014    ()
y_n_conc_crit_meal   = 0.0     0.0    0.0    0.030   0.030   0.030    ()
y_n_conc_max_meal    = 0.0     0.0    0.0    0.030   0.030   0.030    ()

y_n_conc_min_oil     = 0.0     0.0    0.0     0.0      0.0     0.0    ()
y_n_conc_crit_oil    = 0.0     0.0    0.0     0.0      0.0     0.0    ()
y_n_conc_max_oil     = 0.0     0.0    0.0     0.0      0.0     0.0    ()


!------------------------------------------------------------------------------
!INITIAL NITROGEN CONCENTRATION OF ORGANS
root_n_init_conc = 0.020
leaf_n_init_conc = 0.063
stem_n_init_conc = 0.050

pod_n_init_conc = 0.063
meal_n_init_conc = 0.0
oil_n_init_conc = 0.0
!------------------------------------------------------------------------------
!NITROGEN CONCENTRATION IN SENESCENCED ORGANS
!This means that as soon as leaves fall off, all N except for the amount below is
!instantly transferred from leaves to stem (need to stop this occuring if you 'kill' crop)

n_senescence_option = 2
root_n_sen_conc = 0.005 !shouldn't they more or less match the min_conc of plant parts?
leaf_n_sen_conc = 0.007
stem_n_sen_conc = 0.0025
pod_n_sen_conc = 0.007
meal_n_sen_conc = 0.014
oil_n_sen_conc = 0.0
!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
!SECTION 7 -SENESCENCE AND DETACHMENT
!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
!------------------------------------------------------------------------------
!DM SENESCENCE

root_die_back_fr = 0.0  (0-1) ! fraction of roots lost at harvest

dm_senescence_option = 1

! dm fraction senesced for each fraction of canopy senesced.
x_dm_sen_frac_root = 0    1     ! root
y_dm_sen_frac_root = 0.005 0.005
x_dm_sen_frac_leaf = 0    1     ! leaf
y_dm_sen_frac_leaf = 0    1
x_dm_sen_frac_stem = 0    1     ! stem
y_dm_sen_frac_stem = 0    0
x_dm_sen_frac_pod = 0    1     ! flower
y_dm_sen_frac_pod = 0    0
x_dm_sen_frac_meal = 0    1     ! meal
y_dm_sen_frac_meal = 0    0
x_dm_sen_frac_oil = 0    1     ! oil
y_dm_sen_frac_oil = 0    0

!------------------------------------------------------------------------------
!LEAF NUMBER AND AREA SENESCENCE

min_tpla                = 5.0   ()   ! lower limit of total plant leaf area

sen_start_stage = 4.4 !5.4   ! stage code for start of leaf sensecence

!node_sen_rate           = 100.0   (oCd/node) !
node_sen_rate           = 90.0   (oCd/node) ! Base 11
!node_sen_rate           = 70.0   (oCd/node) ! Base 13

fr_lf_sen_rate          = 0.06   ()         !  fraction of total leaf number senescing per main stem node
n_fact_lf_sen_rate      = 0.0

lai_sen_light = 4.0  (m^2/m^2)    ! induced senescence occurs (m^2/m^2)
sen_light_slope = 0.01()         ! sensitivity of leaf area senescence to shading

x_temp_senescence = -15.0 -5.0     ! minimum temperature for frost senescence table (oC)
y_senescence_fac  =  1    0       ! daily fraction of leaf area senesced due to frost (0-1)

sen_rate_water = 0.10 ()          ! slope in linear eqn relating soil water stress during photosynthesis to leaf senesence rate

!------------------------------------------------------------------------------
!DETACHMENT


                 ! root  

root_dead_detach_frac = 0  ()      ! fraction detached from each part of a dead plant per day.
root_sen_detach_frac =  1  ()      ! fraction of senesced plant part detached each day from live plants

leaf_dead_detach_frac = 0.0
leaf_sen_detach_frac = 0.0
stem_dead_detach_frac = 0.0
stem_sen_detach_frac = 0.0

pod_dead_detach_frac = 0.0
pod_sen_detach_frac =  0.0
meal_dead_detach_frac = 0.0
meal_sen_detach_frac =  0.0
oil_dead_detach_frac = 0.0
oil_sen_detach_frac =  0.0

!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
!SECTION 8 - WE MIGHT PUT RETRANSLOCATION OF DM AND N IN THIS SECTION
!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
!SECTION 9 - CROP FAILURE AND DEATH
!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

!------------------------------------------------------------------------------
! crop failure

leaf_no_crit    =  10.0      ()     ! critical number of leaves, below which portion of the crop may die due to water stress
tt_emerg_limit  = 300.0     (oCd)   ! maximum degree days allowed for emergence to take place
days_germ_limit = 40.0      (days)  ! maximum days allowed after sowing for germination to take place (days)
swdf_photo_limit= 99.0      ()      ! critical cumulative photosynthesis water stress, above which the crop partly fails (unitless)
swdf_photo_rate = 0.0       ()      ! rate of plant reduction with photosynthesis water stress
swdf_pheno_limit = 25       ()      ! critical cumulative phenology water stress, above which the crop fails (unitless)

!------------------------------------------------------------------------------
!PLANT DEATH

x_weighted_temp = 55.0  60.0  (oC)
y_plant_death   =  0.0   1.0

!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
!SECTION 10 - PHOSPHORUS RELATIONS, UPTAKE AND STRESS FACTORS
!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
!SECTION - VALUE LIMITS - MAX AND MINS
!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

!------------------------------------------------------------------------------
!ROOT PARAMETERS

ll_ub  = 1000.0 ()                     ! upper limit of lower limit
kl_ub  = 1.0    ()                     ! upper limit of water uptake factor

!------------------------------------------------------------------------------
!SOIL WATER

minsw  = 0.00001 ()                    ! lowest acceptable value for ll

! cultivar parameter upper bounds

tt_emerg_to_endjuv_ub       = 1000.0 (oCd)   ! upper limit
tt_flower_to_maturity_ub    = 1500.0 (oCd)   ! upper limit
tt_maturity_to_ripe_ub      = 1000.0 (oCd)   ! upper limit
tt_flower_to_start_grain_ub = 1000.0 (oCd)   ! upper limit
tt_init_to_flower_ub        = 1000.0 (oCd)   ! upper limit


!***********************************************************************************************************
!  PARAMETERS  - CULTIVAR-SPECIFIC VALUES
!***********************************************************************************************************

[standard.sweetsorghum.base_cultivar]
! Basic Cultivar information from which other cultivars can inherit information.  Do not use this cultivar in
! Simulations but choose from the following list of cultivars.

grains_per_gram_stem           =  10.0
potential_grain_filling_rate   =  0.002

x_pp_hi_incr                =    1      24    (h)
y_hi_incr                   =    0.013 0.013 (1/days)
x_hi_max_pot_stress =            0.00 1.00 ()
y_hi_max_pot =                   0.50 0.50 ()

   cum_vernal_days          =    0          100
   !tt_emerg_to_endjuv       =  100.0        100.0  (oCd) ! Base 5
   tt_emerg_to_endjuv       =  70.0        70.0  (oCd) ! Base 9

   est_days_emerg_to_init =         45       (d) ! Ferraris and Charles-Edwards

   !x_pp_endjuv_to_init      = 13.0 14   14.6 14.75                ! photoperiod (h)
   !y_tt_endjuv_to_init      = 100  200   312  365                  ! TT from end juvenile to floral initiation
   x_pp_endjuv_to_init      = 13.9  14.7                ! photoperiod (h)
   !y_tt_endjuv_to_init      = 250    330                  ! Base 5
    y_tt_endjuv_to_init      = 150    250                  ! Base 9

   x_pp_init_to_flower        =   1      24   (h)
   !y_tt_init_to_flower        =   470.0  470.0  (oCd)           ! Base 5
   y_tt_init_to_flower        =   450.0  450.0  (oCd)           ! Base 9

   x_pp_flower_to_start_grain =   1      24   (h)
   y_tt_flower_to_start_grain =   100    100 (oCd)            ! TT from flowering to start grain fill

   x_pp_start_to_end_grain =      12      14   (h)
   y_tt_start_to_end_grain =    200.   350.  (oCd)

   tt_end_grain_to_maturity =    5.0   (oCd)
   tt_maturity_to_ripe      =    5.0    (oCd)           ! TT from maturity to harvest ripe

   x_stem_wt =                   0  50     (g/m2)
   y_height =                    0  3000   (mm)



[standard.sweetsorghum.wray]
derived_from = base_cultivar

[standard.sweetsorghum.sugargraze]
derived_from = base_cultivar
!   x_pp_endjuv_to_init      = 12     14.5                ! photoperiod (h)
!   y_tt_endjuv_to_init      = 100    800                  ! TT from end juvenile to floral initiation

   !x_pp_endjuv_to_init      = 13.25     14.5                ! photoperiod (h)
   !y_tt_endjuv_to_init      = 450    800                  ! Base 5
   !y_tt_endjuv_to_init      = 310    620                  ! Base 9
   !y_tt_endjuv_to_init      = 150    360                  ! Base 13

   !x_pp_endjuv_to_init      = 13.25     15                ! photoperiod (h)
   !y_tt_endjuv_to_init      = 300    650                  ! Base 11
   !y_tt_endjuv_to_init      = 150    440                  ! Base 13

   x_pp_endjuv_to_init      = 13     15                ! photoperiod (h)
   y_tt_endjuv_to_init      = 200    700                  ! Base 11


   x_pp_init_to_flower        =   1      24   (h)
   !y_tt_init_to_flower        =   630.0  630.0  (oCd)           ! Base 5
   !y_tt_init_to_flower        =   530.0  530.0  (oCd)           ! Base 9
   y_tt_init_to_flower        =   450.0  450.0  (oCd)           ! Base 11
   !y_tt_init_to_flower        =   350.0  350.0  (oCd)           ! Base 13

   x_pp_flower_to_start_grain =   1      24   (h)
   !y_tt_flower_to_start_grain =   150    150 (oCd)            !
   !y_tt_flower_to_start_grain =   110    110 (oCd)            ! Base 11
   !y_tt_flower_to_start_grain =   80    80 (oCd)            ! Base 13
   y_tt_flower_to_start_grain =   150    150 (oCd)            ! Base 5

   x_pp_start_to_end_grain =      12      14   (h)
!   y_tt_start_to_end_grain =    700.   700.  (oCd)
   !y_tt_start_to_end_grain =    300.   300.  (oCd)    ! Base 9
    !y_tt_start_to_end_grain =    240.   240.  (oCd)    ! Base 11
    !y_tt_start_to_end_grain =    180.   180.  (oCd)    ! Base 13
    y_tt_start_to_end_grain =    200.   200.  (oCd)    ! Base 5